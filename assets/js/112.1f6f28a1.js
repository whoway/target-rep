(window.webpackJsonp=window.webpackJsonp||[]).push([[112],{397:function(s,t,a){"use strict";a.r(t);var e=a(14),n=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"libevent高并发网络编程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#libevent高并发网络编程"}},[s._v("#")]),s._v(" libevent高并发网络编程")]),s._v(" "),t("div",{staticClass:"language-cpp line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-cpp"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("font style"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"background: MediumSpringGreen"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("font style"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"background:yellow"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h2",{attrs:{id:"目录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#目录"}},[s._v("#")]),s._v(" 目录")]),s._v(" "),t("p"),t("div",{staticClass:"table-of-contents"},[t("ul",[t("li",[t("a",{attrs:{href:"#目录"}},[s._v("目录")])]),t("li",[t("a",{attrs:{href:"#_1-linux下的libevent环境配置"}},[s._v("1.linux下的libevent环境配置")]),t("ul",[t("li",[t("a",{attrs:{href:"#_1-1-安装依赖环境"}},[s._v("1.1.安装依赖环境")])]),t("li",[t("a",{attrs:{href:"#_1-2-zlib-1-2-11编译"}},[s._v("1.2.zlib-1.2.11编译")])]),t("li",[t("a",{attrs:{href:"#_1-3-openssl-1-1-1编译"}},[s._v("1.3.openssl-1.1.1编译")])]),t("li",[t("a",{attrs:{href:"#_1-4-libevent编译"}},[s._v("1.4.libevent编译")])]),t("li",[t("a",{attrs:{href:"#_1-4点libevent报错-解决方案"}},[s._v("1.4点libevent报错？解决方案")])]),t("li",[t("a",{attrs:{href:"#_1-5-安装完libevent来测试-主要看看openssl和zlib"}},[s._v("1.5.安装完libevent来测试-主要看看openssl和zlib")])]),t("li",[t("a",{attrs:{href:"#_1-6-写1个程序-让他来执行1下"}},[s._v("1.6.写1个程序，让他来执行1下")])]),t("li",[t("a",{attrs:{href:"#_1-7-解决-我的报错。"}},[s._v("1.7.解决-我的报错。")])]),t("li",[t("a",{attrs:{href:"#_1-8-网上找解决方案"}},[s._v("1.8.网上找解决方案")])])])]),t("li",[t("a",{attrs:{href:"#_2-第2章libevent原理和网络模型设置-8"}},[s._v("2.第2章Libevent原理和网络模型设置-8")]),t("ul",[t("li",[t("a",{attrs:{href:"#✔️2-1-高并发网络模型-多路复用-select、epoll、iocp区别"}},[s._v("✔️2-1.高并发网络模型(多路复用)select、epoll、iocp区别")])]),t("li",[t("a",{attrs:{href:"#_2-2-libevent接口分析"}},[s._v("2-2.libevent接口分析")])]),t("li",[t("a",{attrs:{href:"#_2-3-libevent服务端接收连接的代码示例"}},[s._v("2-3 libevent服务端接收连接的代码示例")])]),t("li",[t("a",{attrs:{href:"#_2-4-libevent上下文属性配置和源码分析"}},[s._v("2-4 libevent上下文属性配置和源码分析")])]),t("li",[t("a",{attrs:{href:"#_2-5-获取系统所支持的网络模型例如epoll-select"}},[s._v("2-5 获取系统所支持的网络模型例如epoll_select")])]),t("li",[t("a",{attrs:{href:"#_2-6-配置特征-例如边缘触发-并判断是否生效event-con"}},[s._v("2-6 配置特征-例如边缘触发并判断是否生效eventcon")])]),t("li",[t("a",{attrs:{href:"#_2-7-设置网络模型并显示当前应用的网络模型event-config"}},[s._v("2-7 设置网络模型并显示当前应用的网络模型event_config")])]),t("li",[t("a",{attrs:{href:"#_2-8-windows上使用iocp网络模型并测试"}},[s._v("2-8 windows上使用iocp网络模型并测试")])])])]),t("li",[t("a",{attrs:{href:"#参考资料"}},[s._v("参考资料")])])])]),t("p"),s._v(" "),t("p",[s._v("[TOC]")]),s._v(" "),t("h2",{attrs:{id:"_1-linux下的libevent环境配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-linux下的libevent环境配置"}},[s._v("#")]),s._v(" 1.linux下的libevent环境配置")]),s._v(" "),t("h3",{attrs:{id:"_1-1-安装依赖环境"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-安装依赖环境"}},[s._v("#")]),s._v(" 1.1.安装依赖环境")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" perl g++ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" automake libtool "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("unzip")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("root@VMwhoway:/home/whoway"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sudo apt install perl g++ make automake libtool unzip -y")]),s._v("\n正在读取软件包列表"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". 完成\n正在分析软件包的依赖关系树       \n正在读取状态信息"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". 完成       \nautomake 已经是最新版 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(":1.16.1-4ubuntu6"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("。\ng++ 已经是最新版 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(":9.3.0-1ubuntu2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("。\nlibtool 已经是最新版 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.4")]),s._v(".6-14"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("。\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" 已经是最新版 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.2")]),s._v(".1-1.2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("。\nperl 已经是最新版 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.30")]),s._v(".0-9ubuntu0.3"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("。\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("unzip")]),s._v(" 已经是最新版 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6.0")]),s._v("-25ubuntu1.1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("。\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("unzip")]),s._v(" 已设置为手动安装。\n升级了 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" 个软件包，新安装了 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" 个软件包，要卸载 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" 个软件包，有 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("299")]),s._v(" 个软件包未被升级。\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br")])]),t("h3",{attrs:{id:"_1-2-zlib-1-2-11编译"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-zlib-1-2-11编译"}},[s._v("#")]),s._v(" 1.2.zlib-1.2.11编译")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-xvf")]),s._v(" zlib-1.2.11.tar.gz\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" zlib-1.2.11\n./configure \n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h3",{attrs:{id:"_1-3-openssl-1-1-1编译"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-openssl-1-1-1编译"}},[s._v("#")]),s._v(" 1.3.openssl-1.1.1编译")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-xvf")]),s._v(" openssl-1.1.1.tar.gz\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" openssl-1.1.1\n./config \n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h3",{attrs:{id:"_1-4-libevent编译"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-libevent编译"}},[s._v("#")]),s._v(" 1.4.libevent编译")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("uzip libevent-master.zip\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" libevent-master\n./autogen.sh    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#生成configure")]),s._v("\n./configure\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#生成Makefile")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h3",{attrs:{id:"_1-4点libevent报错-解决方案"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-4点libevent报错-解决方案"}},[s._v("#")]),s._v(" 1.4点libevent报错？解决方案")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("root@VMwhoway:/home/whoway/mylibeventStudy/libevent-master"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./autogen.sh ")]),s._v("\nautoreconf: Entering directory `."),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\nautoreconf: configure.ac: not using Gettext\nautoreconf: running: aclocal --force -I m4\nautoreconf: configure.ac: tracing\nautoreconf: running: libtoolize --copy --force\nlibtoolize: putting auxiliary files in '")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.\nlibtoolize: copying file '")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/ltmain.sh"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\nlibtoolize: putting macros in AC_CONFIG_MACRO_DIRS, '")]),s._v("m4"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.\nlibtoolize: copying file '")]),s._v("m4/libtool.m4"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\nlibtoolize: copying file '")]),s._v("m4/ltoptions.m4"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\nlibtoolize: copying file '")]),s._v("m4/ltsugar.m4"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\nlibtoolize: copying file '")]),s._v("m4/ltversion.m4"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\nlibtoolize: copying file '")]),s._v("m4/lt~obsolete.m4"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\nautoreconf: running: /usr/bin/autoconf --force\nautoreconf: running: /usr/bin/autoheader --force\nautoreconf: running: automake --add-missing --copy --force-missing\nconfigure.ac:25: installing '")]),s._v("./compile"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\nconfigure.ac:33: installing '")]),s._v("./config.guess"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\nconfigure.ac:33: installing '")]),s._v("./config.sub"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\nconfigure.ac:13: installing '")]),s._v("./install-sh"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\nconfigure.ac:129: error: required file '")]),s._v("./ltmain.sh"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("' not found\nconfigure.ac:13: installing '")]),s._v("./missing"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\nMakefile.am: installing '")]),s._v("./depcomp"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\nparallel-tests: installing '")]),s._v("./test-driver'\nautoreconf: automake failed with "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v(" status: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" ⭐️⭐️报错⭐️⭐️⭐️\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br")])]),t("ul",[t("li",[s._v("为啥还是报错automake libtool这2个？我先前安装了啊")]),s._v(" "),t("li",[s._v("我然后把最开始的安装又搞了一遍就没报错了")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("root@VMwhoway:/home/whoway/mylibeventStudy/libevent-master"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./autogen.sh ")]),s._v("\nautoreconf: Entering directory "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\nautoreconf: configure.ac: not using Gettext\nautoreconf: running: aclocal --force -I m4\nautoreconf: configure.ac: tracing\nautoreconf: running: libtoolize --copy --force\nlibtoolize: putting auxiliary files in '")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.\nlibtoolize: copying file '")]),s._v("./ltmain.sh"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\nlibtoolize: putting macros in AC_CONFIG_MACRO_DIRS, '")]),s._v("m4"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.\nlibtoolize: copying file '")]),s._v("m4/libtool.m4"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\nlibtoolize: copying file '")]),s._v("m4/ltoptions.m4"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\nlibtoolize: copying file '")]),s._v("m4/ltsugar.m4"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\nlibtoolize: copying file '")]),s._v("m4/ltversion.m4"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\nlibtoolize: copying file '")]),s._v("m4/lt~obsolete.m4"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\nautoreconf: running: /usr/bin/autoconf --force\nautoreconf: running: /usr/bin/autoheader --force\nautoreconf: running: automake --add-missing --copy --force-missing\nconfigure.ac:25: installing '")]),s._v("./compile"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\nconfigure.ac:13: installing '")]),s._v("./missing"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\nMakefile.am: installing '")]),s._v("./depcomp'\nautoreconf: Leaving directory "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v(".'\nroot@VMwhoway:/home/whoway/mylibeventStudy/libevent-master"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br")])]),t("h3",{attrs:{id:"_1-5-安装完libevent来测试-主要看看openssl和zlib"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-5-安装完libevent来测试-主要看看openssl和zlib"}},[s._v("#")]),s._v(" 1.5.安装完libevent来测试-主要看看openssl和zlib")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("root@VMwhoway:/home/whoway/mylibeventStudy/libevent-master"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# test/regress > log.txt")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("warn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Trying to disable lock functions after they have been "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" up will probaby not work.\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("warn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Trying to disable lock functions after they have been "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" up will probaby not work.\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("warn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Trying to disable lock functions after they have been "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" up will probaby not work.\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("warn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Trying to disable lock functions after they have been "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" up will probaby not work.\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("msg"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Nameserver "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:58696 has failed: request timed out.\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("msg"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" All nameservers have failed\n "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("msg"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Nameserver "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:55447 has failed: request timed out.\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("msg"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" All nameservers have failed\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("msg"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Nameserver "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:49999 has failed: request timed out.\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("msg"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" All nameservers have failed\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("msg"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Nameserver "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:40857 has failed: request timed out.\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("msg"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" All nameservers have failed\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("msg"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Nameserver "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:58694 has failed: request timed out.\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("msg"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" All nameservers have failed\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("warn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Error from accept"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" call: Too many "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("open")]),s._v(" files\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br")])]),t("ul",[t("li",[s._v("然后vim log.txt搜索zlib和ssl后边的模块测试是否成功")])]),s._v(" "),t("blockquote",[t("p",[s._v("至此，完美执行")])]),s._v(" "),t("h3",{attrs:{id:"_1-6-写1个程序-让他来执行1下"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-6-写1个程序-让他来执行1下"}},[s._v("#")]),s._v(" 1.6.写1个程序，让他来执行1下")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("root@VMwhoway:/home/whoway/mylibeventStudy/libevent/src"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat makefile ")]),s._v("\nfirstlibevent:first_libevent.cpp\n\tg++ $^ "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-o")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$@")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-levent")]),s._v("\n\t./"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$@")]),s._v("\nclean:\n\t"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-rf")]),s._v(" firstlibevent\n\t"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-rf")]),s._v(" *.o\n\n\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$@")]),s._v("就是目标相，说白了就是把firstlibevent复制过来\n$^就是依赖性，比如这里是first_libevent.cpp\n\n用上面的变量，好处就是后边不用改了\n\n-l就是链接库\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("h3",{attrs:{id:"_1-7-解决-我的报错。"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-7-解决-我的报错。"}},[s._v("#")]),s._v(" 1.7.解决-我的报错。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("root@VMwhoway:/home/whoway/mylibeventStudy/libevent/src/first_libevent"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim makefile ")]),s._v("\nroot@VMwhoway:/home/whoway/mylibeventStudy/libevent/src/first_libevent"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# make")]),s._v("\ng++ first_libevent.cpp "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-o")]),s._v(" firstlibevent "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-levent")]),s._v("\n./firstlibevent\n./firstlibevent: error "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" loading shared libraries: libevent-2.2.so.1: cannot "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("open")]),s._v(" shared object file: No such "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" or directory\nmake: *** "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("makefile:3：firstlibevent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" 错误 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127")]),s._v("\nroot@VMwhoway:/home/whoway/mylibeventStudy/libevent/src/first_libevent"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("h3",{attrs:{id:"_1-8-网上找解决方案"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-8-网上找解决方案"}},[s._v("#")]),s._v(" 1.8.网上找解决方案")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("root@VMwhoway:/home/whoway/mylibeventStudy/libevent/src/first_libevent"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ln -s /usr/local/lib/libevent-2.2.so.1 /usr/lib64/libevent-2.2.so.1")]),s._v("\nroot@VMwhoway:/home/whoway/mylibeventStudy/libevent/src/first_libevent"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\nroot@VMwhoway:/home/whoway/mylibeventStudy/libevent/src/first_libevent"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# make")]),s._v("\nmake: “firstlibevent”已是最新。\nroot@VMwhoway:/home/whoway/mylibeventStudy/libevent/src/first_libevent"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./firstlibevent ")]),s._v("\n./firstlibevent: error "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" loading shared libraries: libevent-2.2.so.1: cannot "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("open")]),s._v(" shared object file: No such "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" or directory\nroot@VMwhoway:/home/whoway/mylibeventStudy/libevent/src/first_libevent"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ln -s /usr/local/lib/libevent-2.2.so.1 /usr/lib64/libevent-2.2.so.1")]),s._v("\nln: 无法创建符号链接 "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/usr/lib64/libevent-2.2.so.1'")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" 文件已存在\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("ul",[t("li",[s._v("最后的参考：https://www.cnblogs.com/chendaye666/p/13210513.html")])]),s._v(" "),t("p",[s._v("首先查找库文件是否存在")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("sudo find / -name libevent-2.2.so.1\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("结果发现在")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("/usr/local/lib/libevent-2.2.so.1\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("==建立软链接：==")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v(" sudo ln -s /usr/local/lib/libevent-2.2.so.1 /usr/lib/libevent-2.2.so.1\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("我的修改")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("root@VMwhoway:/home/whoway/mylibeventStudy/libevent/src/first_libevent"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ln -s /usr/local/lib/libevent-2.2.so.1 /usr/lib/libevent-2.2.so.1")]),s._v("\nroot@VMwhoway:/home/whoway/mylibeventStudy/libevent/src/first_libevent"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# make")]),s._v("\nmake: “firstlibevent”已是最新。\nroot@VMwhoway:/home/whoway/mylibeventStudy/libevent/src/first_libevent"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./firstlibevent ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" libevent"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\nevent_base_new success"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("h2",{attrs:{id:"_2-第2章libevent原理和网络模型设置-8"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-第2章libevent原理和网络模型设置-8"}},[s._v("#")]),s._v(" 2.第2章Libevent原理和网络模型设置-8")]),s._v(" "),t("h3",{attrs:{id:"✔️2-1-高并发网络模型-多路复用-select、epoll、iocp区别"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#✔️2-1-高并发网络模型-多路复用-select、epoll、iocp区别"}},[s._v("#")]),s._v(" ✔️2-1.高并发网络模型(多路复用)select、epoll、iocp区别")]),s._v(" "),t("p",[s._v("分析几种高并发的网络模型")]),s._v(" "),t("p",[s._v("因为libevent里面会用到这些模型，我们在配置的时候可以去选定，但是"),t("strong",[s._v("对外的接口")]),s._v("是一致的，只是在做这些模型的时候，你应该知道，什么时候你应该选什么。")]),s._v(" "),t("p",[s._v("​\t比如说，我们用epoll是不是可以自己实现，其实libevent帮你实现了，他的源码还是相对容易读懂的，比你去实现，其实bug会更少一点。")]),s._v(" "),t("p",[s._v("​\t当然，libevent应该提供了不止这4种模型，我们来讲解这几种用得比较多的模型。")]),s._v(" "),t("p",[s._v("==根据select poll epoll是怎么和"),t("strong",[s._v("内核去交互的")]),s._v("，你就能推断出他的一些优缺点==。当然你还是要去分析内核才能知道他的优缺点。这几种都是做多路复用。")]),s._v(" "),t("p",[s._v("​\t他们之间有优缺点，如果全是优点，那必然就没有4个模型了。")]),s._v(" "),t("p",[s._v("我们之前的一种方法就是，做：阻塞式的，所有的接口阻塞，等到新的连接进来，我们再轮询。而我们现在多路复用啊，都不是阻塞的，我们去定时的去询，查询看是否有数据需要我们去读写，是个轮询的机制。**基本上我们多路复用都是这样一种机制。**那我们看他们之间有什么差别呢？而且优缺点。")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("select")]),s._v(" "),t("th",[s._v("poll")]),s._v(" "),t("th",[s._v("epoll")]),s._v(" "),t("th",[s._v("iocp")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("有连接数的限制，比如1k个连接进来，我去监控")]),s._v(" "),t("td"),s._v(" "),t("td"),s._v(" "),t("td")]),s._v(" "),t("tr",[t("td",[s._v("这1k个连接哪一个是处于准备状态就是可读状态，我要去遍历的去查找，这1千个")]),s._v(" "),t("td"),s._v(" "),t("td"),s._v(" "),t("td")]),s._v(" "),t("tr",[t("td",[s._v("那这个状态是哪里获取呢？（或许我们做10W、100W个吧）我们怎么知道这10万个连接从哪里读出来呢？select做的事情是：你就问内核吧，内核其实就是和底层的驱动相关，说白了就是网卡，，我们这个调用在上层，在用户态，那我们select，我每次都要告诉内核，哪个可读，也就是这个时候，我们要把数据拷贝给内核空间，内核空间等于说还要读出来，这10万个，哪些可读，哪些不可读，这个是不是有开销？")]),s._v(" "),t("td"),s._v(" "),t("td"),s._v(" "),t("td")]),s._v(" "),t("tr",[t("td",[s._v("1、有内存复制的开销2、我们的10W个链接，要遍历10W次，每次查询O(n)，轮询10W次，开销大")]),s._v(" "),t("td"),s._v(" "),t("td"),s._v(" "),t("td")]),s._v(" "),t("tr",[t("td",[s._v("为什么select这么做呢？因为连接数没多到一定程度的时候，这个接口最简单")]),s._v(" "),t("td"),s._v(" "),t("td"),s._v(" "),t("td")]),s._v(" "),t("tr",[t("td",[s._v("有时候开发简单，对系统API调用简单，而且我们多路复用，针对的是大量的连接，但是很少的访问，他的连接数量还是有限的。从这个角度，他是针对大量的链接，比如10W个链接，其实只有1k个是要读的，其他的9W多不要（如果你10W个链接，10W个都要读，那你用不用多路复用都没有区别了，那你就像用阻塞也行啊，不可能有这种）保持10W连接，但是只有1K来读，所以这个时候就有这个问题了")]),s._v(" "),t("td"),s._v(" "),t("td"),s._v(" "),t("td")]),s._v(" "),t("tr",[t("td",[s._v("从这个角度考虑，每次是不是只要1K个就好了，你干嘛把10W个都给我呢？而且我每次都拷10W个给你，为什么每次都要拷贝，我拷贝1次给你行不行。所以基于这种考虑，我们做了这样一个优化！")]),s._v(" "),t("td"),s._v(" "),t("td"),s._v(" "),t("td")])])]),s._v(" "),t("p",[s._v("首先，后面引用epoll或者iocp的原因还是因为select的解决，select的一些问题")]),s._v(" "),t("ul",[t("li",[s._v("poll")])]),s._v(" "),t("p",[s._v("内部实现，基本上和select一致，唯一区别，他代码上没有FD_size的限制，也就是说他不限制数量。但是根本上讲，二者是一样的，所以我们不去分析poll了")]),s._v(" "),t("ul",[t("li",[s._v("epoll")])]),s._v(" "),t("p",[s._v("在解决select的这个问题时候，他怎么解决的？")]),s._v(" "),t("p",[s._v("1、每次从用户空间拷贝到内核空间，怎么解决的？")]),s._v(" "),t("p",[s._v("epoll的特点，只拷贝1次！而且他们是用的共享内存来交互，只拷贝1次，在第1次的时候把他拷进去。")]),s._v(" "),t("p",[s._v("内部存储只基于红黑树来存储的。")]),s._v(" "),t("p",[s._v("2、遍历整个？")]),s._v(" "),t("p",[s._v("epoll的解决方案，不用你去遍历，但他还是，，他通过红黑树的方式，他内部取出来，哪些是可读的，他传给你，而且内存是共享的。而且他转的话")]),s._v(" "),t("p",[s._v("比如10W个链接，只要第1次传进去")]),s._v(" "),t("p",[s._v("第2次有1k个链接时候，他只返回给你1k个链接，也就epoll的特点。这就解决了就遍历了，你这里要遍历10W，我这里只要遍历1K次。")]),s._v(" "),t("p",[s._v("他内部的话，他内部还是要判断，内部判断时候，其实他做的什么？他是红黑树，他的时间少做一次，我们少做1次处理（8分03）")]),s._v(" "),t("ul",[t("li",[s._v("epoll解决了select这2个问题\n"),t("ul",[t("li",[s._v("1、拷贝数的问题")]),s._v(" "),t("li",[s._v("2、查找哪些变成可读状态的时候，而我们epoll只要取可读的，因为他通过一个epoll_wait来直接返回那些可读的。")]),s._v(" "),t("li",[s._v("最大监听数，epoll本身也解决了！")])])])]),s._v(" "),t("p",[s._v("tips：")]),s._v(" "),t("p",[s._v("在大量的开源中，底层是select，因为跨平台。")]),s._v(" "),t("p",[s._v("对于有些处理，比如我1K个链接，这1k个连接都是活跃的，那反而可能select的开销比epoll更少一点，epoll毕竟内部存储结构复杂。")]),s._v(" "),t("p",[s._v("epoll支持水平触发和边缘触发（==select相当于水平触发==：也就是说，你这个数据不管你处没处理，select取出这些列表的时候，哪些是可读状态，他一直是可读状态，epoll也是一样，你只要没处理，epoll_wait始终能获取到这个事件，始终能获取到哪些没处理的列表）")]),s._v(" "),t("p",[s._v("边缘触发：只通知一次，我们wait只是第1次调用的时候返回，不管你有没有把这个里面的数据读出来，他不再通知了，所以从这里看出来，他比水平触发效率会更高，，但是可能会更复杂，你第2次，你必须保证数据全读完了。水平触发的话，只要你没读完，你都可以去读。水平触发开销大一点，但是代码简单。")]),s._v(" "),t("p",[s._v("水平和边缘，他们的内部实现其实差不多的，只是在epoll_wait这边，他每次去取的时候，边缘触发的话，他每次从红黑树里面把这个事件取出来后，他就把里面删掉了。而水平触发的话，他不删，我们把他取出来后，我们直接看他状态。")]),s._v(" "),t("ul",[t("li",[s._v("iocp")])]),s._v(" "),t("p",[s._v("在这些特定当中和epoll差不多，他唯一的区别是：")]),s._v(" "),t("p",[s._v("我们讲（11:20)")]),s._v(" "),t("p",[s._v("iocp加入了线程处理，做了线程库，epoll的话，这部分工作得你做。")]),s._v(" "),t("p",[s._v("iocp可以说是epoll又加强的一个版本吧。")]),s._v(" "),t("p",[s._v("那我们对于libevent来说，这4种他们怎么关联的？libevent他是按照级别：优先级别来处理的，比方说：")]),s._v(" "),t("p",[s._v("epoll、poll、select、iocp的优先级，从高到底 （待会我们看那个源码会看到）")]),s._v(" "),t("p",[s._v("也就是说，他如果有select，他会默认去select，但是如果说有epoll能支持的话，他肯定会用epoll。")]),s._v(" "),t("p",[s._v("而iocp的话，需要你去指定，你不指定的话，优先级是最低的。应该是在代码中，只支持在Windows中用。")]),s._v(" "),t("blockquote",[t("p",[s._v("建议：")])]),s._v(" "),t("p",[s._v("因为libevent后边的代码的时候，可能你会代码不涉及他们，但是中途的一些问题or错误，你肯定要知道他是什么机制，才会产生的，比方说，你要知道他是用epoll的啥的。")]),s._v(" "),t("p",[s._v("建议再找资料，深入理解。")]),s._v(" "),t("h3",{attrs:{id:"_2-2-libevent接口分析"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-libevent接口分析"}},[s._v("#")]),s._v(" 2-2.libevent接口分析")]),s._v(" "),t("p",[s._v("写libevent的")]),s._v(" "),t("div",{staticClass:"language-cpp line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-cpp"}},[t("code",[s._v("event_base_new   包括选择什么样的模型，比如iocp \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"_2-3-libevent服务端接收连接的代码示例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-libevent服务端接收连接的代码示例"}},[s._v("#")]),s._v(" 2-3 libevent服务端接收连接的代码示例")]),s._v(" "),t("h3",{attrs:{id:"_2-4-libevent上下文属性配置和源码分析"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-libevent上下文属性配置和源码分析"}},[s._v("#")]),s._v(" 2-4 libevent上下文属性配置和源码分析")]),s._v(" "),t("h3",{attrs:{id:"_2-5-获取系统所支持的网络模型例如epoll-select"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-5-获取系统所支持的网络模型例如epoll-select"}},[s._v("#")]),s._v(" 2-5 获取系统所支持的网络模型例如epoll_select")]),s._v(" "),t("h3",{attrs:{id:"_2-6-配置特征-例如边缘触发-并判断是否生效event-con"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-6-配置特征-例如边缘触发-并判断是否生效event-con"}},[s._v("#")]),s._v(" 2-6 配置特征-例如边缘触发_并判断是否生效event_con")]),s._v(" "),t("h3",{attrs:{id:"_2-7-设置网络模型并显示当前应用的网络模型event-config"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-7-设置网络模型并显示当前应用的网络模型event-config"}},[s._v("#")]),s._v(" 2-7 设置网络模型并显示当前应用的网络模型event_config")]),s._v(" "),t("h3",{attrs:{id:"_2-8-windows上使用iocp网络模型并测试"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-8-windows上使用iocp网络模型并测试"}},[s._v("#")]),s._v(" 2-8 windows上使用iocp网络模型并测试")]),s._v(" "),t("h2",{attrs:{id:"参考资料"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参考资料"}},[s._v("#")]),s._v(" 参考资料")]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://edu.51cto.com/course/17731.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Libevent C++高并发网络编程"),t("OutboundLink")],1),s._v("，南京大学，夏曹俊")]),s._v(" "),t("li",[s._v("zlib")]),s._v(" "),t("li",[s._v("openssl")]),s._v(" "),t("li",[s._v("libevent"),t("a",{attrs:{href:"https://www.doc88.com/p-9488285457881.html?r=1",target:"_blank",rel:"noopener noreferrer"}},[s._v("参考手册(中文版)"),t("OutboundLink")],1)]),s._v(" "),t("li",[s._v("libevent+线程池 | "),t("a",{attrs:{href:"https://www.bilibili.com/video/BV1iR4y1w7fS/",target:"_blank",rel:"noopener noreferrer"}},[s._v("仿学习强国答题挑战系统"),t("OutboundLink")],1)]),s._v(" "),t("li",[s._v("libevent"),t("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/370666536",target:"_blank",rel:"noopener noreferrer"}},[s._v("源码深度剖析"),t("OutboundLink")],1),s._v("，张亮，知乎")])])])}),[],!1,null,null,null);t.default=n.exports}}]);