(window.webpackJsonp=window.webpackJsonp||[]).push([[128],{412:function(s,e,a){"use strict";a.r(e);var n=a(14),t=Object(n.a)({},(function(){var s=this,e=s._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"力扣mysql题解"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#力扣mysql题解"}},[s._v("#")]),s._v(" 力扣MySQL题解")]),s._v(" "),e("h2",{attrs:{id:"目录"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#目录"}},[s._v("#")]),s._v(" 目录")]),s._v(" "),e("p"),e("div",{staticClass:"table-of-contents"},[e("ul",[e("li",[e("a",{attrs:{href:"#目录"}},[s._v("目录")])]),e("li",[e("a",{attrs:{href:"#力扣-sql入门"}},[s._v("力扣-SQL入门")]),e("ul",[e("li",[e("a",{attrs:{href:"#_1-选择"}},[s._v("1.选择")])]),e("li",[e("a",{attrs:{href:"#_2-排序-修改"}},[s._v("2.排序 & 修改")])]),e("li",[e("a",{attrs:{href:"#_3-字符串处理函数-正则"}},[s._v("3.字符串处理函数/正则")])]),e("li",[e("a",{attrs:{href:"#_4-组合查询-指定选取"}},[s._v("4.组合查询&指定选取")])]),e("li",[e("a",{attrs:{href:"#_5-合并"}},[s._v("5.合并")])]),e("li",[e("a",{attrs:{href:"#_6-合并"}},[s._v("6.合并")])]),e("li",[e("a",{attrs:{href:"#_7-计算函数"}},[s._v("7.计算函数")])]),e("li",[e("a",{attrs:{href:"#_8-计算函数"}},[s._v("8.计算函数")])]),e("li",[e("a",{attrs:{href:"#_9-控制流"}},[s._v("9.控制流")])]),e("li",[e("a",{attrs:{href:"#_10-过滤"}},[s._v("10.过滤")])])])]),e("li",[e("a",{attrs:{href:"#力扣-sql-基础plus会员-11天"}},[s._v("力扣-SQL 基础plus会员-11天")]),e("ul",[e("li",[e("a",{attrs:{href:"#_1-数值处理函数"}},[s._v("1.数值处理函数")])]),e("li",[e("a",{attrs:{href:"#_2-数值处理函数"}},[s._v("2.数值处理函数")])]),e("li",[e("a",{attrs:{href:"#_3-连接"}},[s._v("3.连接")])]),e("li",[e("a",{attrs:{href:"#_4-连接"}},[s._v("4.连接")])]),e("li",[e("a",{attrs:{href:"#_5-连接"}},[s._v("5.连接")])]),e("li",[e("a",{attrs:{href:"#_6-连接"}},[s._v("6.连接")])]),e("li",[e("a",{attrs:{href:"#_7-连接"}},[s._v("7.连接")])]),e("li",[e("a",{attrs:{href:"#_8-不等式连接"}},[s._v("8.不等式连接")])]),e("li",[e("a",{attrs:{href:"#_9-子查询"}},[s._v("9.子查询")])]),e("li",[e("a",{attrs:{href:"#_10-子查询"}},[s._v("10.子查询")])]),e("li",[e("a",{attrs:{href:"#_11-子查询"}},[s._v("11.子查询")])])])])])]),e("p"),s._v(" "),e("p",[s._v("[TOC]")]),s._v(" "),e("h2",{attrs:{id:"力扣-sql入门"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#力扣-sql入门"}},[s._v("#")]),s._v(" 力扣-SQL入门")]),s._v(" "),e("h3",{attrs:{id:"_1-选择"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-选择"}},[s._v("#")]),s._v(" 1.选择")]),s._v(" "),e("h4",{attrs:{id:"_595-大的国家"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_595-大的国家"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/big-countries/",target:"_blank",rel:"noopener noreferrer"}},[s._v("595. 大的国家"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect name , population, area\nfrom World\nwhere area>=3000000 or population>=25000000\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h4",{attrs:{id:"_1757-可回收且低脂的产品"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1757-可回收且低脂的产品"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/recyclable-and-low-fat-products/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1757. 可回收且低脂的产品"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect product_id \nfrom Products\nwhere 'Y'=recyclable and 'Y'=low_fats\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h4",{attrs:{id:"_584-寻找用户推荐人"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_584-寻找用户推荐人"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/find-customer-referee/",target:"_blank",rel:"noopener noreferrer"}},[s._v("584. 寻找用户推荐人"),e("OutboundLink")],1)]),s._v(" "),e("ul",[e("li",[s._v("易错，本题，必须判断"),e("code",[s._v("referee_id is null")])])]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect name \nfrom customer\nwhere ( not referee_id=2 ) or  referee_id is null\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h4",{attrs:{id:"_183-从不订购的客户⭐️"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_183-从不订购的客户⭐️"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/customers-who-never-order/",target:"_blank",rel:"noopener noreferrer"}},[s._v("183. 从不订购的客户"),e("OutboundLink")],1),s._v("⭐️")]),s._v(" "),e("ul",[e("li",[s._v("not in的使用")])]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect name as Customers\nfrom Customers\nwhere Id not in\n( \n    select CustomerId\n    from Orders\n)\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("ul",[e("li",[s._v("更加明确的写法如下⭐️⭐️")])]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select Customers.name as Customers\nfrom Customers\nwhere Customers.id not in\n(\n    select Customerid from Orders\n)\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("h3",{attrs:{id:"_2-排序-修改"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-排序-修改"}},[s._v("#")]),s._v(" 2.排序 & 修改")]),s._v(" "),e("h4",{attrs:{id:"_1873-计算特殊奖金⭐️"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1873-计算特殊奖金⭐️"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/calculate-special-bonus/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1873. 计算特殊奖金"),e("OutboundLink")],1),s._v("⭐️")]),s._v(" "),e("ul",[e("li",[s._v("学习case end的使用")])]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect employee_id , \ncase\n  when ( left(name,1)!='M' and employee_id % 2=1 ) then salary\n  else 0\nend \nas bonus\nfrom Employees\norder by employee_id\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h4",{attrs:{id:"_627-变更性别⭐️"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_627-变更性别⭐️"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/swap-salary/",target:"_blank",rel:"noopener noreferrer"}},[s._v("627. 变更性别"),e("OutboundLink")],1),s._v("⭐️")]),s._v(" "),e("ul",[e("li",[s._v("if语句")])]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nupdate Salary\nset sex=\n    if( 'f'=sex ,\n    'm','f')\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("ul",[e("li",[s._v("case解法")])]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nupdate Salary\nset sex=\n    case sex\n        when 'f' then 'm'\n        when 'm' then 'f'\n    end\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("h4",{attrs:{id:"_196-删除重复的电子邮箱⭐️"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_196-删除重复的电子邮箱⭐️"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/delete-duplicate-emails/",target:"_blank",rel:"noopener noreferrer"}},[s._v("196. 删除重复的电子邮箱"),e("OutboundLink")],1),s._v("⭐️")]),s._v(" "),e("ul",[e("li",[s._v("自连接！学习⭐️⭐️")])]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Please write a DELETE statement and DO NOT write a SELECT statement.\n# Write your MySQL query statement below\ndelete p1 \n\tfrom Person p1 ,Person p2\nwhere p1.Email =p2.Email and p1.Id > p2.Id\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h3",{attrs:{id:"_3-字符串处理函数-正则"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-字符串处理函数-正则"}},[s._v("#")]),s._v(" 3.字符串处理函数/正则")]),s._v(" "),e("h4",{attrs:{id:"_1667-修复表中的名字"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1667-修复表中的名字"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/fix-names-in-a-table/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1667. 修复表中的名字"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nSELECT user_id, \n    CONCAT(UPPER(SUBSTRING(name, 1, 1)),\n         LOWER(SUBSTRING(name, 2, (SELECT LENGTH(name))))) name\nFROM Users\nORDER BY user_id\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("h4",{attrs:{id:"_1484-按日期分组销售产品"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1484-按日期分组销售产品"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/group-sold-products-by-the-date/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1484. 按日期分组销售产品"),e("OutboundLink")],1)]),s._v(" "),e("ul",[e("li",[s._v("记忆，不会的"),e("code",[s._v("GROUP_CONCAT（）")]),s._v("函数")])]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select \n    sell_date, \n    # 获取“不同的”产品数【count(distinct product)】\n    count(distinct product) as num_sold, \n    # “不同的”【distinct product】产品按照字典排序【order by product】  & “,”分割【separator ','】\n    group_concat(distinct product order by product separator ',') as products\nfrom Activities\ngroup by sell_date\norder by sell_date;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h4",{attrs:{id:"_1527-患某种疾病的患者"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1527-患某种疾病的患者"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/patients-with-a-condition/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1527. 患某种疾病的患者"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect patient_id,patient_name, conditions\nfrom Patients\nwhere conditions like '% DIAB1%'\n    or conditions like'DIAB1%'\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h3",{attrs:{id:"_4-组合查询-指定选取"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-组合查询-指定选取"}},[s._v("#")]),s._v(" 4.组合查询&指定选取")]),s._v(" "),e("h4",{attrs:{id:"_1965-丢失信息的雇员"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1965-丢失信息的雇员"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/employees-with-missing-information/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1965. 丢失信息的雇员"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect employee_id from (\n    select e.employee_id employee_id from Employees e left join Salaries s on e.employee_id=s.employee_id where salary is null\n    union all\n    select s.employee_id employee_id from Employees e right join Salaries s on e.employee_id=s.employee_id where name is null\n) x order by employee_id;\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("h4",{attrs:{id:"_1795-每个产品在不同商店的价格"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1795-每个产品在不同商店的价格"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/rearrange-products-table/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1795. 每个产品在不同商店的价格"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect product_id, 'store1' store, store1 price from products where store1 is not NULL\nUNION\nselect product_id, 'store2' store, store2 price from products where store2 is not NULL\nUNION\nselect product_id, 'store3' store, store3 price from products where store3 is not NULL\n\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("h4",{attrs:{id:"_608-树节点"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_608-树节点"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/tree-node/",target:"_blank",rel:"noopener noreferrer"}},[s._v("608. 树节点"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\n# Write your MySQL query statement below\nselect id,(\n    case WHEN p_id is null THEN 'Root'\n        WHEN id in(select p_id from tree) THEN 'Inner'\n        else 'Leaf' END)\n    as type from tree \norder by id\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("h4",{attrs:{id:"_176-第二高的薪水"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_176-第二高的薪水"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/second-highest-salary/",target:"_blank",rel:"noopener noreferrer"}},[s._v("176. 第二高的薪水"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nSELECT\n    (SELECT DISTINCT\n            Salary\n        FROM\n            Employee\n        ORDER BY Salary DESC\n        LIMIT 1 OFFSET 1) AS SecondHighestSalary\n;\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("h3",{attrs:{id:"_5-合并"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-合并"}},[s._v("#")]),s._v(" 5.合并")]),s._v(" "),e("p",[s._v("多表的联结又分为以下几种类型：")]),s._v(" "),e("p",[s._v("1）左联结（left join），联结结果保留左表的全部数据")]),s._v(" "),e("p",[s._v("2）右联结（right join），联结结果保留右表的全部数据")]),s._v(" "),e("p",[s._v("3）内联结（inner join），取两表的公共数据")]),s._v(" "),e("h4",{attrs:{id:"_175-组合两个表"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_175-组合两个表"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/combine-two-tables/",target:"_blank",rel:"noopener noreferrer"}},[s._v("175. 组合两个表"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect FirstName, LastName, City, State\nfrom Person left join Address\non Person.PersonId = Address.PersonId\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h4",{attrs:{id:"_1581-进店却未进行过交易的顾客"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1581-进店却未进行过交易的顾客"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/customer-who-visited-but-did-not-make-any-transactions/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1581. 进店却未进行过交易的顾客"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect a.customer_id, count(1) count_no_trans \n    from Visits a\n    where a.visit_id not in (select b.visit_id from Transactions b)\n    group by a.customer_id\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("h4",{attrs:{id:"_1148-文章浏览-i"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1148-文章浏览-i"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/article-views-i/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1148. 文章浏览 I"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect distinct author_id as id\nfrom  Views\nwhere author_id = viewer_id\norder by author_id\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("h3",{attrs:{id:"_6-合并"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-合并"}},[s._v("#")]),s._v(" 6.合并")]),s._v(" "),e("h4",{attrs:{id:"_197-上升的温度"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_197-上升的温度"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/rising-temperature/",target:"_blank",rel:"noopener noreferrer"}},[s._v("197. 上升的温度"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nSELECT b.Id\nFROM Weather as a,Weather as b\nWHERE a.Temperature < b.Temperature and DATEDIFF(a.RecordDate,b.RecordDate) = -1;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h4",{attrs:{id:"_607-销售员"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_607-销售员"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/sales-person/",target:"_blank",rel:"noopener noreferrer"}},[s._v("607. 销售员"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('select distinct name from SalesPerson where sales_id not in (\n    select distinct sales_id from Orders where com_id=(\n        select com_id from Company where name="RED"\n    )\n);\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h3",{attrs:{id:"_7-计算函数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_7-计算函数"}},[s._v("#")]),s._v(" 7.计算函数")]),s._v(" "),e("h4",{attrs:{id:"_1141-查询近30天活跃用户数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1141-查询近30天活跃用户数"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/user-activity-for-the-past-30-days-i/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1141. 查询近30天活跃用户数"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\n# Write your MySQL query statement below\nselect activity_date as day,count(distinct user_id) as active_users\nfrom\n    Activity\nwhere\n    activity_date between '2019-06-28' and '2019-07-27'\ngroup by\n    activity_date;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h4",{attrs:{id:"_1693-每天的领导和合伙人"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1693-每天的领导和合伙人"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/daily-leads-and-partners/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1693. 每天的领导和合伙人"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect date_id , make_name ,count(distinct lead_id) unique_leads , count(distinct partner_id) unique_partners\nfrom dailysales\ngroup by date_id,make_name;\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h4",{attrs:{id:"_1729-求关注者的数量"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1729-求关注者的数量"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/find-followers-count/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1729. 求关注者的数量"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect user_id, count(1) followers_count \nfrom Followers \ngroup by user_id \norder by user_id;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h3",{attrs:{id:"_8-计算函数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_8-计算函数"}},[s._v("#")]),s._v(" 8.计算函数")]),s._v(" "),e("h4",{attrs:{id:"_511-游戏玩法分析-i"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_511-游戏玩法分析-i"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/game-play-analysis-i/",target:"_blank",rel:"noopener noreferrer"}},[s._v("511. 游戏玩法分析 I"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect player_id,min(event_date) as 'first_login'\nfrom Activity\ngroup by player_id\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h4",{attrs:{id:"_586-订单最多的客户"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_586-订单最多的客户"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/customer-placing-the-largest-number-of-orders/",target:"_blank",rel:"noopener noreferrer"}},[s._v("586. 订单最多的客户"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("SELECT\n    customer_number\nFROM\n    orders\nGROUP BY customer_number\nORDER BY COUNT(*) DESC\nLIMIT 1\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("h4",{attrs:{id:"_1890-2020年最后一次登录"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1890-2020年最后一次登录"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/the-latest-login-in-2020/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1890. 2020年最后一次登录"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\n# Write your MySQL query statement below\nselect\n    user_id,max(time_stamp) as last_stamp \nfrom\n    Logins\nwhere\n    time_stamp between '2020-01-01' and '2021-01-01'\ngroup by \n    user_id\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])]),e("h4",{attrs:{id:"_1741-查找每个员工花费的总时间"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1741-查找每个员工花费的总时间"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/find-total-time-spent-by-each-employee/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1741. 查找每个员工花费的总时间"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("SELECT\n    event_day day, emp_id, SUM(out_time - in_time) total_time\nFROM\n    Employees\nGROUP BY\n    event_day, emp_id;\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("h3",{attrs:{id:"_9-控制流"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_9-控制流"}},[s._v("#")]),s._v(" 9.控制流")]),s._v(" "),e("h4",{attrs:{id:"_1393-股票的资本损益"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1393-股票的资本损益"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/capital-gainloss/?envType=study-plan&id=sql-beginner&plan=sql&plan_progress=4o17k31",target:"_blank",rel:"noopener noreferrer"}},[s._v("1393. 股票的资本损益"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\n# Write your MySQL query statement below\n# 方法一 case when\n# select stock_name, sum(\n#     case when operation = 'buy' then -price\n#     else price end\n# ) as capital_gain_loss \n# from stocks \n# group by stock_name;\n\n# 方法二 if语句\nselect stock_name, sum(\n    if(operation = 'buy', -price, price)\n) as capital_gain_loss \nfrom stocks \ngroup by stock_name;\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br")])]),e("h4",{attrs:{id:"_1407-排名靠前的旅行者"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1407-排名靠前的旅行者"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/top-travellers/?envType=study-plan&id=sql-beginner&plan=sql&plan_progress=4o17k31",target:"_blank",rel:"noopener noreferrer"}},[s._v("1407. 排名靠前的旅行者"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\n# Write your MySQL query statement below\n# 1.先查出每个有行程的用户的距离 用到group by 和sum\n# 2.由于没有行程的用户也需要查找所以需用到left join(主表数据不受影响),\n#   再通过IFNULL()函数对行程为null的用户赋值为0,最后对其order by排序就行了\nselect name, ifnull (travelled_distance,0) as travelled_distance\nfrom Users\n\nleft join\n(\n    select\n    user_id,sum(distance) as travelled_distance \n    from Rides \n        group by user_id\n)t1\non t1.user_id= Users.id\norder by travelled_distance desc, name asc\n\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br")])]),e("h4",{attrs:{id:"_1158-市场分析-i"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1158-市场分析-i"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/market-analysis-i/?envType=study-plan&id=sql-beginner&plan=sql&plan_progress=4o17k31",target:"_blank",rel:"noopener noreferrer"}},[s._v("1158. 市场分析 I"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect Users.user_id as buyer_id, \n    join_date, \n    ifnull(UserBuy.cnt, 0) as orders_in_2019\nfrom Users\nleft join (\n    select buyer_id, count(order_id) cnt \n    from Orders\n    where order_date between '2019-01-01' and '2019-12-31'\n    group by buyer_id\n) UserBuy\non Users.user_id = UserBuy.buyer_id\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br")])]),e("h3",{attrs:{id:"_10-过滤"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_10-过滤"}},[s._v("#")]),s._v(" 10.过滤")]),s._v(" "),e("h4",{attrs:{id:"_182-查找重复的电子邮箱"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_182-查找重复的电子邮箱"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/duplicate-emails/?envType=study-plan&id=sql-beginner&plan=sql&plan_progress=4o17k31",target:"_blank",rel:"noopener noreferrer"}},[s._v("182. 查找重复的电子邮箱"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect Email\nfrom Person\ngroup by Email\nhaving count(Email) > 1\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h4",{attrs:{id:"_1050-合作过至少三次的演员和导演"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1050-合作过至少三次的演员和导演"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/actors-and-directors-who-cooperated-at-least-three-times/?envType=study-plan&id=sql-beginner&plan=sql&plan_progress=4o17k31",target:"_blank",rel:"noopener noreferrer"}},[s._v("1050. 合作过至少三次的演员和导演"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect actor_id , director_id\nfrom ActorDirector\ngroup by actor_id , director_id\nhaving count(timestamp) >= 3\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h4",{attrs:{id:"_1587-银行账户概要-ii"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1587-银行账户概要-ii"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/bank-account-summary-ii/?envType=study-plan&id=sql-beginner&plan=sql&plan_progress=4o17k31",target:"_blank",rel:"noopener noreferrer"}},[s._v("1587. 银行账户概要 II"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect    name, SUM(amount) balance\nfrom\n    Users u \njoin\n    Transactions t \non\n    u.account = T.account\ngroup by\n    u.account\nhaving\n    sum(amount) > 10000;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br")])]),e("h4",{attrs:{id:"_1084-销售分析iii"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1084-销售分析iii"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/sales-analysis-iii/?envType=study-plan&id=sql-beginner&plan=sql&plan_progress=4o17k31",target:"_blank",rel:"noopener noreferrer"}},[s._v("1084. 销售分析III"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select product_id, product_name\nfrom product\nwhere product_id in (\n    select\n        product_id\n    from sales\n    group by product_id\n    having max(sale_date) <= '2019-03-31' and min(sale_date) >= '2019-01-01'\n)\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h2",{attrs:{id:"力扣-sql-基础plus会员-11天"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#力扣-sql-基础plus会员-11天"}},[s._v("#")]),s._v(" 力扣-SQL 基础plus会员-11天")]),s._v(" "),e("h3",{attrs:{id:"_1-数值处理函数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-数值处理函数"}},[s._v("#")]),s._v(" 1.数值处理函数")]),s._v(" "),e("h4",{attrs:{id:"_1699-两人之间的通话次数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1699-两人之间的通话次数"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/number-of-calls-between-two-persons/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1699. 两人之间的通话次数"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\n# Write your MySQL query statement below\nSELECT \n    person1,person2, \n    count(*) call_count, \n    sum(duration) total_duration \nFROM (\nSELECT \n    IF(from_id>to_id, to_id, from_id) person1, \n    IF(from_id>to_id,from_id,to_id) person2, \n    duration  \nFROM calls \n) c \nGROUP BY \n    person1, person2\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br")])]),e("h4",{attrs:{id:"_1251-平均售价"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1251-平均售价"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/average-selling-price/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1251. 平均售价"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("SELECT u.product_id product_id,\n        ROUND(SUM(u.units*p.price)/SUM(u.units),2) average_price        \nFROM UnitsSold u ,Prices p\nWHERE u.product_id=p.product_id \n        AND u.purchase_date BETWEEN p.start_date AND p.end_date\nGROUP BY u.product_id\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("h4",{attrs:{id:"_1571-仓库经理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1571-仓库经理"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/warehouse-manager/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1571. 仓库经理"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nSELECT \n    w.name WAREHOUSE_NAME,\n    SUM(p.Width * p.Length * p.Height * w.units) VOLUME\nFROM \n    warehouse w\nLEFT JOIN \n    products p\nON \n    w.product_id = p.product_id\nGROUP BY w.name;\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br")])]),e("h4",{attrs:{id:"_1445-苹果和桔子"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1445-苹果和桔子"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/apples-oranges/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1445. 苹果和桔子"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select    sale_date,\n    sum(\n        if(fruit = 'apples', sold_num, -sold_num)\n    ) as diff\n    from sales\ngroup by sale_date\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("h3",{attrs:{id:"_2-数值处理函数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-数值处理函数"}},[s._v("#")]),s._v(" 2.数值处理函数")]),s._v(" "),e("h4",{attrs:{id:"_1193-每月交易-i"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1193-每月交易-i"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/monthly-transactions-i/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1193. 每月交易 I"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select date_format(trans_date,'%Y-%m') as month,\n        country, count(*) as trans_count, \n        sum(case state when 'approved' then 1 else 0 end) as approved_count,\n        sum(amount) as trans_total_amount,\n        sum(case state when 'approved' then amount else 0 end) as approved_total_amount\nfrom Transactions\ngroup by month,country;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("h4",{attrs:{id:"_1633-各赛事的用户注册率"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1633-各赛事的用户注册率"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/percentage-of-users-attended-a-contest/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1633. 各赛事的用户注册率"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\n\nselect contest_id,\n       round(count(user_id) / (select count(1) from Users) * 100, 2) as percentage\n       from Register\n       group by contest_id\n       order by percentage desc , contest_id\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("h4",{attrs:{id:"_1173-即时食物配送-i"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1173-即时食物配送-i"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/immediate-food-delivery-i/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1173. 即时食物配送 I"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect round (\n    sum(order_date = customer_pref_delivery_date) /\n    count(*) * 100,\n    2\n) as immediate_percentage\nfrom Delivery\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("h4",{attrs:{id:"_1211-查询结果的质量和占比"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1211-查询结果的质量和占比"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/queries-quality-and-percentage/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1211. 查询结果的质量和占比"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect \nquery_name, \n        round(avg(rating/position), 2) quality,\n        round(sum(if(rating < 3, 1, 0)) * 100 / count(*), 2) poor_query_percentage\n        from queries\n        group by query_name\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("h3",{attrs:{id:"_3-连接"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-连接"}},[s._v("#")]),s._v(" 3.连接")]),s._v(" "),e("h4",{attrs:{id:"_1607-没有卖出的卖家"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1607-没有卖出的卖家"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/sellers-with-no-sales/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1607. 没有卖出的卖家"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("/* write your pl/sql query statement below */\nselect s.seller_name from seller s where s.seller_id not in (\n    select o.seller_id from orders o where o.sale_date like '2020%'\n) order by seller_name \n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h4",{attrs:{id:"_619-只出现一次的最大数字"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_619-只出现一次的最大数字"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/biggest-single-number/",target:"_blank",rel:"noopener noreferrer"}},[s._v("619. 只出现一次的最大数字"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select \n(\n    select ifnull(num, null) as num from mynumbers \n    group by num\n    having count(*) = 1\n    order by num desc\n    limit 0, 1\n) num\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h4",{attrs:{id:"_1112-每位学生的最高成绩"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1112-每位学生的最高成绩"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/highest-grade-for-each-student/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1112. 每位学生的最高成绩"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("SELECT student_id, min(course_id) AS course_id, grade\nFROM enrollments\nWHERE (student_id, grade) IN\n(\n    SELECT student_id, MAX(grade) AS grade\n    FROM Enrollments\n    GROUP BY student_id\n)\nGROUP BY student_id, grade\nORDER BY student_id\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])]),e("h4",{attrs:{id:"_1398-购买了产品-a-和产品-b-却没有购买产品-c-的顾客"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1398-购买了产品-a-和产品-b-却没有购买产品-c-的顾客"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/customers-who-bought-products-a-and-b-but-not-c/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1398. 购买了产品 A 和产品 B 却没有购买产品 C 的顾客"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select o.customer_id, c.customer_name from orders o\nleft join customers c\non o.customer_id = c.customer_id\ngroup by customer_id\nhaving \n    SUM(if(product_name = 'A', 1, 0)) > 0 and\n    SUM(if(product_name = 'B', 1, 0)) > 0 and\n    SUM(if(product_name = 'C', 1, 0)) = 0\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("h3",{attrs:{id:"_4-连接"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-连接"}},[s._v("#")]),s._v(" 4.连接")]),s._v(" "),e("h4",{attrs:{id:"_1440-计算布尔表达式的值"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1440-计算布尔表达式的值"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/evaluate-boolean-expression/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1440. 计算布尔表达式的值"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select e.left_operand,e.operator,e.right_operand,\ncase e.operator\n    when '>' then if(v1.value>v2.value,'true','false')\n    when '<' then if(v1.value<v2.value,'true','false')\n    else  if(v1.value=v2.value,'true','false')\nend value\n    \nfrom Expressions e\nleft join Variables v1 on v1.name = e.left_operand \nleft join Variables v2 on v2.name = e.right_operand\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])]),e("h4",{attrs:{id:"_1264-页面推荐"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1264-页面推荐"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/page-recommendations/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1264. 页面推荐"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select distinct page_id as recommended_page\nfrom likes\nwhere user_id in (\n                select user1_id as user_id from friendship where user2_id = 1\n                union all\n                select user2_id as user_id from friendship where user1_id = 1\n                ) and page_id not in (\n                        select page_id from likes where user_id = 1\n                        )\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h4",{attrs:{id:"_570-至少有5名直接下属的经理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_570-至少有5名直接下属的经理"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/managers-with-at-least-5-direct-reports/",target:"_blank",rel:"noopener noreferrer"}},[s._v("570. 至少有5名直接下属的经理"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\nname\nfrom\nemployee as t1 join\n(select\n managerid\n from\n employee\n group by managerid\n having count(managerid) >= 5) as t2\non t1.id = t2.managerid\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br")])]),e("h4",{attrs:{id:"_1303-求团队人数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1303-求团队人数"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/find-the-team-size/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1303. 求团队人数"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# write your mysql query statement below\nselect e.employee_id,t1.team_size from employee e inner join \n(\n    select team_id, \n    count(team_id) as team_size from employee group by team_id\n) t1\non t1.team_id = e.team_id\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("h3",{attrs:{id:"_5-连接"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-连接"}},[s._v("#")]),s._v(" 5.连接")]),s._v(" "),e("h4",{attrs:{id:"_1280-学生们参加各科测试的次数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1280-学生们参加各科测试的次数"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/students-and-examinations/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1280. 学生们参加各科测试的次数"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# 自连接\nwith cte1 as\n(\n    select *\n    from students,subjects\n)\n\n\nselect \n    a.student_id,\n    a.student_name,\n    a.subject_name,\n    ifnull(count(b.subject_name),0) as attended_exams \nfrom cte1 a\nleft join Examinations b\nusing(student_id,subject_name)\ngroup by 1,2,3\norder by 1,2,3\n\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br")])]),e("h4",{attrs:{id:"_1501-可以放心投资的国家"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1501-可以放心投资的国家"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/countries-you-can-safely-invest-in/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1501. 可以放心投资的国家"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# write your mysql query statement below\nselect c.name as country\n\tfrom calls, person, country c\nwhere (caller_id = id or callee_id = id) and country_code = left(phone_number, 3)\n\tgroup by country_code\n\thaving avg(duration) > (select avg(duration) from calls);\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("h4",{attrs:{id:"_184-部门工资最高的员工"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_184-部门工资最高的员工"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/department-highest-salary/",target:"_blank",rel:"noopener noreferrer"}},[s._v("184. 部门工资最高的员工"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    department.name as 'department',\n    employee.name as 'employee',\n    salary\nfrom\n    employee\n        join\n    department on employee.departmentid = department.id\nwhere\n    (employee.departmentid , salary) in\n    (   select\n            departmentid, max(salary)\n        from\n            employee\n        group by departmentid\n\t)\n;\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br")])]),e("h4",{attrs:{id:"_580-统计各专业学生人数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_580-统计各专业学生人数"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/count-student-number-in-departments/",target:"_blank",rel:"noopener noreferrer"}},[s._v("580. 统计各专业学生人数"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    dept_name, count(student_id) as student_number\nfrom\n    department\n        left outer join\n    student on department.dept_id = student.dept_id\ngroup by department.dept_name\norder by student_number desc , department.dept_name\n;\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("h3",{attrs:{id:"_6-连接"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-连接"}},[s._v("#")]),s._v(" 6.连接")]),s._v(" "),e("h4",{attrs:{id:"_1294-不同国家的天气类型"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1294-不同国家的天气类型"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/weather-type-in-each-country/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1294. 不同国家的天气类型"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nSELECT country_name AS 'country_name',\n    CASE \n        WHEN AVG(w1.weather_state) <= 15 THEN 'Cold' \n        WHEN AVG(w1.weather_state) >= 25 THEN 'Hot'\n        ELSE 'Warm'\n    END\n        AS 'weather_type'\nFROM \n    Countries AS c1\n    INNER JOIN Weather AS w1\n    ON c1.country_id = w1.country_id\nWHERE w1.day BETWEEN '2019-11-01' AND '2019-11-30'\nGROUP BY c1.country_id\n;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br")])]),e("h4",{attrs:{id:"_626-换座位"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_626-换座位"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/exchange-seats/",target:"_blank",rel:"noopener noreferrer"}},[s._v("626. 换座位"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    (case\n        when mod(id, 2) != 0 and counts != id then id + 1\n        when mod(id, 2) != 0 and counts = id then id\n        else id - 1\n    end) as id,\n    student\nfrom\n    seat,\n    (select\n        count(*) as counts\n    from\n        seat) as seat_counts\norder by id asc;\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br")])]),e("h4",{attrs:{id:"_1783-大满贯数量"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1783-大满贯数量"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/grand-slam-titles/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1783. 大满贯数量"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\n#计算Championships表中每个运动员id出现的次数\n\nSELECT player_id,player_name,\n      SUM(IF(player_id=Wimbledon,1,0)+IF(player_id=Fr_open,1,0)+IF(player_id=US_open,1,0)+IF(player_id=Au_open,1,0)) AS grand_slams_count\nFROM Championships \nJOIN Players \nGROUP BY player_id\nHAVING grand_slams_count>0\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h4",{attrs:{id:"_1164-指定日期的产品价格"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1164-指定日期的产品价格"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/product-price-at-a-given-date/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1164. 指定日期的产品价格"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select p1.product_id, ifnull(p2.new_price, 10) as price\nfrom (\n    select distinct product_id\n    from products\n) as p1 -- 所有的产品\nleft join (\n    select product_id, new_price \n    from products\n    where (product_id, change_date) in (\n        select product_id, max(change_date)\n        from products\n        where change_date <= '2019-08-16'\n        group by product_id\n    )\n) as p2 -- 在 2019-08-16 之前有过修改的产品和最新的价格\non p1.product_id = p2.product_id\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br")])]),e("h3",{attrs:{id:"_7-连接"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_7-连接"}},[s._v("#")]),s._v(" 7.连接")]),s._v(" "),e("h4",{attrs:{id:"_603-连续空余座位"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_603-连续空余座位"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/consecutive-available-seats/",target:"_blank",rel:"noopener noreferrer"}},[s._v("603. 连续空余座位"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect distinct a.seat_id\nfrom cinema a join cinema b\n  on abs(a.seat_id - b.seat_id) = 1\n  and a.free = true and b.free = true\norder by a.seat_id\n;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("h4",{attrs:{id:"_1731-每位经理的下属员工数量"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1731-每位经理的下属员工数量"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/the-number-of-employees-which-report-to-each-employee/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1731. 每位经理的下属员工数量"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect \n    e1.employee_id,\n    e1.name,\n    count(*) as reports_count,\n    ROUND(avg(e2.age), 0) as average_age\nfrom employees e1\njoin employees e2\non e2.reports_to = e1.employee_id\ngroup by employee_id\norder by employee_id\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br")])]),e("h4",{attrs:{id:"_1747-应该被禁止的-leetflex-账户"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1747-应该被禁止的-leetflex-账户"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/leetflex-banned-accounts/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1747. 应该被禁止的 Leetflex 账户"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect distinct l1.account_id from loginfo l1\njoin loginfo l2\non \n    l1.account_id = l2.account_id and \n    l1.ip_address != l2.ip_address and \n    ( l1.login >= l2.login and l1.login <= l2.logout )\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("h4",{attrs:{id:"_181-超过经理收入的员工"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_181-超过经理收入的员工"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/employees-earning-more-than-their-managers/",target:"_blank",rel:"noopener noreferrer"}},[s._v("181. 超过经理收入的员工"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n     a.name as employee\nfrom employee as a join employee as b\n     on a.managerid = b.id\n     and a.salary > b.salary\n;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("h3",{attrs:{id:"_8-不等式连接"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_8-不等式连接"}},[s._v("#")]),s._v(" 8.不等式连接")]),s._v(" "),e("h4",{attrs:{id:"_1459-矩形面积"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1459-矩形面积"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/rectangles-area/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1459. 矩形面积"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nSELECT \n    p1.id P1,\n    p2.id P2,\n    ABS(p1.x_value-p2.x_value)*ABS(p1.y_value-p2.y_value) AREA\nFROM points p1,points p2\nWHERE p1.id<p2.id \nAND p1.x_value!=p2.x_value\nAND p1.y_value!=p2.y_value\nORDER BY  AREA desc,p1.id,p2.id\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])]),e("h4",{attrs:{id:"_180-连续出现的数字"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_180-连续出现的数字"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/consecutive-numbers/",target:"_blank",rel:"noopener noreferrer"}},[s._v("180. 连续出现的数字"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("SELECT DISTINCT\n    l1.Num AS ConsecutiveNums\nFROM\n    Logs l1,\n    Logs l2,\n    Logs l3\nWHERE\n    l1.Id = l2.Id - 1\n    AND l2.Id = l3.Id - 1\n    AND l1.Num = l2.Num\n    AND l2.Num = l3.Num\n;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br")])]),e("h4",{attrs:{id:"_1988-找出每所学校的最低分数要求"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1988-找出每所学校的最低分数要求"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/find-cutoff-score-for-each-school/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1988. 找出每所学校的最低分数要求"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nSELECT\n    school_id,\n    IFNULL(min(score), -1) as score\nFROM (\n    SELECT\n        s.school_id,\n        e.score\n    FROM schools s\n    LEFT JOIN exam e ON s.capacity >= e.student_count\n) t\nGROUP BY school_id\nORDER BY school_id;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br")])]),e("h3",{attrs:{id:"_9-子查询"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_9-子查询"}},[s._v("#")]),s._v(" 9.子查询")]),s._v(" "),e("h4",{attrs:{id:"_1549-每件商品的最新订单"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1549-每件商品的最新订单"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/the-most-recent-orders-for-each-product/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1549. 每件商品的最新订单"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select p.product_name, o.product_id, o.order_id, o.order_date from orders o\nleft join products p\non p.product_id = o.product_id\nwhere (o.product_id, order_date) in \n(\n    select product_id, max(order_date) from orders\n    group by product_id\n)\norder by product_name asc, product_id asc, order_id asc\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("h4",{attrs:{id:"_1321-餐馆营业额变化增长"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1321-餐馆营业额变化增长"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/restaurant-growth/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1321. 餐馆营业额变化增长"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select \ndistinct a.visited_on,sum(b.amount) as amount,round(sum(b.amount)/7,2) as average_amount \nfrom Customer a\njoin Customer b\non datediff(a.visited_on,b.visited_on) <= 6 and datediff(a.visited_on,b.visited_on) >= 0\ngroup by a.visited_on,a.customer_id     \nhaving  count(distinct b.visited_on) = 7\norder by visited_on \n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("h4",{attrs:{id:"_1045-买下所有产品的客户"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1045-买下所有产品的客户"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/customers-who-bought-all-products/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1045. 买下所有产品的客户"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select customer_id from customer\ngroup by customer_id\nhaving count(distinct product_key) = (select count(distinct product_key) from product)\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h3",{attrs:{id:"_10-子查询"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_10-子查询"}},[s._v("#")]),s._v(" 10.子查询")]),s._v(" "),e("h4",{attrs:{id:"_1341-电影评分"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1341-电影评分"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/movie-rating/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1341. 电影评分"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select T.results FROM \n(\n    SELECT U.name AS results,MR.user_id\n    FROM Users U,MovieRating MR \n    WHERE U.user_id = MR.user_id\n    GROUP BY MR.user_id,U.name\n    ORDER BY COUNT(1) DESC,U.NAME ASC\n    limit 1\n) T\nunion all\nselect Q.results FROM \n(\n    SELECT M.title AS results\n    FROM Movies M,MovieRating MM \n    WHERE M.movie_id = MM.movie_id \n    AND MM.created_at LIKE '2020-02%'\n    GROUP BY M.title\n    ORDER BY AVG(MM.rating) DESC,M.title ASC\n    limit 1\n) Q\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br")])]),e("h4",{attrs:{id:"_1867-最大数量高于平均水平的订单"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1867-最大数量高于平均水平的订单"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/orders-with-maximum-quantity-above-average/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1867. 最大数量高于平均水平的订单"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    order_id\nfrom (\n    -- 每个订单的最大数量 > max(每个订单的平均数量)\n    select\n        *,\n        max(quantity) > max(avg(quantity)) over() as flag\n    from OrdersDetails\n    group by order_id\n) as base\nwhere flag = 1\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])]),e("h3",{attrs:{id:"_11-子查询"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_11-子查询"}},[s._v("#")]),s._v(" 11.子查询")]),s._v(" "),e("h4",{attrs:{id:"_550-游戏玩法分析-iv"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_550-游戏玩法分析-iv"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/game-play-analysis-iv/",target:"_blank",rel:"noopener noreferrer"}},[s._v("550. 游戏玩法分析 IV"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect round(avg(a.event_date is not null), 2) fraction\nfrom \n    (select player_id, min(event_date) as login\n    from activity\n    group by player_id) p \nleft join activity a \non p.player_id=a.player_id and datediff(a.event_date, p.login)=1\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h4",{attrs:{id:"_262-行程和用户"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_262-行程和用户"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/trips-and-users/",target:"_blank",rel:"noopener noreferrer"}},[s._v("262. 行程和用户"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select request_at 'Day',\nround(count(if(status!='completed',status,null))/count(*),2) 'Cancellation Rate'\nfrom Trips\nwhere request_at between '2013-10-01' and '2013-10-03'\nand client_id not in (select users_id from Users where banned='Yes') \nand driver_id not in (select users_id from Users where banned='Yes')\ngroup by request_at;\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])])])}),[],!1,null,null,null);e.default=t.exports}}]);