(window.webpackJsonp=window.webpackJsonp||[]).push([[44],{330:function(s,e,a){"use strict";a.r(e);var n=a(14),t=Object(n.a)({},(function(){var s=this,e=s._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"mysql5-7刷题"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mysql5-7刷题"}},[s._v("#")]),s._v(" Mysql5.7刷题")]),s._v(" "),e("h2",{attrs:{id:"目录"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#目录"}},[s._v("#")]),s._v(" 目录")]),s._v(" "),e("p"),e("div",{staticClass:"table-of-contents"},[e("ul",[e("li",[e("a",{attrs:{href:"#目录"}},[s._v("目录")])]),e("li",[e("a",{attrs:{href:"#力扣mysql题解"}},[s._v("力扣MySQL题解")])]),e("li",[e("a",{attrs:{href:"#力扣-sql入门"}},[s._v("力扣-SQL入门")]),e("ul",[e("li",[e("a",{attrs:{href:"#_1-选择"}},[s._v("1.选择")])]),e("li",[e("a",{attrs:{href:"#_2-排序-修改"}},[s._v("2.排序 & 修改")])]),e("li",[e("a",{attrs:{href:"#_3-字符串处理函数-正则"}},[s._v("3.字符串处理函数/正则")])]),e("li",[e("a",{attrs:{href:"#_4-组合查询-指定选取"}},[s._v("4.组合查询&指定选取")])]),e("li",[e("a",{attrs:{href:"#_5-合并"}},[s._v("5.合并")])]),e("li",[e("a",{attrs:{href:"#_6-合并"}},[s._v("6.合并")])]),e("li",[e("a",{attrs:{href:"#_7-计算函数"}},[s._v("7.计算函数")])]),e("li",[e("a",{attrs:{href:"#_8-计算函数"}},[s._v("8.计算函数")])]),e("li",[e("a",{attrs:{href:"#_9-控制流"}},[s._v("9.控制流")])]),e("li",[e("a",{attrs:{href:"#_10-过滤"}},[s._v("10.过滤")])])])]),e("li",[e("a",{attrs:{href:"#力扣-sql-基础plus会员-11天"}},[s._v("力扣-SQL 基础plus会员-11天")]),e("ul",[e("li",[e("a",{attrs:{href:"#_1-数值处理函数"}},[s._v("1.数值处理函数")])]),e("li",[e("a",{attrs:{href:"#_2-数值处理函数"}},[s._v("2.数值处理函数")])]),e("li",[e("a",{attrs:{href:"#_3-连接"}},[s._v("3.连接")])]),e("li",[e("a",{attrs:{href:"#_4-连接"}},[s._v("4.连接")])]),e("li",[e("a",{attrs:{href:"#_5-连接"}},[s._v("5.连接")])]),e("li",[e("a",{attrs:{href:"#_6-连接"}},[s._v("6.连接")])]),e("li",[e("a",{attrs:{href:"#_7-连接"}},[s._v("7.连接")])]),e("li",[e("a",{attrs:{href:"#_8-不等式连接"}},[s._v("8.不等式连接")])]),e("li",[e("a",{attrs:{href:"#_9-子查询"}},[s._v("9.子查询")])]),e("li",[e("a",{attrs:{href:"#_10-子查询"}},[s._v("10.子查询")])]),e("li",[e("a",{attrs:{href:"#_11-子查询"}},[s._v("11.子查询")])])])]),e("li",[e("a",{attrs:{href:"#免费题"}},[s._v("免费题")])]),e("li",[e("a",{attrs:{href:"#mid中等"}},[s._v("mid中等")]),e("ul",[e("li",[e("a",{attrs:{href:"#_1070-产品销售分析-iii-https-leetcode-cn-problems-product-sales-analysis-iii-「学习」"}},[s._v("1070. 产品销售分析 III「学习」")])]),e("li",[e("a",{attrs:{href:"#_178-分数排名-https-leetcode-cn-problems-rank-scores-「学习」"}},[s._v("178. 分数排名「学习」")])]),e("li",[e("a",{attrs:{href:"#_1907-按分类统计薪水-https-leetcode-cn-problems-count-salary-categories-「写法-」"}},[s._v("1907. 按分类统计薪水「写法！」")])]),e("li",[e("a",{attrs:{href:"#_1204-最后一个能进入电梯的人-https-leetcode-cn-problems-last-person-to-fit-in-the-bus"}},[s._v("1204. 最后一个能进入电梯的人")])]),e("li",[e("a",{attrs:{href:"#_585-2016年的投资-https-leetcode-cn-problems-investments-in-2016-⭐️学习"}},[s._v("585. 2016年的投资⭐️学习！！")])]),e("li",[e("a",{attrs:{href:"#_602-好友申请-ii-谁有最多的好友-https-leetcode-cn-problems-friend-requests-ii-who-has-the-most-friends-「学习union-all的特殊技巧」"}},[s._v("602. 好友申请 II ：谁有最多的好友「学习union all的特殊技巧」")])])])]),e("li",[e("a",{attrs:{href:"#easy简单"}},[s._v("easy简单")]),e("ul",[e("li",[e("a",{attrs:{href:"#_1978-上级经理已离职的公司员工-https-leetcode-cn-problems-employees-whose-manager-left-the-company"}},[s._v("1978. 上级经理已离职的公司员工")])]),e("li",[e("a",{attrs:{href:"#_577-员工奖金-https-leetcode-cn-problems-employee-bonus-「典型left-join」"}},[s._v("577. 员工奖金「典型left join」")])]),e("li",[e("a",{attrs:{href:"#_620-有趣的电影-https-leetcode-cn-problems-not-boring-movies"}},[s._v("620. 有趣的电影")])]),e("li",[e("a",{attrs:{href:"#_1075-项目员工-i-https-leetcode-cn-problems-project-employees-i"}},[s._v("1075. 项目员工 I")])]),e("li",[e("a",{attrs:{href:"#_1683-无效的推文-https-leetcode-cn-problems-invalid-tweets-length函数"}},[s._v("1683. 无效的推文-length函数")])]),e("li",[e("a",{attrs:{href:"#_1378-使用唯一标识码替换员工id-https-leetcode-cn-problems-replace-employee-id-with-the-unique-identifier"}},[s._v("1378. 使用唯一标识码替换员工ID")])]),e("li",[e("a",{attrs:{href:"#_2356-每位教师所教授的科目种类的数量-https-leetcode-cn-problems-number-of-unique-subjects-taught-by-each-teacher"}},[s._v("2356. 每位教师所教授的科目种类的数量")])]),e("li",[e("a",{attrs:{href:"#_610-判断三角形-https-leetcode-cn-problems-triangle-judgement-分支判断-case-end⭐️"}},[s._v("610. 判断三角形-分支判断-case end⭐️")])]),e("li",[e("a",{attrs:{href:"#_1517-查找拥有有效邮箱的用户-https-leetcode-cn-problems-find-users-with-valid-e-mails-正则表达式⭐️⭐️⭐️"}},[s._v("1517. 查找拥有有效邮箱的用户-正则表达式⭐️⭐️⭐️")])]),e("li",[e("a",{attrs:{href:"#_1068-产品销售分析-i-https-leetcode-cn-problems-product-sales-analysis-i-写法"}},[s._v("1068. 产品销售分析 I-写法")])]),e("li",[e("a",{attrs:{href:"#_1789-员工的直属部门-https-leetcode-cn-problems-primary-department-for-each-employee-难点⭐️"}},[s._v("1789. 员工的直属部门-难点⭐️")])]),e("li",[e("a",{attrs:{href:"#_1661-每台机器的进程平均运行时间-https-leetcode-cn-problems-average-time-of-process-per-machine-难点-复杂逻辑-⭐️"}},[s._v("1661. 每台机器的进程平均运行时间-难点-复杂逻辑-⭐️")])]),e("li",[e("a",{attrs:{href:"#_1327-列出指定时间段内所有的下单产品-https-leetcode-cn-problems-list-the-products-ordered-in-a-period"}},[s._v("1327. 列出指定时间段内所有的下单产品-")])])])]),e("li",[e("a",{attrs:{href:"#_4-mysql必知必会-牛客"}},[s._v("4.MySQL必知必会-牛客")])]),e("li",[e("a",{attrs:{href:"#《sql必知必会》配套题单-题解"}},[s._v("《SQL必知必会》配套题单-题解")]),e("ul",[e("li",[e("a",{attrs:{href:"#_1-检索数据"}},[s._v("1.检索数据")])]),e("li",[e("a",{attrs:{href:"#_2-排序检索数据「order-by」"}},[s._v("2.排序检索数据「order by」")])]),e("li",[e("a",{attrs:{href:"#_3-过滤数据「过滤规则where」"}},[s._v("3.过滤数据「过滤规则where」")])]),e("li",[e("a",{attrs:{href:"#_4-高级数据过滤"}},[s._v("4.高级数据过滤")])]),e("li",[e("a",{attrs:{href:"#_5-用通配符进行过滤「正则表达式」"}},[s._v("5.用通配符进行过滤「正则表达式」")])]),e("li",[e("a",{attrs:{href:"#_6-「别名」"}},[s._v("6.「别名」")])]),e("li",[e("a",{attrs:{href:"#_7-使用函数处理数据「函数」"}},[s._v("7.使用函数处理数据「函数」")])]),e("li",[e("a",{attrs:{href:"#_8-汇总数据「统计」"}},[s._v("8.汇总数据「统计」")])]),e("li",[e("a",{attrs:{href:"#_9-分组数据"}},[s._v("9.分组数据")])]),e("li",[e("a",{attrs:{href:"#_10-使用「子查询」"}},[s._v("10.使用「子查询」")])]),e("li",[e("a",{attrs:{href:"#_11-⭐️联结表"}},[s._v("11.⭐️联结表")])]),e("li",[e("a",{attrs:{href:"#_12-⭐️创建高级联结"}},[s._v("12.⭐️创建高级联结")])]),e("li",[e("a",{attrs:{href:"#_13-组合查询「union」"}},[s._v("13.组合查询「union」")])])])]),e("li",[e("a",{attrs:{href:"#⭐️总结记忆⭐️"}},[s._v("⭐️总结记忆⭐️")])]),e("li",[e("a",{attrs:{href:"#sql大厂面试真题"}},[s._v("SQL大厂面试真题")]),e("ul",[e("li",[e("a",{attrs:{href:"#_1-某音短视频"}},[s._v("1.某音短视频")])]),e("li",[e("a",{attrs:{href:"#_2-用户增长场景-某度信息流"}},[s._v("2.用户增长场景（某度信息流）")])]),e("li",[e("a",{attrs:{href:"#_3-电商场景-某东商城"}},[s._v("3.电商场景（某东商城）")])]),e("li",[e("a",{attrs:{href:"#_4-出行场景-某滴打车"}},[s._v("4.出行场景（某滴打车）")])]),e("li",[e("a",{attrs:{href:"#_5-某宝店铺分析-电商模式"}},[s._v("5.某宝店铺分析（电商模式）")])]),e("li",[e("a",{attrs:{href:"#_6-牛客直播课分析-在线教育行业"}},[s._v("6.牛客直播课分析（在线教育行业）")])]),e("li",[e("a",{attrs:{href:"#_7-某乎问答-内容行业"}},[s._v("7.某乎问答（内容行业）")])])])]),e("li",[e("a",{attrs:{href:"#面试"}},[s._v("面试")])]),e("li",[e("a",{attrs:{href:"#参考资料"}},[s._v("参考资料")])])])]),e("p"),s._v(" "),e("h2",{attrs:{id:"力扣mysql题解"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#力扣mysql题解"}},[s._v("#")]),s._v(" 力扣MySQL题解")]),s._v(" "),e("h2",{attrs:{id:"力扣-sql入门"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#力扣-sql入门"}},[s._v("#")]),s._v(" 力扣-SQL入门")]),s._v(" "),e("h3",{attrs:{id:"_1-选择"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-选择"}},[s._v("#")]),s._v(" 1.选择")]),s._v(" "),e("h4",{attrs:{id:"_595-大的国家"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_595-大的国家"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/big-countries/",target:"_blank",rel:"noopener noreferrer"}},[s._v("595. 大的国家"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect name , population, area\nfrom World\nwhere area>=3000000 or population>=25000000\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h4",{attrs:{id:"_1757-可回收且低脂的产品"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1757-可回收且低脂的产品"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/recyclable-and-low-fat-products/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1757. 可回收且低脂的产品"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect product_id \nfrom Products\nwhere 'Y'=recyclable and 'Y'=low_fats\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h4",{attrs:{id:"_584-寻找用户推荐人"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_584-寻找用户推荐人"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/find-customer-referee/",target:"_blank",rel:"noopener noreferrer"}},[s._v("584. 寻找用户推荐人"),e("OutboundLink")],1)]),s._v(" "),e("ul",[e("li",[s._v("易错，本题，必须判断"),e("code",[s._v("referee_id is null")])])]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect name \nfrom customer\nwhere ( not referee_id=2 ) or  referee_id is null\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h4",{attrs:{id:"_183-从不订购的客户⭐️"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_183-从不订购的客户⭐️"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/customers-who-never-order/",target:"_blank",rel:"noopener noreferrer"}},[s._v("183. 从不订购的客户"),e("OutboundLink")],1),s._v("⭐️")]),s._v(" "),e("ul",[e("li",[s._v("not in的使用")])]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect name as Customers\nfrom Customers\nwhere Id not in\n( \n    select CustomerId\n    from Orders\n)\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("ul",[e("li",[s._v("更加明确的写法如下⭐️⭐️")])]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select Customers.name as Customers\nfrom Customers\nwhere Customers.id not in\n(\n    select Customerid from Orders\n)\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("h3",{attrs:{id:"_2-排序-修改"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-排序-修改"}},[s._v("#")]),s._v(" 2.排序 & 修改")]),s._v(" "),e("h4",{attrs:{id:"_1873-计算特殊奖金⭐️"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1873-计算特殊奖金⭐️"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/calculate-special-bonus/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1873. 计算特殊奖金"),e("OutboundLink")],1),s._v("⭐️")]),s._v(" "),e("ul",[e("li",[s._v("学习case end的使用")])]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect employee_id , \ncase\n  when ( left(name,1)!='M' and employee_id % 2=1 ) then salary\n  else 0\nend \nas bonus\nfrom Employees\norder by employee_id\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h4",{attrs:{id:"_627-变更性别⭐️"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_627-变更性别⭐️"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/swap-salary/",target:"_blank",rel:"noopener noreferrer"}},[s._v("627. 变更性别"),e("OutboundLink")],1),s._v("⭐️")]),s._v(" "),e("ul",[e("li",[s._v("if语句")])]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nupdate Salary\nset sex=\n    if( 'f'=sex ,\n    'm','f')\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("ul",[e("li",[s._v("case解法")])]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nupdate Salary\nset sex=\n    case sex\n        when 'f' then 'm'\n        when 'm' then 'f'\n    end\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("h4",{attrs:{id:"_196-删除重复的电子邮箱⭐️"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_196-删除重复的电子邮箱⭐️"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/delete-duplicate-emails/",target:"_blank",rel:"noopener noreferrer"}},[s._v("196. 删除重复的电子邮箱"),e("OutboundLink")],1),s._v("⭐️")]),s._v(" "),e("ul",[e("li",[s._v("自连接！学习⭐️⭐️")])]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Please write a DELETE statement and DO NOT write a SELECT statement.\n# Write your MySQL query statement below\ndelete p1 \n\tfrom Person p1 ,Person p2\nwhere p1.Email =p2.Email and p1.Id > p2.Id\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h3",{attrs:{id:"_3-字符串处理函数-正则"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-字符串处理函数-正则"}},[s._v("#")]),s._v(" 3.字符串处理函数/正则")]),s._v(" "),e("h4",{attrs:{id:"_1667-修复表中的名字"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1667-修复表中的名字"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/fix-names-in-a-table/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1667. 修复表中的名字"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nSELECT user_id, \n    CONCAT(UPPER(SUBSTRING(name, 1, 1)),\n         LOWER(SUBSTRING(name, 2, (SELECT LENGTH(name))))) name\nFROM Users\nORDER BY user_id\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("h4",{attrs:{id:"_1484-按日期分组销售产品"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1484-按日期分组销售产品"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/group-sold-products-by-the-date/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1484. 按日期分组销售产品"),e("OutboundLink")],1)]),s._v(" "),e("ul",[e("li",[s._v("记忆，不会的"),e("code",[s._v("GROUP_CONCAT（）")]),s._v("函数")])]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select \n    sell_date, \n    # 获取“不同的”产品数【count(distinct product)】\n    count(distinct product) as num_sold, \n    # “不同的”【distinct product】产品按照字典排序【order by product】  & “,”分割【separator ','】\n    group_concat(distinct product order by product separator ',') as products\nfrom Activities\ngroup by sell_date\norder by sell_date;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h4",{attrs:{id:"_1527-患某种疾病的患者"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1527-患某种疾病的患者"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/patients-with-a-condition/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1527. 患某种疾病的患者"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect patient_id,patient_name, conditions\nfrom Patients\nwhere conditions like '% DIAB1%'\n    or conditions like'DIAB1%'\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h3",{attrs:{id:"_4-组合查询-指定选取"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-组合查询-指定选取"}},[s._v("#")]),s._v(" 4.组合查询&指定选取")]),s._v(" "),e("h4",{attrs:{id:"_1965-丢失信息的雇员"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1965-丢失信息的雇员"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/employees-with-missing-information/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1965. 丢失信息的雇员"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect employee_id from (\n    select e.employee_id employee_id from Employees e left join Salaries s on e.employee_id=s.employee_id where salary is null\n    union all\n    select s.employee_id employee_id from Employees e right join Salaries s on e.employee_id=s.employee_id where name is null\n) x order by employee_id;\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("h4",{attrs:{id:"_1795-每个产品在不同商店的价格"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1795-每个产品在不同商店的价格"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/rearrange-products-table/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1795. 每个产品在不同商店的价格"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect product_id, 'store1' store, store1 price from products where store1 is not NULL\nUNION\nselect product_id, 'store2' store, store2 price from products where store2 is not NULL\nUNION\nselect product_id, 'store3' store, store3 price from products where store3 is not NULL\n\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("h4",{attrs:{id:"_608-树节点"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_608-树节点"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/tree-node/",target:"_blank",rel:"noopener noreferrer"}},[s._v("608. 树节点"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\n# Write your MySQL query statement below\nselect id,(\n    case WHEN p_id is null THEN 'Root'\n        WHEN id in(select p_id from tree) THEN 'Inner'\n        else 'Leaf' END)\n    as type from tree \norder by id\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("h4",{attrs:{id:"_176-第二高的薪水"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_176-第二高的薪水"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/second-highest-salary/",target:"_blank",rel:"noopener noreferrer"}},[s._v("176. 第二高的薪水"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nSELECT\n    (SELECT DISTINCT\n            Salary\n        FROM\n            Employee\n        ORDER BY Salary DESC\n        LIMIT 1 OFFSET 1) AS SecondHighestSalary\n;\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("h3",{attrs:{id:"_5-合并"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-合并"}},[s._v("#")]),s._v(" 5.合并")]),s._v(" "),e("p",[s._v("多表的联结又分为以下几种类型：")]),s._v(" "),e("p",[s._v("1）左联结（left join），联结结果保留左表的全部数据")]),s._v(" "),e("p",[s._v("2）右联结（right join），联结结果保留右表的全部数据")]),s._v(" "),e("p",[s._v("3）内联结（inner join），取两表的公共数据")]),s._v(" "),e("h4",{attrs:{id:"_175-组合两个表"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_175-组合两个表"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/combine-two-tables/",target:"_blank",rel:"noopener noreferrer"}},[s._v("175. 组合两个表"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect FirstName, LastName, City, State\nfrom Person left join Address\non Person.PersonId = Address.PersonId\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h4",{attrs:{id:"_1581-进店却未进行过交易的顾客"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1581-进店却未进行过交易的顾客"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/customer-who-visited-but-did-not-make-any-transactions/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1581. 进店却未进行过交易的顾客"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect a.customer_id, count(1) count_no_trans \n    from Visits a\n    where a.visit_id not in (select b.visit_id from Transactions b)\n    group by a.customer_id\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("h4",{attrs:{id:"_1148-文章浏览-i"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1148-文章浏览-i"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/article-views-i/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1148. 文章浏览 I"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect distinct author_id as id\nfrom  Views\nwhere author_id = viewer_id\norder by author_id\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("h3",{attrs:{id:"_6-合并"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-合并"}},[s._v("#")]),s._v(" 6.合并")]),s._v(" "),e("h4",{attrs:{id:"_197-上升的温度"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_197-上升的温度"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/rising-temperature/",target:"_blank",rel:"noopener noreferrer"}},[s._v("197. 上升的温度"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nSELECT b.Id\nFROM Weather as a,Weather as b\nWHERE a.Temperature < b.Temperature and DATEDIFF(a.RecordDate,b.RecordDate) = -1;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h4",{attrs:{id:"_607-销售员"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_607-销售员"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/sales-person/",target:"_blank",rel:"noopener noreferrer"}},[s._v("607. 销售员"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('select distinct name from SalesPerson where sales_id not in (\n    select distinct sales_id from Orders where com_id=(\n        select com_id from Company where name="RED"\n    )\n);\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h3",{attrs:{id:"_7-计算函数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_7-计算函数"}},[s._v("#")]),s._v(" 7.计算函数")]),s._v(" "),e("h4",{attrs:{id:"_1141-查询近30天活跃用户数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1141-查询近30天活跃用户数"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/user-activity-for-the-past-30-days-i/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1141. 查询近30天活跃用户数"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\n# Write your MySQL query statement below\nselect activity_date as day,count(distinct user_id) as active_users\nfrom\n    Activity\nwhere\n    activity_date between '2019-06-28' and '2019-07-27'\ngroup by\n    activity_date;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h4",{attrs:{id:"_1693-每天的领导和合伙人"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1693-每天的领导和合伙人"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/daily-leads-and-partners/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1693. 每天的领导和合伙人"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect date_id , make_name ,count(distinct lead_id) unique_leads , count(distinct partner_id) unique_partners\nfrom dailysales\ngroup by date_id,make_name;\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h4",{attrs:{id:"_1729-求关注者的数量"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1729-求关注者的数量"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/find-followers-count/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1729. 求关注者的数量"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect user_id, count(1) followers_count \nfrom Followers \ngroup by user_id \norder by user_id;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h3",{attrs:{id:"_8-计算函数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_8-计算函数"}},[s._v("#")]),s._v(" 8.计算函数")]),s._v(" "),e("h4",{attrs:{id:"_511-游戏玩法分析-i"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_511-游戏玩法分析-i"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/game-play-analysis-i/",target:"_blank",rel:"noopener noreferrer"}},[s._v("511. 游戏玩法分析 I"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect player_id,min(event_date) as 'first_login'\nfrom Activity\ngroup by player_id\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h4",{attrs:{id:"_586-订单最多的客户"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_586-订单最多的客户"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/customer-placing-the-largest-number-of-orders/",target:"_blank",rel:"noopener noreferrer"}},[s._v("586. 订单最多的客户"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("SELECT\n    customer_number\nFROM\n    orders\nGROUP BY customer_number\nORDER BY COUNT(*) DESC\nLIMIT 1\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("h4",{attrs:{id:"_1890-2020年最后一次登录"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1890-2020年最后一次登录"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/the-latest-login-in-2020/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1890. 2020年最后一次登录"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\n# Write your MySQL query statement below\nselect\n    user_id,max(time_stamp) as last_stamp \nfrom\n    Logins\nwhere\n    time_stamp between '2020-01-01' and '2021-01-01'\ngroup by \n    user_id\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])]),e("h4",{attrs:{id:"_1741-查找每个员工花费的总时间"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1741-查找每个员工花费的总时间"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/find-total-time-spent-by-each-employee/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1741. 查找每个员工花费的总时间"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("SELECT\n    event_day day, emp_id, SUM(out_time - in_time) total_time\nFROM\n    Employees\nGROUP BY\n    event_day, emp_id;\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("h3",{attrs:{id:"_9-控制流"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_9-控制流"}},[s._v("#")]),s._v(" 9.控制流")]),s._v(" "),e("h4",{attrs:{id:"_1393-股票的资本损益"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1393-股票的资本损益"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/capital-gainloss/?envType=study-plan&id=sql-beginner&plan=sql&plan_progress=4o17k31",target:"_blank",rel:"noopener noreferrer"}},[s._v("1393. 股票的资本损益"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\n# Write your MySQL query statement below\n# 方法一 case when\n# select stock_name, sum(\n#     case when operation = 'buy' then -price\n#     else price end\n# ) as capital_gain_loss \n# from stocks \n# group by stock_name;\n\n# 方法二 if语句\nselect stock_name, sum(\n    if(operation = 'buy', -price, price)\n) as capital_gain_loss \nfrom stocks \ngroup by stock_name;\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br")])]),e("h4",{attrs:{id:"_1407-排名靠前的旅行者"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1407-排名靠前的旅行者"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/top-travellers/?envType=study-plan&id=sql-beginner&plan=sql&plan_progress=4o17k31",target:"_blank",rel:"noopener noreferrer"}},[s._v("1407. 排名靠前的旅行者"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\n# Write your MySQL query statement below\n# 1.先查出每个有行程的用户的距离 用到group by 和sum\n# 2.由于没有行程的用户也需要查找所以需用到left join(主表数据不受影响),\n#   再通过IFNULL()函数对行程为null的用户赋值为0,最后对其order by排序就行了\nselect name, ifnull (travelled_distance,0) as travelled_distance\nfrom Users\n\nleft join\n(\n    select\n    user_id,sum(distance) as travelled_distance \n    from Rides \n        group by user_id\n)t1\non t1.user_id= Users.id\norder by travelled_distance desc, name asc\n\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br")])]),e("h4",{attrs:{id:"_1158-市场分析-i"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1158-市场分析-i"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/market-analysis-i/?envType=study-plan&id=sql-beginner&plan=sql&plan_progress=4o17k31",target:"_blank",rel:"noopener noreferrer"}},[s._v("1158. 市场分析 I"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect Users.user_id as buyer_id, \n    join_date, \n    ifnull(UserBuy.cnt, 0) as orders_in_2019\nfrom Users\nleft join (\n    select buyer_id, count(order_id) cnt \n    from Orders\n    where order_date between '2019-01-01' and '2019-12-31'\n    group by buyer_id\n) UserBuy\non Users.user_id = UserBuy.buyer_id\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br")])]),e("h3",{attrs:{id:"_10-过滤"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_10-过滤"}},[s._v("#")]),s._v(" 10.过滤")]),s._v(" "),e("h4",{attrs:{id:"_182-查找重复的电子邮箱"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_182-查找重复的电子邮箱"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/duplicate-emails/?envType=study-plan&id=sql-beginner&plan=sql&plan_progress=4o17k31",target:"_blank",rel:"noopener noreferrer"}},[s._v("182. 查找重复的电子邮箱"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect Email\nfrom Person\ngroup by Email\nhaving count(Email) > 1\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h4",{attrs:{id:"_1050-合作过至少三次的演员和导演"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1050-合作过至少三次的演员和导演"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/actors-and-directors-who-cooperated-at-least-three-times/?envType=study-plan&id=sql-beginner&plan=sql&plan_progress=4o17k31",target:"_blank",rel:"noopener noreferrer"}},[s._v("1050. 合作过至少三次的演员和导演"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect actor_id , director_id\nfrom ActorDirector\ngroup by actor_id , director_id\nhaving count(timestamp) >= 3\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h4",{attrs:{id:"_1587-银行账户概要-ii"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1587-银行账户概要-ii"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/bank-account-summary-ii/?envType=study-plan&id=sql-beginner&plan=sql&plan_progress=4o17k31",target:"_blank",rel:"noopener noreferrer"}},[s._v("1587. 银行账户概要 II"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect    name, SUM(amount) balance\nfrom\n    Users u \njoin\n    Transactions t \non\n    u.account = T.account\ngroup by\n    u.account\nhaving\n    sum(amount) > 10000;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br")])]),e("h4",{attrs:{id:"_1084-销售分析iii"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1084-销售分析iii"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/sales-analysis-iii/?envType=study-plan&id=sql-beginner&plan=sql&plan_progress=4o17k31",target:"_blank",rel:"noopener noreferrer"}},[s._v("1084. 销售分析III"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select product_id, product_name\nfrom product\nwhere product_id in (\n    select\n        product_id\n    from sales\n    group by product_id\n    having max(sale_date) <= '2019-03-31' and min(sale_date) >= '2019-01-01'\n)\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h2",{attrs:{id:"力扣-sql-基础plus会员-11天"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#力扣-sql-基础plus会员-11天"}},[s._v("#")]),s._v(" 力扣-SQL 基础plus会员-11天")]),s._v(" "),e("h3",{attrs:{id:"_1-数值处理函数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-数值处理函数"}},[s._v("#")]),s._v(" 1.数值处理函数")]),s._v(" "),e("h4",{attrs:{id:"_1699-两人之间的通话次数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1699-两人之间的通话次数"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/number-of-calls-between-two-persons/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1699. 两人之间的通话次数"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\n# Write your MySQL query statement below\nSELECT \n    person1,person2, \n    count(*) call_count, \n    sum(duration) total_duration \nFROM (\nSELECT \n    IF(from_id>to_id, to_id, from_id) person1, \n    IF(from_id>to_id,from_id,to_id) person2, \n    duration  \nFROM calls \n) c \nGROUP BY \n    person1, person2\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br")])]),e("h4",{attrs:{id:"_1251-平均售价"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1251-平均售价"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/average-selling-price/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1251. 平均售价"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("SELECT u.product_id product_id,\n        ROUND(SUM(u.units*p.price)/SUM(u.units),2) average_price        \nFROM UnitsSold u ,Prices p\nWHERE u.product_id=p.product_id \n        AND u.purchase_date BETWEEN p.start_date AND p.end_date\nGROUP BY u.product_id\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("h4",{attrs:{id:"_1571-仓库经理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1571-仓库经理"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/warehouse-manager/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1571. 仓库经理"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nSELECT \n    w.name WAREHOUSE_NAME,\n    SUM(p.Width * p.Length * p.Height * w.units) VOLUME\nFROM \n    warehouse w\nLEFT JOIN \n    products p\nON \n    w.product_id = p.product_id\nGROUP BY w.name;\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br")])]),e("h4",{attrs:{id:"_1445-苹果和桔子"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1445-苹果和桔子"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/apples-oranges/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1445. 苹果和桔子"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select    sale_date,\n    sum(\n        if(fruit = 'apples', sold_num, -sold_num)\n    ) as diff\n    from sales\ngroup by sale_date\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("h3",{attrs:{id:"_2-数值处理函数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-数值处理函数"}},[s._v("#")]),s._v(" 2.数值处理函数")]),s._v(" "),e("h4",{attrs:{id:"_1193-每月交易-i"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1193-每月交易-i"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/monthly-transactions-i/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1193. 每月交易 I"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select date_format(trans_date,'%Y-%m') as month,\n        country, count(*) as trans_count, \n        sum(case state when 'approved' then 1 else 0 end) as approved_count,\n        sum(amount) as trans_total_amount,\n        sum(case state when 'approved' then amount else 0 end) as approved_total_amount\nfrom Transactions\ngroup by month,country;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("h4",{attrs:{id:"_1633-各赛事的用户注册率"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1633-各赛事的用户注册率"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/percentage-of-users-attended-a-contest/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1633. 各赛事的用户注册率"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\n\nselect contest_id,\n       round(count(user_id) / (select count(1) from Users) * 100, 2) as percentage\n       from Register\n       group by contest_id\n       order by percentage desc , contest_id\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("h4",{attrs:{id:"_1173-即时食物配送-i"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1173-即时食物配送-i"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/immediate-food-delivery-i/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1173. 即时食物配送 I"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect round (\n    sum(order_date = customer_pref_delivery_date) /\n    count(*) * 100,\n    2\n) as immediate_percentage\nfrom Delivery\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("h4",{attrs:{id:"_1211-查询结果的质量和占比"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1211-查询结果的质量和占比"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/queries-quality-and-percentage/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1211. 查询结果的质量和占比"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect \nquery_name, \n        round(avg(rating/position), 2) quality,\n        round(sum(if(rating < 3, 1, 0)) * 100 / count(*), 2) poor_query_percentage\n        from queries\n        group by query_name\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("h3",{attrs:{id:"_3-连接"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-连接"}},[s._v("#")]),s._v(" 3.连接")]),s._v(" "),e("h4",{attrs:{id:"_1607-没有卖出的卖家"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1607-没有卖出的卖家"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/sellers-with-no-sales/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1607. 没有卖出的卖家"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("/* write your pl/sql query statement below */\nselect s.seller_name from seller s where s.seller_id not in (\n    select o.seller_id from orders o where o.sale_date like '2020%'\n) order by seller_name \n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h4",{attrs:{id:"_619-只出现一次的最大数字"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_619-只出现一次的最大数字"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/biggest-single-number/",target:"_blank",rel:"noopener noreferrer"}},[s._v("619. 只出现一次的最大数字"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select \n(\n    select ifnull(num, null) as num from mynumbers \n    group by num\n    having count(*) = 1\n    order by num desc\n    limit 0, 1\n) num\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h4",{attrs:{id:"_1112-每位学生的最高成绩"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1112-每位学生的最高成绩"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/highest-grade-for-each-student/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1112. 每位学生的最高成绩"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("SELECT student_id, min(course_id) AS course_id, grade\nFROM enrollments\nWHERE (student_id, grade) IN\n(\n    SELECT student_id, MAX(grade) AS grade\n    FROM Enrollments\n    GROUP BY student_id\n)\nGROUP BY student_id, grade\nORDER BY student_id\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])]),e("h4",{attrs:{id:"_1398-购买了产品-a-和产品-b-却没有购买产品-c-的顾客"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1398-购买了产品-a-和产品-b-却没有购买产品-c-的顾客"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/customers-who-bought-products-a-and-b-but-not-c/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1398. 购买了产品 A 和产品 B 却没有购买产品 C 的顾客"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select o.customer_id, c.customer_name from orders o\nleft join customers c\non o.customer_id = c.customer_id\ngroup by customer_id\nhaving \n    SUM(if(product_name = 'A', 1, 0)) > 0 and\n    SUM(if(product_name = 'B', 1, 0)) > 0 and\n    SUM(if(product_name = 'C', 1, 0)) = 0\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("h3",{attrs:{id:"_4-连接"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-连接"}},[s._v("#")]),s._v(" 4.连接")]),s._v(" "),e("h4",{attrs:{id:"_1440-计算布尔表达式的值"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1440-计算布尔表达式的值"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/evaluate-boolean-expression/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1440. 计算布尔表达式的值"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select e.left_operand,e.operator,e.right_operand,\ncase e.operator\n    when '>' then if(v1.value>v2.value,'true','false')\n    when '<' then if(v1.value<v2.value,'true','false')\n    else  if(v1.value=v2.value,'true','false')\nend value\n    \nfrom Expressions e\nleft join Variables v1 on v1.name = e.left_operand \nleft join Variables v2 on v2.name = e.right_operand\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])]),e("h4",{attrs:{id:"_1264-页面推荐"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1264-页面推荐"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/page-recommendations/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1264. 页面推荐"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select distinct page_id as recommended_page\nfrom likes\nwhere user_id in (\n                select user1_id as user_id from friendship where user2_id = 1\n                union all\n                select user2_id as user_id from friendship where user1_id = 1\n                ) and page_id not in (\n                        select page_id from likes where user_id = 1\n                        )\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h4",{attrs:{id:"_570-至少有5名直接下属的经理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_570-至少有5名直接下属的经理"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/managers-with-at-least-5-direct-reports/",target:"_blank",rel:"noopener noreferrer"}},[s._v("570. 至少有5名直接下属的经理"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\nname\nfrom\nemployee as t1 join\n(select\n managerid\n from\n employee\n group by managerid\n having count(managerid) >= 5) as t2\non t1.id = t2.managerid\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br")])]),e("h4",{attrs:{id:"_1303-求团队人数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1303-求团队人数"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/find-the-team-size/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1303. 求团队人数"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# write your mysql query statement below\nselect e.employee_id,t1.team_size from employee e inner join \n(\n    select team_id, \n    count(team_id) as team_size from employee group by team_id\n) t1\non t1.team_id = e.team_id\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("h3",{attrs:{id:"_5-连接"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-连接"}},[s._v("#")]),s._v(" 5.连接")]),s._v(" "),e("h4",{attrs:{id:"_1280-学生们参加各科测试的次数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1280-学生们参加各科测试的次数"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/students-and-examinations/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1280. 学生们参加各科测试的次数"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# 自连接\nwith cte1 as\n(\n    select *\n    from students,subjects\n)\n\n\nselect \n    a.student_id,\n    a.student_name,\n    a.subject_name,\n    ifnull(count(b.subject_name),0) as attended_exams \nfrom cte1 a\nleft join Examinations b\nusing(student_id,subject_name)\ngroup by 1,2,3\norder by 1,2,3\n\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br")])]),e("h4",{attrs:{id:"_1501-可以放心投资的国家"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1501-可以放心投资的国家"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/countries-you-can-safely-invest-in/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1501. 可以放心投资的国家"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# write your mysql query statement below\nselect c.name as country\n\tfrom calls, person, country c\nwhere (caller_id = id or callee_id = id) and country_code = left(phone_number, 3)\n\tgroup by country_code\n\thaving avg(duration) > (select avg(duration) from calls);\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("h4",{attrs:{id:"_184-部门工资最高的员工"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_184-部门工资最高的员工"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/department-highest-salary/",target:"_blank",rel:"noopener noreferrer"}},[s._v("184. 部门工资最高的员工"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    department.name as 'department',\n    employee.name as 'employee',\n    salary\nfrom\n    employee\n        join\n    department on employee.departmentid = department.id\nwhere\n    (employee.departmentid , salary) in\n    (   select\n            departmentid, max(salary)\n        from\n            employee\n        group by departmentid\n\t)\n;\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br")])]),e("h4",{attrs:{id:"_580-统计各专业学生人数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_580-统计各专业学生人数"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/count-student-number-in-departments/",target:"_blank",rel:"noopener noreferrer"}},[s._v("580. 统计各专业学生人数"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    dept_name, count(student_id) as student_number\nfrom\n    department\n        left outer join\n    student on department.dept_id = student.dept_id\ngroup by department.dept_name\norder by student_number desc , department.dept_name\n;\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("h3",{attrs:{id:"_6-连接"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-连接"}},[s._v("#")]),s._v(" 6.连接")]),s._v(" "),e("h4",{attrs:{id:"_1294-不同国家的天气类型"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1294-不同国家的天气类型"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/weather-type-in-each-country/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1294. 不同国家的天气类型"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nSELECT country_name AS 'country_name',\n    CASE \n        WHEN AVG(w1.weather_state) <= 15 THEN 'Cold' \n        WHEN AVG(w1.weather_state) >= 25 THEN 'Hot'\n        ELSE 'Warm'\n    END\n        AS 'weather_type'\nFROM \n    Countries AS c1\n    INNER JOIN Weather AS w1\n    ON c1.country_id = w1.country_id\nWHERE w1.day BETWEEN '2019-11-01' AND '2019-11-30'\nGROUP BY c1.country_id\n;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br")])]),e("h4",{attrs:{id:"_626-换座位"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_626-换座位"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/exchange-seats/",target:"_blank",rel:"noopener noreferrer"}},[s._v("626. 换座位"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    (case\n        when mod(id, 2) != 0 and counts != id then id + 1\n        when mod(id, 2) != 0 and counts = id then id\n        else id - 1\n    end) as id,\n    student\nfrom\n    seat,\n    (select\n        count(*) as counts\n    from\n        seat) as seat_counts\norder by id asc;\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br")])]),e("h4",{attrs:{id:"_1783-大满贯数量"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1783-大满贯数量"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/grand-slam-titles/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1783. 大满贯数量"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\n#计算Championships表中每个运动员id出现的次数\n\nSELECT player_id,player_name,\n      SUM(IF(player_id=Wimbledon,1,0)+IF(player_id=Fr_open,1,0)+IF(player_id=US_open,1,0)+IF(player_id=Au_open,1,0)) AS grand_slams_count\nFROM Championships \nJOIN Players \nGROUP BY player_id\nHAVING grand_slams_count>0\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h4",{attrs:{id:"_1164-指定日期的产品价格"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1164-指定日期的产品价格"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/product-price-at-a-given-date/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1164. 指定日期的产品价格"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select p1.product_id, ifnull(p2.new_price, 10) as price\nfrom (\n    select distinct product_id\n    from products\n) as p1 -- 所有的产品\nleft join (\n    select product_id, new_price \n    from products\n    where (product_id, change_date) in (\n        select product_id, max(change_date)\n        from products\n        where change_date <= '2019-08-16'\n        group by product_id\n    )\n) as p2 -- 在 2019-08-16 之前有过修改的产品和最新的价格\non p1.product_id = p2.product_id\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br")])]),e("h3",{attrs:{id:"_7-连接"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_7-连接"}},[s._v("#")]),s._v(" 7.连接")]),s._v(" "),e("h4",{attrs:{id:"_603-连续空余座位"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_603-连续空余座位"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/consecutive-available-seats/",target:"_blank",rel:"noopener noreferrer"}},[s._v("603. 连续空余座位"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect distinct a.seat_id\nfrom cinema a join cinema b\n  on abs(a.seat_id - b.seat_id) = 1\n  and a.free = true and b.free = true\norder by a.seat_id\n;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("h4",{attrs:{id:"_1731-每位经理的下属员工数量"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1731-每位经理的下属员工数量"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/the-number-of-employees-which-report-to-each-employee/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1731. 每位经理的下属员工数量"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect \n    e1.employee_id,\n    e1.name,\n    count(*) as reports_count,\n    ROUND(avg(e2.age), 0) as average_age\nfrom employees e1\njoin employees e2\non e2.reports_to = e1.employee_id\ngroup by employee_id\norder by employee_id\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br")])]),e("h4",{attrs:{id:"_1747-应该被禁止的-leetflex-账户"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1747-应该被禁止的-leetflex-账户"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/leetflex-banned-accounts/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1747. 应该被禁止的 Leetflex 账户"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect distinct l1.account_id from loginfo l1\njoin loginfo l2\non \n    l1.account_id = l2.account_id and \n    l1.ip_address != l2.ip_address and \n    ( l1.login >= l2.login and l1.login <= l2.logout )\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("h4",{attrs:{id:"_181-超过经理收入的员工"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_181-超过经理收入的员工"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/employees-earning-more-than-their-managers/",target:"_blank",rel:"noopener noreferrer"}},[s._v("181. 超过经理收入的员工"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n     a.name as employee\nfrom employee as a join employee as b\n     on a.managerid = b.id\n     and a.salary > b.salary\n;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("h3",{attrs:{id:"_8-不等式连接"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_8-不等式连接"}},[s._v("#")]),s._v(" 8.不等式连接")]),s._v(" "),e("h4",{attrs:{id:"_1459-矩形面积"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1459-矩形面积"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/rectangles-area/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1459. 矩形面积"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nSELECT \n    p1.id P1,\n    p2.id P2,\n    ABS(p1.x_value-p2.x_value)*ABS(p1.y_value-p2.y_value) AREA\nFROM points p1,points p2\nWHERE p1.id<p2.id \nAND p1.x_value!=p2.x_value\nAND p1.y_value!=p2.y_value\nORDER BY  AREA desc,p1.id,p2.id\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])]),e("h4",{attrs:{id:"_180-连续出现的数字"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_180-连续出现的数字"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/consecutive-numbers/",target:"_blank",rel:"noopener noreferrer"}},[s._v("180. 连续出现的数字"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("SELECT DISTINCT\n    l1.Num AS ConsecutiveNums\nFROM\n    Logs l1,\n    Logs l2,\n    Logs l3\nWHERE\n    l1.Id = l2.Id - 1\n    AND l2.Id = l3.Id - 1\n    AND l1.Num = l2.Num\n    AND l2.Num = l3.Num\n;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br")])]),e("h4",{attrs:{id:"_1988-找出每所学校的最低分数要求"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1988-找出每所学校的最低分数要求"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/find-cutoff-score-for-each-school/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1988. 找出每所学校的最低分数要求"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nSELECT\n    school_id,\n    IFNULL(min(score), -1) as score\nFROM (\n    SELECT\n        s.school_id,\n        e.score\n    FROM schools s\n    LEFT JOIN exam e ON s.capacity >= e.student_count\n) t\nGROUP BY school_id\nORDER BY school_id;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br")])]),e("h3",{attrs:{id:"_9-子查询"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_9-子查询"}},[s._v("#")]),s._v(" 9.子查询")]),s._v(" "),e("h4",{attrs:{id:"_1549-每件商品的最新订单"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1549-每件商品的最新订单"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/the-most-recent-orders-for-each-product/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1549. 每件商品的最新订单"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select p.product_name, o.product_id, o.order_id, o.order_date from orders o\nleft join products p\non p.product_id = o.product_id\nwhere (o.product_id, order_date) in \n(\n    select product_id, max(order_date) from orders\n    group by product_id\n)\norder by product_name asc, product_id asc, order_id asc\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("h4",{attrs:{id:"_1321-餐馆营业额变化增长"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1321-餐馆营业额变化增长"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/restaurant-growth/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1321. 餐馆营业额变化增长"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select \ndistinct a.visited_on,sum(b.amount) as amount,round(sum(b.amount)/7,2) as average_amount \nfrom Customer a\njoin Customer b\non datediff(a.visited_on,b.visited_on) <= 6 and datediff(a.visited_on,b.visited_on) >= 0\ngroup by a.visited_on,a.customer_id     \nhaving  count(distinct b.visited_on) = 7\norder by visited_on \n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("h4",{attrs:{id:"_1045-买下所有产品的客户"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1045-买下所有产品的客户"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/customers-who-bought-all-products/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1045. 买下所有产品的客户"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select customer_id from customer\ngroup by customer_id\nhaving count(distinct product_key) = (select count(distinct product_key) from product)\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h3",{attrs:{id:"_10-子查询"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_10-子查询"}},[s._v("#")]),s._v(" 10.子查询")]),s._v(" "),e("h4",{attrs:{id:"_1341-电影评分"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1341-电影评分"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/movie-rating/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1341. 电影评分"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select T.results FROM \n(\n    SELECT U.name AS results,MR.user_id\n    FROM Users U,MovieRating MR \n    WHERE U.user_id = MR.user_id\n    GROUP BY MR.user_id,U.name\n    ORDER BY COUNT(1) DESC,U.NAME ASC\n    limit 1\n) T\nunion all\nselect Q.results FROM \n(\n    SELECT M.title AS results\n    FROM Movies M,MovieRating MM \n    WHERE M.movie_id = MM.movie_id \n    AND MM.created_at LIKE '2020-02%'\n    GROUP BY M.title\n    ORDER BY AVG(MM.rating) DESC,M.title ASC\n    limit 1\n) Q\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br")])]),e("h4",{attrs:{id:"_1867-最大数量高于平均水平的订单"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1867-最大数量高于平均水平的订单"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/orders-with-maximum-quantity-above-average/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1867. 最大数量高于平均水平的订单"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    order_id\nfrom (\n    -- 每个订单的最大数量 > max(每个订单的平均数量)\n    select\n        *,\n        max(quantity) > max(avg(quantity)) over() as flag\n    from OrdersDetails\n    group by order_id\n) as base\nwhere flag = 1\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])]),e("h3",{attrs:{id:"_11-子查询"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_11-子查询"}},[s._v("#")]),s._v(" 11.子查询")]),s._v(" "),e("h4",{attrs:{id:"_550-游戏玩法分析-iv"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_550-游戏玩法分析-iv"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/game-play-analysis-iv/",target:"_blank",rel:"noopener noreferrer"}},[s._v("550. 游戏玩法分析 IV"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect round(avg(a.event_date is not null), 2) fraction\nfrom \n    (select player_id, min(event_date) as login\n    from activity\n    group by player_id) p \nleft join activity a \non p.player_id=a.player_id and datediff(a.event_date, p.login)=1\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h4",{attrs:{id:"_262-行程和用户"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_262-行程和用户"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/trips-and-users/",target:"_blank",rel:"noopener noreferrer"}},[s._v("262. 行程和用户"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select request_at 'Day',\nround(count(if(status!='completed',status,null))/count(*),2) 'Cancellation Rate'\nfrom Trips\nwhere request_at between '2013-10-01' and '2013-10-03'\nand client_id not in (select users_id from Users where banned='Yes') \nand driver_id not in (select users_id from Users where banned='Yes')\ngroup by request_at;\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("h2",{attrs:{id:"免费题"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#免费题"}},[s._v("#")]),s._v(" 免费题")]),s._v(" "),e("h2",{attrs:{id:"mid中等"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mid中等"}},[s._v("#")]),s._v(" mid中等")]),s._v(" "),e("h3",{attrs:{id:"_1070-产品销售分析-iii「学习」"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1070-产品销售分析-iii「学习」"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/product-sales-analysis-iii/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1070. 产品销售分析 III"),e("OutboundLink")],1),s._v("「学习」")]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect \n    product_id, \n    year as first_year, \n    quantity, \n    price\nfrom sales\nwhere (product_id, year) in   #学习！！⭐️\n( \n    select product_id, min(year)\n    from sales \n    group by product_id\n);\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br")])]),e("h3",{attrs:{id:"_178-分数排名「学习」"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_178-分数排名「学习」"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/rank-scores/",target:"_blank",rel:"noopener noreferrer"}},[s._v("178. 分数排名"),e("OutboundLink")],1),s._v("「学习」")]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect a.score , \n    ( select count( distinct score )  #distinct写法可以和后面的一样\n      from Scores as b\n      where b.score>=a.score\n    ) as `rank`                      #rank也可以不加反引号，但是力扣的mysql版本，好像需要你反引号\nfrom Scores as a\norder by a.score desc;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect a.score , \n    ( select count( distinct(b.score) )\n      from Scores as b\n      where b.score>=a.score\n    ) as `rank`\nfrom Scores as a\norder by a.score desc;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("h3",{attrs:{id:"_1907-按分类统计薪水「写法-」"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1907-按分类统计薪水「写法-」"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/count-salary-categories/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1907. 按分类统计薪水"),e("OutboundLink")],1),s._v("「写法！」")]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect \n    'Low Salary' as category,\n    count(income) as accounts_count\nfrom accounts \nwhere income < 20000\n\nunion\n\nselect \n    'Average Salary' as category,\n    count(income ) as accounts_count\nfrom accounts\nwhere income <= 50000 and income >= 20000\n\nunion \n\nselect \n    'High Salary' as category,\n    count(income) as accounts_count\nfrom accounts\nwhere income > 50000;\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br")])]),e("h3",{attrs:{id:"_1204-最后一个能进入电梯的人"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1204-最后一个能进入电梯的人"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/last-person-to-fit-in-the-bus/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1204. 最后一个能进入电梯的人"),e("OutboundLink")],1)]),s._v(" "),e("h3",{attrs:{id:"_585-2016年的投资⭐️学习"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_585-2016年的投资⭐️学习"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/investments-in-2016/",target:"_blank",rel:"noopener noreferrer"}},[s._v("585. 2016年的投资"),e("OutboundLink")],1),s._v("⭐️学习！！")]),s._v(" "),e("ul",[e("li",[s._v("下面的语法报错")])]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect sum( TIV_2016 ) as TIV_2016\nfrom insurance\nwhere count(TIV_2015)>1\nand count(LAT)=1;\ngroup by TIV_2015; \n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("ul",[e("li",[s._v("需要下面这么写\n"),e("ul",[e("li",[s._v("提示：连接 "),e("strong",[s._v("LAT")]),s._v(" 和 "),e("strong",[s._v("LON")]),s._v(" 为一个整体，以表示坐标信息。")])])])]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nSELECT\n    round( SUM(insurance.TIV_2016) , 2) AS TIV_2016\nFROM\n    insurance\nWHERE\n    insurance.TIV_2015 IN\n    (\n      SELECT\n        TIV_2015\n      FROM\n        insurance\n      GROUP BY TIV_2015\n      HAVING COUNT(*) > 1  #group by才能count好像！！！\n    )\n    AND \n    CONCAT(LAT, LON) IN   \n    (\n      SELECT\n        CONCAT(LAT, LON)\n      FROM\n        insurance\n      GROUP BY LAT , LON\n      HAVING COUNT(*) = 1\n    )\n;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br")])]),e("h3",{attrs:{id:"_602-好友申请-ii-谁有最多的好友「学习union-all的特殊技巧」"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_602-好友申请-ii-谁有最多的好友「学习union-all的特殊技巧」"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/friend-requests-ii-who-has-the-most-friends/",target:"_blank",rel:"noopener noreferrer"}},[s._v("602. 好友申请 II ：谁有最多的好友"),e("OutboundLink")],1),s._v("「学习union all的特殊技巧」")]),s._v(" "),e("ul",[e("li",[s._v("借助取相同的名字")])]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect id , count(id) as num\nfrom\n(\n    select requester_id as id  #借助取相同的名字\n    from RequestAccepted\n    union all\n    select accepter_id as id \n    from RequestAccepted\n) as temp  #一定要as temp，不然就会语法报错！！！\ngroup by id\norder by num desc\nlimit 0, 1;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br")])]),e("h2",{attrs:{id:"easy简单"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#easy简单"}},[s._v("#")]),s._v(" easy简单")]),s._v(" "),e("h3",{attrs:{id:"_1978-上级经理已离职的公司员工"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1978-上级经理已离职的公司员工"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/employees-whose-manager-left-the-company/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1978. 上级经理已离职的公司员工"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect employee_id\nfrom Employees\nwhere \n    salary < 30000\nand \n    manager_id not in (\n        select employee_id\n        from Employees\n    )\norder by employee_id;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])]),e("h3",{attrs:{id:"_577-员工奖金「典型left-join」"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_577-员工奖金「典型left-join」"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/employee-bonus/",target:"_blank",rel:"noopener noreferrer"}},[s._v("577. 员工奖金"),e("OutboundLink")],1),s._v("「典型left join」")]),s._v(" "),e("p",[s._v("坑点：bonus"),e("code",[s._v("值为空，空值在数据库中的表示为")]),s._v("null")]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect Employee.name , Bonus.bonus\nfrom \n    Employee \nleft join\n    Bonus\non \n    Employee.empID=Bonus.empID \nwhere\n    ifnull(Bonus.bonus, 0 )<1000;  #学习函数IFnull\n    #使用IFNULL函数，如果是Null的话，用一个小于1000的值代替null值，这样就会筛选出bonus为Null的员工\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])]),e("ul",[e("li",[s._v("==等价于下面的判断null的==")])]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect Employee.name , Bonus.bonus\nfrom \n    Employee \nleft join\n    Bonus\non \n    Employee.empID=Bonus.empID \nwhere\n    (Bonus.bonus is null) or (Bonus.bonus<1000); \n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("h3",{attrs:{id:"_620-有趣的电影"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_620-有趣的电影"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/not-boring-movies/",target:"_blank",rel:"noopener noreferrer"}},[s._v("620. 有趣的电影"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect  id, movie, description, rating\nfrom cinema\nwhere \n    'boring'!=description\nand \n    1=mod(id,2)\norder by rating desc;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect  id, movie, description, rating\nfrom cinema\nwhere \n    'boring'!=description\nand \n    1=id%2\norder by rating desc;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("h3",{attrs:{id:"_1075-项目员工-i"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1075-项目员工-i"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/project-employees-i/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1075. 项目员工 I"),e("OutboundLink")],1)]),s._v(" "),e("ul",[e("li",[s._v("round函数+group by要指定对")]),s._v(" "),e("li",[s._v("查询每一个项目中员工的 "),e("strong",[s._v("平均")]),s._v(" 工作年限，"),e("strong",[s._v("精确到小数点后两位")]),s._v("。")])]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect \n    Project.project_id, \n    round( avg(Employee.experience_years), 2) as average_years \nfrom \n    Project, Employee\nwhere Project.employee_id=Employee.employee_id\ngroup by Project.project_id;\n\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("ul",[e("li",[s._v("inner join")])]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect \n    Project.project_id, \n    round( avg(Employee.experience_years), 2) as average_years \nfrom \n    Project\ninner join\n    Employee\nwhere Project.employee_id=Employee.employee_id\ngroup by Project.project_id;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("ul",[e("li",[s._v("join")])]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect \n    Project.project_id, \n    round( avg(Employee.experience_years), 2) as average_years \nfrom \n    Project\njoin\n    Employee\nwhere Project.employee_id=Employee.employee_id\ngroup by Project.project_id;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("h3",{attrs:{id:"_1683-无效的推文-length函数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1683-无效的推文-length函数"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/invalid-tweets/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1683. 无效的推文"),e("OutboundLink")],1),s._v("-length函数")]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect tweet_id \nfrom Tweets\nwhere length( content )>15;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h3",{attrs:{id:"_1378-使用唯一标识码替换员工id"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1378-使用唯一标识码替换员工id"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/replace-employee-id-with-the-unique-identifier/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1378. 使用唯一标识码替换员工ID"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect EmployeeUNI.unique_id , Employees.name\nfrom \n    Employees\nleft join\n    EmployeeUNI\non Employees.id=EmployeeUNI.id; \n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("h3",{attrs:{id:"_2356-每位教师所教授的科目种类的数量"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2356-每位教师所教授的科目种类的数量"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/number-of-unique-subjects-taught-by-each-teacher/",target:"_blank",rel:"noopener noreferrer"}},[s._v("2356. 每位教师所教授的科目种类的数量"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect teacher_id , count( distinct(subject_id) )cnt\nfrom Teacher\ngroup by teacher_id;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h3",{attrs:{id:"_610-判断三角形-分支判断-case-end⭐️"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_610-判断三角形-分支判断-case-end⭐️"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/triangle-judgement/",target:"_blank",rel:"noopener noreferrer"}},[s._v("610. 判断三角形"),e("OutboundLink")],1),s._v("-分支判断-case end⭐️")]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect x, y, z , \n( \n    case\n        when x+y>z and x+z>y and y+z>x \n        then 'Yes' \n        else 'No'\n    end\n)\nas triangle\nfrom Triangle;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])]),e("h3",{attrs:{id:"_1517-查找拥有有效邮箱的用户-正则表达式⭐️⭐️⭐️"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1517-查找拥有有效邮箱的用户-正则表达式⭐️⭐️⭐️"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/find-users-with-valid-e-mails/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1517. 查找拥有有效邮箱的用户"),e("OutboundLink")],1),s._v("-正则表达式⭐️⭐️⭐️")]),s._v(" "),e("p",[s._v("参考资料：https://leetcode.cn/problems/find-users-with-valid-e-mails/solution/xue-xi-liao-zheng-ze-biao-da-shi-yao-yon-hl2c/")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("^ 表示以后面的字符为开头\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" 表示括号内任意字符\n\n- 表示连续\n* 表示重复前面任意字符任意次数\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v(" 用来转义后面的特殊字符，以表示字符原本的样子，而不是将其作为特殊字符使用\n  $ 表示以前面的字符为结尾\n\n前缀名以字母开头：^"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("a-zA-Z"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n前缀名包含字母（大写或小写）、数字、下划线_、句点. 和 或 横杠-："),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("a-zA-Z0-9"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("_"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("."),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("-"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("*\n以域名"),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@leetcode.com'")]),s._v("结尾：@leetcode"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v(".com$\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])]),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect \n    *\nfrom Users\nwhere mail regexp '^[a-zA-Z]+[\\\\w./-]*@leetcode\\\\.com$';\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("ul",[e("li",[e("code",[s._v("'[a-zA-Z0-9_]'")]),s._v("简写"),e("code",[s._v("'[\\w]'")])])]),s._v(" "),e("h3",{attrs:{id:"_1068-产品销售分析-i-写法"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1068-产品销售分析-i-写法"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/product-sales-analysis-i/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1068. 产品销售分析 I"),e("OutboundLink")],1),s._v("-写法")]),s._v(" "),e("ul",[e("li",[s._v("inner join")])]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect Product.product_name, Sales.year, Sales.price\nfrom \n    Sales\ninner join\n    Product\nusing(product_id) ;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("ul",[e("li",[s._v("on")])]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect Product.product_name, Sales.year, Sales.price\nfrom \n    Sales\ninner join\n    Product\non Sales.product_id=Product.product_id ;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("ul",[e("li",[s._v("where")])]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect Product.product_name, Sales.year, Sales.price\nfrom \n    Sales, Product\nwhere Sales.product_id=Product.product_id ;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h3",{attrs:{id:"_1789-员工的直属部门-难点⭐️"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1789-员工的直属部门-难点⭐️"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/primary-department-for-each-employee/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1789. 员工的直属部门"),e("OutboundLink")],1),s._v("-难点⭐️")]),s._v(" "),e("ul",[e("li",[s._v("联合查询，自动去重")])]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nSELECT employee_id AS 'employee_id', \n    department_id AS 'department_id'\nFROM Employee \nWHERE primary_flag = 'Y'\n\nUNION               \n\nSELECT employee_id AS 'employee_id', \n    department_id AS 'department_id'\nFROM Employee\nGROUP BY employee_id\nHAVING COUNT(department_id) = 1;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br")])]),e("h3",{attrs:{id:"_1661-每台机器的进程平均运行时间-难点-复杂逻辑-⭐️"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1661-每台机器的进程平均运行时间-难点-复杂逻辑-⭐️"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/average-time-of-process-per-machine/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1661. 每台机器的进程平均运行时间"),e("OutboundLink")],1),s._v("-难点-复杂逻辑-⭐️")]),s._v(" "),e("ul",[e("li",[s._v("AVG() 函数返回数值列的平均值。")])]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect\n    machine_id,\n    round( \n        avg(   if(activity_type='start', -timestamp, timestamp)  )*2\n        , 3) processing_time \nfrom Activity \ngroup by machine_id;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\nselect machine_id,\n    round( \n        avg( if( 'start'=activity_type , -timestamp, timestamp)) *2 \n        ,3) as processing_time\nfrom Activity\ngroup by machine_id;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("h3",{attrs:{id:"_1327-列出指定时间段内所有的下单产品"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1327-列出指定时间段内所有的下单产品"}},[s._v("#")]),s._v(" "),e("a",{attrs:{href:"https://leetcode.cn/problems/list-the-products-ordered-in-a-period/",target:"_blank",rel:"noopener noreferrer"}},[s._v("1327. 列出指定时间段内所有的下单产品"),e("OutboundLink")],1),s._v("-")]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Write your MySQL query statement below\n\nselect Products.product_name, sum( Orders.unit ) as unit\nfrom Products, Orders\nwhere \n    Products.product_id=Orders.product_id\nand \n    Orders.order_date like '2020-02-%'\ngroup by Orders.product_id\nhaving sum( Orders.unit )>=100;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("h2",{attrs:{id:"_4-mysql必知必会-牛客"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-mysql必知必会-牛客"}},[s._v("#")]),s._v(" 4.MySQL必知必会-牛客")]),s._v(" "),e("ul",[e("li",[s._v("主要以MySQL的语法解决问题")]),s._v(" "),e("li",[s._v("用实战的方式，熟悉SQL语法")])]),s._v(" "),e("h2",{attrs:{id:"《sql必知必会》配套题单-题解"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#《sql必知必会》配套题单-题解"}},[s._v("#")]),s._v(" 《SQL必知必会》配套题单-题解")]),s._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://www.nowcoder.com/exam/oj?page=1&tab=SQL%E7%AF%87&topicId=298",target:"_blank",rel:"noopener noreferrer"}},[s._v("链接"),e("OutboundLink")],1)])]),s._v(" "),e("h3",{attrs:{id:"_1-检索数据"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-检索数据"}},[s._v("#")]),s._v(" 1.检索数据")]),s._v(" "),e("h4",{attrs:{id:"_60-✔️从-customers-表中检索所有的-id"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_60-✔️从-customers-表中检索所有的-id"}},[s._v("#")]),s._v(" 60.✔️从 Customers 表中检索所有的 ID")]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select cust_id from Customers\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h4",{attrs:{id:"_61-✔️检索并列出已订购产品的清单「去重」"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_61-✔️检索并列出已订购产品的清单「去重」"}},[s._v("#")]),s._v(" 61.✔️"),e("a",{attrs:{href:"https://www.nowcoder.com/practice/9e4741b77f4244149a069883bc0d23be?tpId=298&tqId=2364828&ru=/exam/oj&qru=/ta/sql-teach-yourself/question-ranking&sourceUrl=%2Fexam%2Foj%3Fpage%3D1%26tab%3DSQL%25E7%25AF%2587%26topicId%3D298",target:"_blank",rel:"noopener noreferrer"}},[s._v("检索并列出已订购产品的清单"),e("OutboundLink")],1),s._v("「去重」")]),s._v(" "),e("ul",[e("li",[s._v("记忆：distinct, adj,不同种类的;\n"),e("ul",[e("li",[s._v("去重！")])])])]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select distinct(prod_id) from OrderItems \n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h4",{attrs:{id:"_62-检索所有列"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_62-检索所有列"}},[s._v("#")]),s._v(" 62. 检索所有列")]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select * from Customers\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"_2-排序检索数据「order-by」"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-排序检索数据「order-by」"}},[s._v("#")]),s._v(" 2.排序检索数据「order by」")]),s._v(" "),e("h4",{attrs:{id:"_63-✔️检索顾客名称并且排序"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_63-✔️检索顾客名称并且排序"}},[s._v("#")]),s._v(" 63. ✔️"),e("a",{attrs:{href:"https://www.nowcoder.com/practice/6cfabb1b49554c4c8d8f9977bf6a3a5d?tpId=298&tqId=2364830&ru=/exam/oj&qru=/ta/sql-teach-yourself/question-ranking&sourceUrl=%2Fexam%2Foj%3Fpage%3D1%26tab%3DSQL%25E7%25AF%2587%26topicId%3D298",target:"_blank",rel:"noopener noreferrer"}},[s._v("检索顾客名称并且排序"),e("OutboundLink")],1)]),s._v(" "),e("ul",[e("li",[s._v("逆序，desc")]),s._v(" "),e("li",[s._v("正序，asc")])]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select cust_name \nfrom Customers \norder by cust_name desc\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h4",{attrs:{id:"_64-✔️对顾客id和日期排序"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_64-✔️对顾客id和日期排序"}},[s._v("#")]),s._v(" 64. ✔️"),e("a",{attrs:{href:"https://www.nowcoder.com/practice/fa4eb4880d124a4ead7a9b025fe75b70?tpId=298&tqId=2366895&ru=/exam/oj&qru=/ta/sql-teach-yourself/question-ranking&sourceUrl=%2Fexam%2Foj%3Fpage%3D1%26tab%3DSQL%25E7%25AF%2587%26topicId%3D298",target:"_blank",rel:"noopener noreferrer"}},[s._v("对顾客ID和日期排序"),e("OutboundLink")],1)]),s._v(" "),e("p",[s._v("从 Orders 表中检索顾客 ID（cust_id）和订单号（order_num），并"),e("strong",[s._v("先按")]),s._v("顾客 ID 对结果进行排序，"),e("strong",[s._v("再按")]),s._v("订单日期倒序排列")]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select cust_id , order_num \nfrom Orders \norder by cust_id , order_date desc\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h4",{attrs:{id:"_65-✔️按照数量和价格排序"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_65-✔️按照数量和价格排序"}},[s._v("#")]),s._v(" 65. ✔️"),e("a",{attrs:{href:"https://www.nowcoder.com/practice/bd05a6684e534bd1bf2d9ebbda475333?tpId=298&tqId=2366897&ru=/exam/oj&qru=/ta/sql-teach-yourself/question-ranking&sourceUrl=%2Fexam%2Foj%3Fpage%3D1%26tab%3DSQL%25E7%25AF%2587%26topicId%3D298",target:"_blank",rel:"noopener noreferrer"}},[s._v("按照数量和价格排序"),e("OutboundLink")],1)]),s._v(" "),e("ul",[e("li",[s._v("==易错：注意，每列都需要单独的desc或者asc==")])]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select quantity , item_price \nfrom OrderItems\norder by quantity desc, item_price desc\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h4",{attrs:{id:"_66-检查sql语句"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_66-检查sql语句"}},[s._v("#")]),s._v(" 66. 检查SQL语句")]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("SELECT vend_name\nFROM Vendors \nORDER BY vend_name DESC;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h3",{attrs:{id:"_3-过滤数据「过滤规则where」"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-过滤数据「过滤规则where」"}},[s._v("#")]),s._v(" 3.过滤数据「过滤规则where」")]),s._v(" "),e("h4",{attrs:{id:"_67-✔️-返回固定价格的产品"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_67-✔️-返回固定价格的产品"}},[s._v("#")]),s._v(" 67.✔️ "),e("a",{attrs:{href:"https://www.nowcoder.com/practice/9949bfb933614abe8bd2bc26c129843e?tpId=298&tqId=2366910&ru=/exam/oj&qru=/ta/sql-teach-yourself/question-ranking&sourceUrl=%2Fexam%2Foj%3Fpage%3D1%26tab%3DSQL%25E7%25AF%2587%26topicId%3D298",target:"_blank",rel:"noopener noreferrer"}},[s._v("返回固定价格的产品"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select prod_id , prod_name\nfrom Products\nwhere 9.49=prod_price\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h4",{attrs:{id:"_68-✔️返回更高价格的产品"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_68-✔️返回更高价格的产品"}},[s._v("#")]),s._v(" 68.✔️"),e("a",{attrs:{href:"https://www.nowcoder.com/practice/f6153be7485448cdb444279dcc105cb8?tpId=298&tqId=2368011&ru=/exam/oj&qru=/ta/sql-teach-yourself/question-ranking&sourceUrl=%2Fexam%2Foj%3Fpage%3D1%26tab%3DSQL%25E7%25AF%2587%26topicId%3D298",target:"_blank",rel:"noopener noreferrer"}},[s._v("返回更高价格的产品"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select prod_id , prod_name\nfrom Products\nwhere prod_price >= 9\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h4",{attrs:{id:"_69-✔️返回产品并且按照价格排序"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_69-✔️返回产品并且按照价格排序"}},[s._v("#")]),s._v(" 69.✔️"),e("a",{attrs:{href:"https://www.nowcoder.com/practice/560c94bf434e4e77911982e2d7ca0abb?tpId=298&tqId=2368015&ru=/exam/oj&qru=/ta/sql-teach-yourself/question-ranking&sourceUrl=%2Fexam%2Foj%3Fpage%3D1%26tab%3DSQL%25E7%25AF%2587%26topicId%3D298",target:"_blank",rel:"noopener noreferrer"}},[s._v("返回产品并且按照价格排序"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select prod_name , prod_price\nfrom Products \nwhere prod_price between 3 and 6 #表示【3,6】\norder by prod_price\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h4",{attrs:{id:"_70-返回更多的产品"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_70-返回更多的产品"}},[s._v("#")]),s._v(" 70."),e("a",{attrs:{href:"https://www.nowcoder.com/practice/dc91b7d2de3c4603a55995e83210f605?tpId=298&tqId=2368029&ru=/exam/oj&qru=/ta/sql-teach-yourself/question-ranking&sourceUrl=%2Fexam%2Foj%3Fpage%3D1%26tab%3DSQL%25E7%25AF%2587%26topicId%3D298",target:"_blank",rel:"noopener noreferrer"}},[s._v("返回更多的产品"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select distinct(order_num)\nfrom OrderItems\nwhere quantity >= 100\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h3",{attrs:{id:"_4-高级数据过滤"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-高级数据过滤"}},[s._v("#")]),s._v(" 4.高级数据过滤")]),s._v(" "),e("h4",{attrs:{id:"_71-检索供应商名称⭐️「and」"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_71-检索供应商名称⭐️「and」"}},[s._v("#")]),s._v(" 71."),e("a",{attrs:{href:"https://www.nowcoder.com/practice/c4d520ed6a264ad3900eff95e4195d59?tpId=298&tqId=2368033&ru=/exam/oj&qru=/ta/sql-teach-yourself/question-ranking&sourceUrl=%2Fexam%2Foj%3Fpage%3D1%26tab%3DSQL%25E7%25AF%2587%26topicId%3D298",target:"_blank",rel:"noopener noreferrer"}},[s._v("检索供应商名称"),e("OutboundLink")],1),s._v("⭐️「and」")]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select vend_name\nfrom Vendors\nwhere vend_country='USA' and vend_state='CA'\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h4",{attrs:{id:"_72-检索并列出已订购产品的清单⭐️「in」"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_72-检索并列出已订购产品的清单⭐️「in」"}},[s._v("#")]),s._v(" 72."),e("a",{attrs:{href:"https://www.nowcoder.com/practice/674d99a46a96494d8267ae4d162ed459?tpId=298&tags=&title=&difficulty=0&judgeStatus=0&rp=0&sourceUrl=%2Fexam%2Foj%3Fpage%3D1%26tab%3DSQL%25E7%25AF%2587%26topicId%3D298",target:"_blank",rel:"noopener noreferrer"}},[s._v("检索并列出已订购产品的清单"),e("OutboundLink")],1),s._v("⭐️「in」")]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select order_num ,  prod_id , quantity\n from OrderItems \n where prod_id in ( 'BR01' , 'BR02' , 'BR03' ) and quantity >= 100\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h4",{attrs:{id:"_73-返回所有价格在-3美元到-6美元之间的产品的名称和价格"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_73-返回所有价格在-3美元到-6美元之间的产品的名称和价格"}},[s._v("#")]),s._v(" 73.返回所有价格在 3美元到 6美元之间的产品的名称和价格")]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select prod_name , prod_price\nfrom Products\nwhere prod_price between 3 and 6\norder by prod_price\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h4",{attrs:{id:"_74-纠错2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_74-纠错2"}},[s._v("#")]),s._v(" 74.纠错2")]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("SELECT vend_name \nFROM Vendors \nWHERE vend_country = 'USA' AND vend_state = 'CA'\nORDER BY vend_name\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h3",{attrs:{id:"_5-用通配符进行过滤「正则表达式」"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-用通配符进行过滤「正则表达式」"}},[s._v("#")]),s._v(" 5.用通配符进行过滤「正则表达式」")]),s._v(" "),e("h4",{attrs:{id:"_75-检索产品名称和描述-一-⭐️"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_75-检索产品名称和描述-一-⭐️"}},[s._v("#")]),s._v(" 75."),e("a",{attrs:{href:"https://www.nowcoder.com/practice/47e8101cb2b447038effcf5159e6aa7f?tpId=298&tqId=2369655&ru=/exam/oj&qru=/ta/sql-teach-yourself/question-ranking&sourceUrl=%2Fexam%2Foj%3Fpage%3D1%26tab%3DSQL%25E7%25AF%2587%26topicId%3D298",target:"_blank",rel:"noopener noreferrer"}},[s._v("检索产品名称和描述"),e("OutboundLink")],1),s._v("（一）⭐️")]),s._v(" "),e("p",[s._v("仅返回描述中"),e("strong",[s._v("包含 toy 一词")]),s._v("的产品名称")]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select prod_name , prod_desc\nfrom Products\nwhere prod_desc like '%toy%'\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h4",{attrs:{id:"_76-检索产品名称和描述-二"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_76-检索产品名称和描述-二"}},[s._v("#")]),s._v(" 76.检索产品名称和描述（二）")]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select prod_name , prod_desc\nfrom Products\nwhere not prod_desc like '%toy%'\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h4",{attrs:{id:"_77-检索产品名称和描述-三"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_77-检索产品名称和描述-三"}},[s._v("#")]),s._v(" 77.检索产品名称和描述（三）")]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select prod_name , prod_desc\nfrom Products\nwhere \nprod_desc like '%toy%' \nand \nprod_desc like '%carrots%'\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("h4",{attrs:{id:"_78-检索产品名称和描述-四-⭐️"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_78-检索产品名称和描述-四-⭐️"}},[s._v("#")]),s._v(" 78."),e("a",{attrs:{href:"https://www.nowcoder.com/practice/a9099944fa9c4cf0b7e406f22ee8c9a0?tpId=298&tqId=2373706&ru=/exam/oj&qru=/ta/sql-teach-yourself/question-ranking&sourceUrl=%2Fexam%2Foj%3Fpage%3D1%26tab%3DSQL%25E7%25AF%2587%26topicId%3D298",target:"_blank",rel:"noopener noreferrer"}},[s._v("检索产品名称和描述"),e("OutboundLink")],1),s._v("（四）⭐️")]),s._v(" "),e("p",[s._v("仅返回在描述中以"),e("strong",[s._v("先后顺序")]),s._v("==同时出现 toy 和 carrots 的产品==。提示：只需要用带有三个 % 符号的 LIKE 即可")]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select prod_name , prod_desc\nfrom Products\nwhere \nprod_desc like '%toy%carrots%'\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h3",{attrs:{id:"_6-「别名」"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-「别名」"}},[s._v("#")]),s._v(" 6.「别名」")]),s._v(" "),e("p",[s._v("创建计算字段")]),s._v(" "),e("h4",{attrs:{id:"_79-别名⭐️"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_79-别名⭐️"}},[s._v("#")]),s._v(" 79."),e("a",{attrs:{href:"https://www.nowcoder.com/practice/3a4ec448b6f74dc49f886692887aaf84?tpId=298&tags=&title=&difficulty=0&judgeStatus=0&rp=0&sourceUrl=%2Fexam%2Foj%3Fpage%3D1%26tab%3DSQL%25E7%25AF%2587%26topicId%3D298",target:"_blank",rel:"noopener noreferrer"}},[s._v("别名"),e("OutboundLink")],1),s._v("⭐️")]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select vend_id\n,vend_name as vname\n,vend_address as vaddress\n,vend_city as vcity\nfrom Vendors\norder by vend_name\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("h4",{attrs:{id:"_80-打折⭐️「别名的高级使用」"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_80-打折⭐️「别名的高级使用」"}},[s._v("#")]),s._v(" 80."),e("a",{attrs:{href:"https://www.nowcoder.com/practice/90bb4ccf41b24f3fa7e5f460ff6ee7cd?tpId=298&tags=&title=&difficulty=0&judgeStatus=0&rp=0&sourceUrl=%2Fexam%2Foj%3Fpage%3D1%26tab%3DSQL%25E7%25AF%2587%26topicId%3D298",target:"_blank",rel:"noopener noreferrer"}},[s._v("打折"),e("OutboundLink")],1),s._v("⭐️「别名的高级使用」")]),s._v(" "),e("ul",[e("li",[s._v("sale_price 是一个包含促销价格的计算字段。提示："),e("strong",[s._v("可以乘以 0.9，得到原价的 90%")]),s._v("（即 10%的折扣）")])]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select prod_id , prod_price \n, prod_price*0.9 as sale_price #⭐️⭐️⭐️\nfrom Products\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h3",{attrs:{id:"_7-使用函数处理数据「函数」"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_7-使用函数处理数据「函数」"}},[s._v("#")]),s._v(" 7.使用函数处理数据「函数」")]),s._v(" "),e("h4",{attrs:{id:"_81-顾客登录名"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_81-顾客登录名"}},[s._v("#")]),s._v(" 81."),e("a",{attrs:{href:"https://www.nowcoder.com/practice/7cbf5e3082954c21a80fc750ce97350f?tpId=298&tags=&title=&difficulty=0&judgeStatus=0&rp=0&sourceUrl=%2Fexam%2Foj%3Fpage%3D1%26tab%3DSQL%25E7%25AF%2587%26topicId%3D298",target:"_blank",rel:"noopener noreferrer"}},[s._v("顾客登录名"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select cust_id, cust_name , \nupper( \n    concat( \n        substring(cust_contact,1,2)\n        , substring(cust_city,1,3)\n        )\n    )\nas user_login\nfrom Customers\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h4",{attrs:{id:"_82-返回-2020-年-1-月的所有订单的订单号和订单日期"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_82-返回-2020-年-1-月的所有订单的订单号和订单日期"}},[s._v("#")]),s._v(" 82.返回 2020 年 1 月的所有订单的订单号和订单日期")]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select order_num , order_date\nfrom Orders\nwhere substring(order_date,1,7)='2020-01'\norder by order_date\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h3",{attrs:{id:"_8-汇总数据「统计」"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_8-汇总数据「统计」"}},[s._v("#")]),s._v(" 8.汇总数据「统计」")]),s._v(" "),e("h4",{attrs:{id:"_83-确定已售出产品的总数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_83-确定已售出产品的总数"}},[s._v("#")]),s._v(" 83.确定已售出产品的总数")]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select sum(quantity) as items_ordered\nfrom OrderItems\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h4",{attrs:{id:"_84-确定已售出产品项-br01-的总数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_84-确定已售出产品项-br01-的总数"}},[s._v("#")]),s._v(" 84.确定已售出产品项 BR01 的总数")]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select sum(quantity) as items_ordered\nfrom OrderItems\nwhere prod_id='BR01'\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h4",{attrs:{id:"_85-确定-products-表中价格不超过-10-美元的最贵产品的价格"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_85-确定-products-表中价格不超过-10-美元的最贵产品的价格"}},[s._v("#")]),s._v(" 85.确定 Products 表中价格不超过 10 美元的最贵产品的价格")]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select sum(quantity) as items_ordered\nfrom OrderItems\nwhere prod_id='BR01'\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h3",{attrs:{id:"_9-分组数据"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_9-分组数据"}},[s._v("#")]),s._v(" 9.分组数据")]),s._v(" "),e("h4",{attrs:{id:"_86-返回每个订单号各有多少行数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_86-返回每个订单号各有多少行数"}},[s._v("#")]),s._v(" 86."),e("a",{attrs:{href:"https://www.nowcoder.com/practice/cf1f8d4a514d455aa0468718fb411f41?tpId=298&tqId=2374634&ru=/exam/oj&qru=/ta/sql-teach-yourself/question-ranking&sourceUrl=%2Fexam%2Foj%3Fpage%3D1%26tab%3DSQL%25E7%25AF%2587%26topicId%3D298",target:"_blank",rel:"noopener noreferrer"}},[s._v("返回每个订单号各有多少行数"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select order_num , count(*) as order_lines\nfrom OrderItems\ngroup by order_num\norder by order_lines\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h4",{attrs:{id:"_87-每个供应商成本最低的产品"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_87-每个供应商成本最低的产品"}},[s._v("#")]),s._v(" 87.每个供应商成本最低的产品")]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select vend_id, min(prod_price)  as cheapest_item\nfrom Products\ngroup by vend_id\norder by cheapest_item\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h4",{attrs:{id:"_88-确定最佳顾客"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_88-确定最佳顾客"}},[s._v("#")]),s._v(" 88.确定最佳顾客")]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select order_num\nfrom OrderItems\ngroup by order_num\nhaving sum(quantity)>=100\norder by order_num\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h4",{attrs:{id:"_89-确定最佳顾客的另一种方式-一"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_89-确定最佳顾客的另一种方式-一"}},[s._v("#")]),s._v(" 89.确定最佳顾客的另一种方式（一）")]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n  order_num,\n  sum(quantity * item_price) as total_price\nfrom\n  OrderItems\ngroup by\n  order_num\nhaving\n  sum(quantity * item_price) >= 1000\norder by\n  order_num\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])]),e("h4",{attrs:{id:"_90-纠错3"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_90-纠错3"}},[s._v("#")]),s._v(" 90.纠错3")]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("SELECT order_num, COUNT(*) AS items \nFROM OrderItems \nGROUP BY order_num\nHAVING COUNT(*) >= 3 \nORDER BY items, order_num;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h3",{attrs:{id:"_10-使用「子查询」"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_10-使用「子查询」"}},[s._v("#")]),s._v(" 10.使用「子查询」")]),s._v(" "),e("h4",{attrs:{id:"_91-返回购买价格为-10-美元或以上产品的顾客列表"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_91-返回购买价格为-10-美元或以上产品的顾客列表"}},[s._v("#")]),s._v(" 91."),e("a",{attrs:{href:"https://www.nowcoder.com/practice/827eb2a210c64ccdb8ec28fe4c50c246?tpId=298&tqId=2374686&ru=/exam/oj&qru=/ta/sql-teach-yourself/question-ranking&sourceUrl=%2Fexam%2Foj%3Fpage%3D1%26tab%3DSQL%25E7%25AF%2587%26topicId%3D298",target:"_blank",rel:"noopener noreferrer"}},[s._v("返回购买价格为 10 美元或以上产品的顾客列表"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select order_num\nfrom OrderItems\ngroup by order_num\nhaving sum(quantity)>=100\norder by order_num\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("ul",[e("li",[s._v("下面的不行！！！必须是上面的where")])]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select order_num\nfrom OrderItems\nwhere sum(quantity)>=100   (错误答案)\ngroup by order_num\norder by order_num\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h4",{attrs:{id:"_92-确定哪些订单购买了-prod-id-为-br01-的产品-一"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_92-确定哪些订单购买了-prod-id-为-br01-的产品-一"}},[s._v("#")]),s._v(" 92."),e("a",{attrs:{href:"https://www.nowcoder.com/profile/548473347/codeBookDetail?submissionId=404543255",target:"_blank",rel:"noopener noreferrer"}},[s._v("确定哪些订单购买了 prod_id 为 BR01 的产品（一）"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select cust_id,order_date\nfrom Orders\nwhere order_num in\n(\nselect order_num\nfrom OrderItems\nwhere prod_id ='BR01')\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("h4",{attrs:{id:"_93-返回购买-prod-id-为-br01-的产品的所有顾客的电子邮件-一"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_93-返回购买-prod-id-为-br01-的产品的所有顾客的电子邮件-一"}},[s._v("#")]),s._v(" 93."),e("a",{attrs:{href:"https://www.nowcoder.com/practice/962b16554fbf4b99a87f4d68020c5bfb?tpId=298&tqId=2374689&ru=/exam/oj&qru=/ta/sql-teach-yourself/question-ranking&sourceUrl=%2Fexam%2Foj%3Fpage%3D1%26tab%3DSQL%E7%AF%87%26topicId%3D298",target:"_blank",rel:"noopener noreferrer"}},[s._v("返回购买 prod_id 为 BR01 的产品的所有顾客的电子邮件（一）"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select cust_email from Customers\nwhere cust_id in\n\n(select cust_id from  Orders\nwhere order_num in\n\n(select order_num from OrderItems\nwhere prod_id='BR01'))\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("h4",{attrs:{id:"_94-返回每个顾客不同订单的总金额"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_94-返回每个顾客不同订单的总金额"}},[s._v("#")]),s._v(" 94."),e("a",{attrs:{href:"https://www.nowcoder.com/practice/ce313253a81c4947b20e801cd4da7894?tpId=298&tqId=2374691&ru=/exam/oj&qru=/ta/sql-teach-yourself/question-ranking&sourceUrl=%2Fexam%2Foj%3Fpage%3D1%26tab%3DSQL%25E7%25AF%2587%26topicId%3D298",target:"_blank",rel:"noopener noreferrer"}},[s._v("返回每个顾客不同订单的总金额"),e("OutboundLink")],1)]),s._v(" "),e("ul",[e("li",[s._v("坑点："),e("code",[s._v("OrderItems.order_num = Orders.order_num")]),s._v("需要考虑，2个订单是否完整")])]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n  cust_id, \n  (\n      select sum( item_price*quantity ) as total_ordered\n      from OrderItems\n      where OrderItems.order_num = Orders.order_num\n      group by order_num\n   ) as total_ordered\nfrom\n  Orders\norder by  total_ordered desc\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])]),e("h4",{attrs:{id:"_95-从-products-表中检索所有的产品名称以及对应的销售"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_95-从-products-表中检索所有的产品名称以及对应的销售"}},[s._v("#")]),s._v(" 95."),e("a",{attrs:{href:"https://www.nowcoder.com/practice/2b289b78de1546f38fd24e17e56f1bec?tpId=298&tqId=2374695&ru=/exam/oj&qru=/ta/sql-teach-yourself/question-ranking&sourceUrl=%2Fexam%2Foj%3Fpage%3D1%26tab%3DSQL%25E7%25AF%2587%26topicId%3D298",target:"_blank",rel:"noopener noreferrer"}},[s._v("从 Products 表中检索所有的产品名称以及对应的销售"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select prod_name,\n(\nselect sum(quantity) as quant_sold\nfrom OrderItems\nwhere Products.prod_id=OrderItems.prod_id\ngroup by prod_name\n)as quant_sold\nfrom Products\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("h3",{attrs:{id:"_11-⭐️联结表"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_11-⭐️联结表"}},[s._v("#")]),s._v(" 11.⭐️联结表")]),s._v(" "),e("h4",{attrs:{id:"_96-返回顾客名称和相关订单号「内连接inner-join」"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_96-返回顾客名称和相关订单号「内连接inner-join」"}},[s._v("#")]),s._v(" 96."),e("a",{attrs:{href:"https://www.nowcoder.com/practice/7e7bc361db6a4cb6aa35eefccfe75364?tpId=298&tqId=2374696&ru=/exam/oj&qru=/ta/sql-teach-yourself/question-ranking&sourceUrl=%2Fexam%2Foj%3Fpage%3D1%26tab%3DSQL%25E7%25AF%2587%26topicId%3D298",target:"_blank",rel:"noopener noreferrer"}},[s._v("返回顾客名称和相关订单号"),e("OutboundLink")],1),s._v("「内连接inner join」")]),s._v(" "),e("p",[s._v("内连接又称"),e("strong",[s._v("等值连接")]),s._v("，使用 INNER JOIN 关键字。")]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    cust_name, order_num\nfrom\n    Customers\n    inner join \n    Orders \n    using (cust_id) #这里用using， 其实等价on，然后两边的相等\norder by\n    cust_name, order_num\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    cust_name, order_num\nfrom\n    Customers\n    inner join \n    Orders \n    on Customers.cust_id=Orders.cust_id\norder by\n    cust_name, order_num\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("ul",[e("li",[e("strong",[s._v("可以不明确使用 INNER JOIN")]),s._v("，而使用普通查询并在 WHERE 中将两个表中要连接的列用等值方法连接起来")])]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    cust_name, order_num\nfrom\n    Customers, Orders \nwhere Customers.cust_id=Orders.cust_id\norder by\n    cust_name, order_num\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("h4",{attrs:{id:"_97-返回顾客名称和相关订单号以及每个订单的总价⭐️「多个inner-join」"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_97-返回顾客名称和相关订单号以及每个订单的总价⭐️「多个inner-join」"}},[s._v("#")]),s._v(" 97."),e("a",{attrs:{href:"https://www.nowcoder.com/practice/4dda66e385c443d8a11570a70807d250?tpId=298&tags=&title=&difficulty=0&judgeStatus=0&rp=0&sourceUrl=%2Fexam%2Foj%3Fpage%3D1%26tab%3DSQL%25E7%25AF%2587%26topicId%3D298",target:"_blank",rel:"noopener noreferrer"}},[s._v("返回顾客名称和相关订单号以及每个订单的总价"),e("OutboundLink")],1),s._v("⭐️「多个inner join」")]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select Customers.cust_name, Orders.order_num, \n    OrderItems.quantity * OrderItems.item_price as OrderTotal\nfrom Customers , Orders  , OrderItems\nwhere \n    Customers.cust_id=Orders.cust_id\nand\n    Orders.order_num=OrderItems.order_num\norder by Customers.cust_name asc;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("ul",[e("li",[s._v("inner join⭐️")])]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    Customers.cust_name,\n    Orders.order_num,\n    OrderItems.quantity * OrderItems.item_price as OrderTotal\nfrom\n    Customers\n    inner join Orders on Customers.cust_id = Orders.cust_id  #⭐️\n    inner join OrderItems on Orders.order_num = OrderItems.order_num  #⭐️多个inner join的写法\norder by\n    Customers.cust_name asc;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("h4",{attrs:{id:"_98-确定哪些订单购买了-prod-id-为-br01-的产品-二"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_98-确定哪些订单购买了-prod-id-为-br01-的产品-二"}},[s._v("#")]),s._v(" 98."),e("a",{attrs:{href:"https://www.nowcoder.com/practice/999aa31a9a504c60baa088d90d82e64d?tpId=298&tags=&title=&difficulty=0&judgeStatus=0&rp=0&sourceUrl=%2Fexam%2Foj%3Fpage%3D1%26tab%3DSQL%25E7%25AF%2587%26topicId%3D298",target:"_blank",rel:"noopener noreferrer"}},[s._v("确定哪些订单购买了 prod_id 为 BR01 的产品"),e("OutboundLink")],1),s._v("（二）")]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    cust_id,\n    order_date\nfrom\n    Orders\nwhere\n    order_num in (\n        select\n            order_num\n        from\n            OrderItems\n        where\n            prod_id = 'BR01'\n    )\norder by\n    order_date\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br")])]),e("h4",{attrs:{id:"_99-返回购买-prod-id-为-br01-的产品的所有顾客的电子邮件-二"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_99-返回购买-prod-id-为-br01-的产品的所有顾客的电子邮件-二"}},[s._v("#")]),s._v(" 99."),e("a",{attrs:{href:"https://www.nowcoder.com/practice/c7aa73afc41f4dfc925baebdd175c345?tpId=298&tags=&title=&difficulty=0&judgeStatus=0&rp=0&sourceUrl=%2Fexam%2Foj%3Fpage%3D1%26tab%3DSQL%25E7%25AF%2587%26topicId%3D298",target:"_blank",rel:"noopener noreferrer"}},[s._v("返回购买 prod_id 为 BR01 的产品的所有顾客的电子邮件"),e("OutboundLink")],1),s._v("（二）")]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code")]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"})]),e("h4",{attrs:{id:"_100-确定最佳顾客的另一种方式-二"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_100-确定最佳顾客的另一种方式-二"}},[s._v("#")]),s._v(" 100."),e("a",{attrs:{href:"https://www.nowcoder.com/practice/b5766f970ae64ac7944f37f5b47107aa?tpId=298&tags=&title=&difficulty=0&judgeStatus=0&rp=0&sourceUrl=%2Fexam%2Foj%3Fpage%3D1%26tab%3DSQL%25E7%25AF%2587%26topicId%3D298",target:"_blank",rel:"noopener noreferrer"}},[s._v("确定最佳顾客的另一种方式"),e("OutboundLink")],1),s._v("（二）")]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select distinct\n    Customers.cust_name,\n    sum(OrderItems.item_price * OrderItems.quantity) as total_price\nfrom\n    Orders\n    inner join OrderItems on Orders.order_num = OrderItems.order_num #⭐️\n    inner join Customers on Orders.cust_id = Customers.cust_id #⭐️多个inner join的写法\ngroup by\n    Customers.cust_name\nhaving\n    sum(OrderItems.item_price * OrderItems.quantity) >= 1000\norder by\n    total_price\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br")])]),e("h3",{attrs:{id:"_12-⭐️创建高级联结"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_12-⭐️创建高级联结"}},[s._v("#")]),s._v(" 12.⭐️创建高级联结")]),s._v(" "),e("h4",{attrs:{id:"_101-检索每个顾客的名称和所有的订单号-一"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_101-检索每个顾客的名称和所有的订单号-一"}},[s._v("#")]),s._v(" 101."),e("a",{attrs:{href:"https://www.nowcoder.com/practice/0a876520bd314505b787648e331f5e81?tpId=298&tags=&title=&difficulty=0&judgeStatus=0&rp=0&sourceUrl=%2Fexam%2Foj%3Fpage%3D1%26tab%3DSQL%25E7%25AF%2587%26topicId%3D298",target:"_blank",rel:"noopener noreferrer"}},[s._v("检索每个顾客的名称和所有的订单号"),e("OutboundLink")],1),s._v("（一）")]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select C.cust_name,O.order_num\n    from Customers C \n    inner join Orders O on O.cust_id=C.cust_id\n    order by C.cust_name\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h4",{attrs:{id:"_102-检索每个顾客的名称和所有的订单号-二"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_102-检索每个顾客的名称和所有的订单号-二"}},[s._v("#")]),s._v(" 102."),e("a",{attrs:{href:"https://www.nowcoder.com/practice/4e73c4e770b941c9abc60814601ed498?tpId=298&tags=&title=&difficulty=0&judgeStatus=0&rp=0&sourceUrl=%2Fexam%2Foj%3Fpage%3D1%26tab%3DSQL%25E7%25AF%2587%26topicId%3D298",target:"_blank",rel:"noopener noreferrer"}},[s._v("检索每个顾客的名称和所有的订单号"),e("OutboundLink")],1),s._v("（二）")]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("SELECT\n    cust_name,\n    order_num\nFROM\n    Customers\n    LEFT JOIN Orders USING (cust_id)\nOrder by\n    cust_name\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h4",{attrs:{id:"_103-返回产品名称和与之相关的订单号"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_103-返回产品名称和与之相关的订单号"}},[s._v("#")]),s._v(" 103."),e("a",{attrs:{href:"https://www.nowcoder.com/practice/c369a759436a4e8b80baa9c39e9adf18?tpId=298&tags=&title=&difficulty=0&judgeStatus=0&rp=0&sourceUrl=%2Fexam%2Foj%3Fpage%3D1%26tab%3DSQL%25E7%25AF%2587%26topicId%3D298",target:"_blank",rel:"noopener noreferrer"}},[s._v("返回产品名称和与之相关的订单号"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    Products.prod_name,\n    OrderItems.order_num\nfrom\n    Products\n    left join OrderItems on Products.prod_id = OrderItems.prod_id\norder by\n    1 asc; #等价于，我们选出来的第1列排序，即Products.prod_name asc;\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h4",{attrs:{id:"_104-返回产品名称和每一项产品的总订单数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_104-返回产品名称和每一项产品的总订单数"}},[s._v("#")]),s._v(" 104."),e("a",{attrs:{href:"https://www.nowcoder.com/practice/1c64fd9048364a58a8ffa541720359a4?tpId=298&tags=&title=&difficulty=0&judgeStatus=0&rp=0&sourceUrl=%2Fexam%2Foj%3Fpage%3D1%26tab%3DSQL%25E7%25AF%2587%26topicId%3D298",target:"_blank",rel:"noopener noreferrer"}},[s._v("返回产品名称和每一项产品的总订单数"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    prod_name,\n    count(order_num) as orders\nfrom\n    Products\n    left join OrderItems using (prod_id)\ngroup by\n    prod_name\norder by\n    prod_name\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])]),e("h4",{attrs:{id:"_105-列出供应商及其可供产品的数量"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_105-列出供应商及其可供产品的数量"}},[s._v("#")]),s._v(" 105."),e("a",{attrs:{href:"https://www.nowcoder.com/practice/17f22851cf204019b51a36761a3afc79?tpId=298&tags=&title=&difficulty=0&judgeStatus=0&rp=0&sourceUrl=%2Fexam%2Foj%3Fpage%3D1%26tab%3DSQL%25E7%25AF%2587%26topicId%3D298",target:"_blank",rel:"noopener noreferrer"}},[s._v("列出供应商及其可供产品的数量"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    a.vend_id,\n    count(b.prod_id) prod_id\nfrom\n    Vendors a\n    left join Products b using (vend_id)\ngroup by\n    a.vend_id\norder by\n    a.vend_id asc\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("h3",{attrs:{id:"_13-组合查询「union」"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_13-组合查询「union」"}},[s._v("#")]),s._v(" 13.组合查询「union」")]),s._v(" "),e("h4",{attrs:{id:"_106-将两个-select-语句结合起来-一-「easy」⭐️"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_106-将两个-select-语句结合起来-一-「easy」⭐️"}},[s._v("#")]),s._v(" 106."),e("a",{attrs:{href:"https://www.nowcoder.com/practice/a33d5c0ebf434e00b22e2977a5aa3a90?tpId=298&tags=&title=&difficulty=0&judgeStatus=0&rp=0&sourceUrl=%2Fexam%2Foj%3Fpage%3D1%26tab%3DSQL%25E7%25AF%2587%26topicId%3D298",target:"_blank",rel:"noopener noreferrer"}},[s._v("将两个 SELECT 语句结合起来"),e("OutboundLink")],1),s._v("(一)「easy」⭐️")]),s._v(" "),e("p",[s._v("最后按产品 id 对结果进行升序排序。")]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n  prod_id, quantity\nfrom\n  OrderItems\nwhere\n  quantity = 100\n\nunion\n\nselect\n  prod_id, quantity\nfrom\n  OrderItems\nwhere\n  prod_id like 'BNBG%';\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br")])]),e("h4",{attrs:{id:"_107-将两个-select-语句结合起来-2-easy"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_107-将两个-select-语句结合起来-2-easy"}},[s._v("#")]),s._v(" 107."),e("a",{attrs:{href:"https://www.nowcoder.com/practice/ee9ef82f3d6f44b398aedc2fa71db612?tpId=298&tags=&title=&difficulty=0&judgeStatus=0&rp=0&sourceUrl=%2Fexam%2Foj%3Fpage%3D1%26tab%3DSQL%25E7%25AF%2587%26topicId%3D298",target:"_blank",rel:"noopener noreferrer"}},[s._v("将两个 SELECT 语句结合起来"),e("OutboundLink")],1),s._v("(2)easy")]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select * from OrderItems \nwhere prod_id like 'BNBG%' \nunion \nselect * from OrderItems \nwhere quantity=100 order by prod_id\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("ul",[e("li",[s._v("等价的")])]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select prod_id, quantity\nfrom OrderItems\n where quantity=100\nor prod_id like 'BNBG%'\norder by prod_id\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h4",{attrs:{id:"_108-组合-products-表中的产品名称和-customers-表中的顾客名称「mid」⭐️"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_108-组合-products-表中的产品名称和-customers-表中的顾客名称「mid」⭐️"}},[s._v("#")]),s._v(" 108."),e("a",{attrs:{href:"https://www.nowcoder.com/practice/461077c0ba0f473abecf5ee79c632acd?tpId=298&tags=&title=&difficulty=0&judgeStatus=0&rp=0&sourceUrl=%2Fexam%2Foj%3Fpage%3D1%26tab%3DSQL%25E7%25AF%2587%26topicId%3D298",target:"_blank",rel:"noopener noreferrer"}},[s._v("组合 Products 表中的产品名称和 Customers 表中的顾客名称"),e("OutboundLink")],1),s._v("「mid」⭐️")]),s._v(" "),e("p",[s._v("拼接"),e("strong",[s._v("cust_name")]),s._v("和"),e("strong",[s._v("prod_name")]),s._v("并根据结果升序排序")]),s._v(" "),e("ul",[e("li",[s._v("==Tips:「默认会去除相同行」，如果需要保留相同行，使用 union all==")])]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    prod_name\nfrom\n    Products\nunion all   #核心\nselect\n    cust_name\nfrom\n    Customers\norder by\n    prod_name\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])]),e("h4",{attrs:{id:"_109-纠错4easy"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_109-纠错4easy"}},[s._v("#")]),s._v(" 109."),e("a",{attrs:{href:"https://www.nowcoder.com/practice/bde1451b91084c8cab467387a0e0969c?tpId=298&tags=&title=&difficulty=0&judgeStatus=0&rp=0&sourceUrl=%2Fexam%2Foj%3Fpage%3D1%26tab%3DSQL%25E7%25AF%2587%26topicId%3D298",target:"_blank",rel:"noopener noreferrer"}},[s._v("纠错4"),e("OutboundLink")],1),s._v("easy")]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("SELECT cust_name, cust_contact, cust_email \nFROM Customers \nWHERE cust_state = 'MI' \n\nUNION \nSELECT cust_name, cust_contact, cust_email \nFROM Customers \nWHERE cust_state = 'IL'\nORDER BY cust_name;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("ul",[e("li",[s._v("等价的")])]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("SELECT\n    cust_name,\n    cust_contact,\n    cust_email\nFROM\n    Customers\nWHERE\n    cust_state = 'MI'\n    OR cust_state = 'IL'\nORDER BY\n    cust_name;\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br")])]),e("h2",{attrs:{id:"⭐️总结记忆⭐️"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#⭐️总结记忆⭐️"}},[s._v("#")]),s._v(" ⭐️总结记忆⭐️")]),s._v(" "),e("ul",[e("li",[s._v("distinct(XXX)去重某列")]),s._v(" "),e("li",[s._v("从小到大，正序，asc")]),s._v(" "),e("li",[s._v("从大到小，逆序，desc")])]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('- 1内连接\n  - 内连接（等值连接）AAA inner BBB  XX on\n    -自连接，自连接可以看成内连接的一种，只是连接的表是自身而已。，\n    「employee」 AS e1 INNER JOIN 「employee」 AS e2 ON e1.department = e2.department AND e2.name = "Jim";\n    \n    内连接和自然连接的区别：内连接提供连接的列，而自然连接自动连接所有同名列。\n    \n- 2\\自然连接\n  - aaa AS A natural join bbb AS B;\n  \n- 3\\外连接  外连接保留了没有关联的那些行（OUTER JOIN）\n  左外连接 Customers left outer join Orders on Customers.cust_id = Orders.cust_id\n  \t左外连接就是保留左表没有关联的行\n  右外连接 RIGHT  OUTER  JOIN\n  全外连接 FULL OUTER JOIN\n\n- 4\\组合查询,,,使用 UNION 来组合两个查询，如果第一个查询返回 M 行，第二个查询返回 N 行，那么组合查询的结果一般为\nM+N 行\n\t1\\「每个查询」「必须」包含相同的列、表达式和聚集函数。\n\t2、「默认会去除相同行」，如果需要保留相同行，使用 union all\n\t3\\只能包含一个 ORDER BY 子句，并且必须位于语句的最后。\n\tSELECT col FROM mytable WHERE col = 1\nUNION SELECT col FROM mytable WHERE col =2;\n\n= 5\\交叉连接（CROSS JOIN）：有两种，显式的和隐式的\n\n\n显式的交叉连接，使用CROSS JOIN。\nSELECT O.ID, O.ORDER_NUMBER, C.ID,\nC.NAME\nFROM ORDERS as O \ncross join\nCUSTOMERS as C\nWHERE O.ID=1;\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br")])]),e("h2",{attrs:{id:"sql大厂面试真题"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#sql大厂面试真题"}},[s._v("#")]),s._v(" SQL大厂面试真题")]),s._v(" "),e("ul",[e("li",[s._v("链接："),e("a",{attrs:{href:"https://www.nowcoder.com/exam/oj?page=1&tab=SQL%E7%AF%87&topicId=268",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.nowcoder.com/exam/oj?page=1&tab=SQL%E7%AF%87&topicId=268"),e("OutboundLink")],1)])]),s._v(" "),e("h3",{attrs:{id:"_1-某音短视频"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-某音短视频"}},[s._v("#")]),s._v(" 1.某音短视频")]),s._v(" "),e("h4",{attrs:{id:"_156-各个视频的平均完播率"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_156-各个视频的平均完播率"}},[s._v("#")]),s._v(" 156 各个视频的平均完播率")]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    a.video_id,\n    round(\n        sum(\n            case\n                when timestampdiff (second, b.start_time, b.end_time) >= a.duration then 1\n                else 0\n            end\n        ) / count(b.uid),\n        3\n    ) as avg_com_play_rate\nfrom\n    tb_video_info a\n    join tb_user_video_log b on a.video_id = b.video_id\nwhere\n    YEAR (b.start_time) = 2021\ngroup by\n    a.video_id\norder by\n    avg_com_play_rate desc\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br")])]),e("h3",{attrs:{id:"_2-用户增长场景-某度信息流"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-用户增长场景-某度信息流"}},[s._v("#")]),s._v(" 2.用户增长场景（某度信息流）")]),s._v(" "),e("h3",{attrs:{id:"_3-电商场景-某东商城"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-电商场景-某东商城"}},[s._v("#")]),s._v(" 3.电商场景（某东商城）")]),s._v(" "),e("h3",{attrs:{id:"_4-出行场景-某滴打车"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-出行场景-某滴打车"}},[s._v("#")]),s._v(" 4.出行场景（某滴打车）")]),s._v(" "),e("h3",{attrs:{id:"_5-某宝店铺分析-电商模式"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-某宝店铺分析-电商模式"}},[s._v("#")]),s._v(" 5.某宝店铺分析（电商模式）")]),s._v(" "),e("h3",{attrs:{id:"_6-牛客直播课分析-在线教育行业"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-牛客直播课分析-在线教育行业"}},[s._v("#")]),s._v(" 6.牛客直播课分析（在线教育行业）")]),s._v(" "),e("h3",{attrs:{id:"_7-某乎问答-内容行业"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_7-某乎问答-内容行业"}},[s._v("#")]),s._v(" 7.某乎问答（内容行业）")]),s._v(" "),e("h4",{attrs:{id:"_190-某乎问答11月份日人均回答量"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_190-某乎问答11月份日人均回答量"}},[s._v("#")]),s._v(" 190 某乎问答11月份日人均回答量")]),s._v(" "),e("h4",{attrs:{id:"_191-某乎问答高质量的回答中用户属于各级别的数量"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_191-某乎问答高质量的回答中用户属于各级别的数量"}},[s._v("#")]),s._v(" 191 某乎问答高质量的回答中用户属于各级别的数量")]),s._v(" "),e("h4",{attrs:{id:"_192-某乎问答单日回答问题数大于等于3个的所有用户"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_192-某乎问答单日回答问题数大于等于3个的所有用户"}},[s._v("#")]),s._v(" 192 某乎问答单日回答问题数大于等于3个的所有用户")]),s._v(" "),e("h4",{attrs:{id:"_193-某乎问答回答过教育类问题的用户里有多少用户回答过"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_193-某乎问答回答过教育类问题的用户里有多少用户回答过"}},[s._v("#")]),s._v(" 193 某乎问答回答过教育类问题的用户里有多少用户回答过")]),s._v(" "),e("h4",{attrs:{id:"_194-某乎问答最大连续回答问题天数大于等于3天的用户及其对应等级"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_194-某乎问答最大连续回答问题天数大于等于3天的用户及其对应等级"}},[s._v("#")]),s._v(" 194.某乎问答最大连续回答问题天数大于等于3天的用户及其对应等级")]),s._v(" "),e("h2",{attrs:{id:"面试"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#面试"}},[s._v("#")]),s._v(" 面试")]),s._v(" "),e("p",[s._v("查询选课门数超过2门的学生的平均成绩和选课门数。")]),s._v(" "),e("p",[s._v("数据库中有三张表，student学生表、course选课表、sc成绩表。")]),s._v(" "),e("p",[s._v("Cno（课程号）,Cname,hours,Sno（学号）")]),s._v(" "),e("div",{staticClass:"language-mysql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("select\n    student.Sname, avg(sc.grade),  #\n    count(sc.cno)  #选课门数，count，sc\nfrom\n    student,\n    sc\nwhere\n    student.sno = sc.sno\ngroup by\n    student.Sname\nhaving\n    count(sc.cno) > 2\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br")])]),e("h2",{attrs:{id:"参考资料"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#参考资料"}},[s._v("#")]),s._v(" 参考资料")]),s._v(" "),e("ul",[e("li",[s._v("《SQL必知必会》\n"),e("ul",[e("li",[s._v("还有人整理了：CyC2018的"),e("a",{attrs:{href:"http://www.cyc2018.xyz/%E6%95%B0%E6%8D%AE%E5%BA%93/SQL%20%E8%AF%AD%E6%B3%95.html#%E4%B8%80%E3%80%81%E5%9F%BA%E7%A1%80",target:"_blank",rel:"noopener noreferrer"}},[s._v("SQL语法"),e("OutboundLink")],1)])])]),s._v(" "),e("li",[s._v("《MySQL必知必会》")]),s._v(" "),e("li",[e("a",{attrs:{href:"https://www.liaoxuefeng.com/wiki/1177760294764384",target:"_blank",rel:"noopener noreferrer"}},[s._v("廖雪峰的SQL"),e("OutboundLink")],1)]),s._v(" "),e("li",[e("a",{attrs:{href:"http://www.xuesql.cn/",target:"_blank",rel:"noopener noreferrer"}},[s._v("自学SQL网，站点"),e("OutboundLink")],1),s._v("『有实践题』")]),s._v(" "),e("li",[s._v("知乎上关于"),e("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/92590262",target:"_blank",rel:"noopener noreferrer"}},[s._v("SQL练习的平台"),e("OutboundLink")],1)]),s._v(" "),e("li",[s._v("阿里巴巴，SQL代码"),e("a",{attrs:{href:"https://help.aliyun.com/document_detail/137491.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("编码原则和规范"),e("OutboundLink")],1),s._v(" "),e("ul",[e("li",[s._v("恒生电子，SQL编码规范2020")])])])])])}),[],!1,null,null,null);e.default=t.exports}}]);