<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>力扣MySQL题解 | whoway</title>
    <meta name="generator" content="VuePress 1.9.8">
    <link rel="icon" href="/images/photo.jpg">
    <link rel="manifest" href="/images/photo.jpg">
    <link rel="apple-touch-icon" href="/images/photo.jpg">
    <meta name="description" content="Personal Blog Website">
    <meta http-quiv="pragma" cotent="no-cache">
    <meta http-quiv="pragma" cotent="no-cache,must-revalidate">
    <meta http-quiv="expires" cotent="0">
    
    <link rel="preload" href="/assets/css/0.styles.d6ad21ed.css" as="style"><link rel="preload" href="/assets/js/app.f067657d.js" as="script"><link rel="preload" href="/assets/js/2.e96ccaa8.js" as="script"><link rel="preload" href="/assets/js/119.17d4a5ea.js" as="script"><link rel="prefetch" href="/assets/js/10.c8c3a1b6.js"><link rel="prefetch" href="/assets/js/100.0575457e.js"><link rel="prefetch" href="/assets/js/101.8c99eb23.js"><link rel="prefetch" href="/assets/js/102.a4f4d152.js"><link rel="prefetch" href="/assets/js/103.e77c9468.js"><link rel="prefetch" href="/assets/js/104.364a42ad.js"><link rel="prefetch" href="/assets/js/105.c5d628c1.js"><link rel="prefetch" href="/assets/js/106.22a62c30.js"><link rel="prefetch" href="/assets/js/107.406ca73b.js"><link rel="prefetch" href="/assets/js/108.b9523d44.js"><link rel="prefetch" href="/assets/js/109.905b7c90.js"><link rel="prefetch" href="/assets/js/11.8cb18de6.js"><link rel="prefetch" href="/assets/js/110.5c6a1fec.js"><link rel="prefetch" href="/assets/js/111.76bba02d.js"><link rel="prefetch" href="/assets/js/112.80f2c586.js"><link rel="prefetch" href="/assets/js/113.20797238.js"><link rel="prefetch" href="/assets/js/114.bef872ba.js"><link rel="prefetch" href="/assets/js/115.9baa49eb.js"><link rel="prefetch" href="/assets/js/116.84fd75de.js"><link rel="prefetch" href="/assets/js/117.cfdafa82.js"><link rel="prefetch" href="/assets/js/118.3924c15b.js"><link rel="prefetch" href="/assets/js/12.d05531b6.js"><link rel="prefetch" href="/assets/js/120.753c8d9d.js"><link rel="prefetch" href="/assets/js/121.2c688707.js"><link rel="prefetch" href="/assets/js/122.50ee2490.js"><link rel="prefetch" href="/assets/js/123.149a52be.js"><link rel="prefetch" href="/assets/js/124.e7bc5939.js"><link rel="prefetch" href="/assets/js/125.26129339.js"><link rel="prefetch" href="/assets/js/126.d4a6358c.js"><link rel="prefetch" href="/assets/js/127.71691e59.js"><link rel="prefetch" href="/assets/js/128.15ee1518.js"><link rel="prefetch" href="/assets/js/129.2b45b28c.js"><link rel="prefetch" href="/assets/js/13.bac79687.js"><link rel="prefetch" href="/assets/js/130.590883c0.js"><link rel="prefetch" href="/assets/js/131.7b069233.js"><link rel="prefetch" href="/assets/js/132.9dacb552.js"><link rel="prefetch" href="/assets/js/133.bae3fbd2.js"><link rel="prefetch" href="/assets/js/134.d3af2905.js"><link rel="prefetch" href="/assets/js/135.37c71acd.js"><link rel="prefetch" href="/assets/js/136.64545888.js"><link rel="prefetch" href="/assets/js/137.1595d1a4.js"><link rel="prefetch" href="/assets/js/138.218cea4a.js"><link rel="prefetch" href="/assets/js/139.24acd4ea.js"><link rel="prefetch" href="/assets/js/14.fb288120.js"><link rel="prefetch" href="/assets/js/140.6e00edc4.js"><link rel="prefetch" href="/assets/js/141.94de1e2e.js"><link rel="prefetch" href="/assets/js/142.612b07ea.js"><link rel="prefetch" href="/assets/js/143.de43ccac.js"><link rel="prefetch" href="/assets/js/144.2d59306e.js"><link rel="prefetch" href="/assets/js/145.50819385.js"><link rel="prefetch" href="/assets/js/146.57ce9160.js"><link rel="prefetch" href="/assets/js/147.7855abe7.js"><link rel="prefetch" href="/assets/js/148.100073ad.js"><link rel="prefetch" href="/assets/js/149.0d84d3b4.js"><link rel="prefetch" href="/assets/js/15.9718f572.js"><link rel="prefetch" href="/assets/js/150.9c4f0494.js"><link rel="prefetch" href="/assets/js/151.4d35844f.js"><link rel="prefetch" href="/assets/js/152.6dbad8e2.js"><link rel="prefetch" href="/assets/js/153.46992af8.js"><link rel="prefetch" href="/assets/js/154.23605669.js"><link rel="prefetch" href="/assets/js/155.78c803bb.js"><link rel="prefetch" href="/assets/js/156.1a7417f4.js"><link rel="prefetch" href="/assets/js/157.b4dc2e94.js"><link rel="prefetch" href="/assets/js/158.c4397399.js"><link rel="prefetch" href="/assets/js/159.184ce525.js"><link rel="prefetch" href="/assets/js/16.b8c3d228.js"><link rel="prefetch" href="/assets/js/160.c91df807.js"><link rel="prefetch" href="/assets/js/161.3a15d975.js"><link rel="prefetch" href="/assets/js/162.079fa560.js"><link rel="prefetch" href="/assets/js/163.4190a294.js"><link rel="prefetch" href="/assets/js/164.06ae721a.js"><link rel="prefetch" href="/assets/js/165.6a43482a.js"><link rel="prefetch" href="/assets/js/166.bb816dd8.js"><link rel="prefetch" href="/assets/js/167.7d10725e.js"><link rel="prefetch" href="/assets/js/168.b93a2024.js"><link rel="prefetch" href="/assets/js/169.7575fefd.js"><link rel="prefetch" href="/assets/js/17.e10530ad.js"><link rel="prefetch" href="/assets/js/170.4b044a75.js"><link rel="prefetch" href="/assets/js/171.5536a841.js"><link rel="prefetch" href="/assets/js/172.9b7146dc.js"><link rel="prefetch" href="/assets/js/173.1743e0fe.js"><link rel="prefetch" href="/assets/js/174.41d0d4c9.js"><link rel="prefetch" href="/assets/js/175.30bb1df8.js"><link rel="prefetch" href="/assets/js/176.a8785b08.js"><link rel="prefetch" href="/assets/js/177.3930e958.js"><link rel="prefetch" href="/assets/js/178.b3edc015.js"><link rel="prefetch" href="/assets/js/179.43d1c02c.js"><link rel="prefetch" href="/assets/js/18.6c6b01f3.js"><link rel="prefetch" href="/assets/js/180.cc4aab8b.js"><link rel="prefetch" href="/assets/js/181.b311473b.js"><link rel="prefetch" href="/assets/js/182.6e665375.js"><link rel="prefetch" href="/assets/js/183.adf21bbb.js"><link rel="prefetch" href="/assets/js/184.4508c528.js"><link rel="prefetch" href="/assets/js/185.4504b7ec.js"><link rel="prefetch" href="/assets/js/186.6f3e405b.js"><link rel="prefetch" href="/assets/js/187.fe0eb552.js"><link rel="prefetch" href="/assets/js/188.aaafa916.js"><link rel="prefetch" href="/assets/js/189.e92c7916.js"><link rel="prefetch" href="/assets/js/19.cfaa6f29.js"><link rel="prefetch" href="/assets/js/190.9f2dc012.js"><link rel="prefetch" href="/assets/js/191.aa5ba0fd.js"><link rel="prefetch" href="/assets/js/192.4ce3ecdb.js"><link rel="prefetch" href="/assets/js/193.f5344a9b.js"><link rel="prefetch" href="/assets/js/194.c0ae7c2b.js"><link rel="prefetch" href="/assets/js/195.10fd4615.js"><link rel="prefetch" href="/assets/js/196.7aa2bce6.js"><link rel="prefetch" href="/assets/js/197.0ef4e530.js"><link rel="prefetch" href="/assets/js/198.3f09fce3.js"><link rel="prefetch" href="/assets/js/199.c982eeaf.js"><link rel="prefetch" href="/assets/js/20.985050a9.js"><link rel="prefetch" href="/assets/js/200.a66f4947.js"><link rel="prefetch" href="/assets/js/201.5f1e6cff.js"><link rel="prefetch" href="/assets/js/202.dfd53d6d.js"><link rel="prefetch" href="/assets/js/203.d476978d.js"><link rel="prefetch" href="/assets/js/204.2885cc85.js"><link rel="prefetch" href="/assets/js/205.d87c1ea9.js"><link rel="prefetch" href="/assets/js/206.5c12c82b.js"><link rel="prefetch" href="/assets/js/207.6ffebe20.js"><link rel="prefetch" href="/assets/js/208.f0f69d06.js"><link rel="prefetch" href="/assets/js/209.34875bb4.js"><link rel="prefetch" href="/assets/js/21.983111a2.js"><link rel="prefetch" href="/assets/js/210.d9216e67.js"><link rel="prefetch" href="/assets/js/211.e04b9ab4.js"><link rel="prefetch" href="/assets/js/212.10f4ea48.js"><link rel="prefetch" href="/assets/js/213.e5b17ec0.js"><link rel="prefetch" href="/assets/js/214.1ada0f12.js"><link rel="prefetch" href="/assets/js/215.3765292a.js"><link rel="prefetch" href="/assets/js/216.a556da8b.js"><link rel="prefetch" href="/assets/js/22.38e1ece2.js"><link rel="prefetch" href="/assets/js/23.22338533.js"><link rel="prefetch" href="/assets/js/24.ab17d554.js"><link rel="prefetch" href="/assets/js/25.d25f62a8.js"><link rel="prefetch" href="/assets/js/26.f6465387.js"><link rel="prefetch" href="/assets/js/27.6986aad8.js"><link rel="prefetch" href="/assets/js/28.fb3a68af.js"><link rel="prefetch" href="/assets/js/29.614cacaa.js"><link rel="prefetch" href="/assets/js/3.71cf2de6.js"><link rel="prefetch" href="/assets/js/30.abf429d1.js"><link rel="prefetch" href="/assets/js/31.fb3bbd86.js"><link rel="prefetch" href="/assets/js/32.5e607d3e.js"><link rel="prefetch" href="/assets/js/33.00cc97d8.js"><link rel="prefetch" href="/assets/js/34.de079634.js"><link rel="prefetch" href="/assets/js/35.c1160378.js"><link rel="prefetch" href="/assets/js/36.bb03a18f.js"><link rel="prefetch" href="/assets/js/37.94ad71b0.js"><link rel="prefetch" href="/assets/js/38.aa30304e.js"><link rel="prefetch" href="/assets/js/39.1edd0325.js"><link rel="prefetch" href="/assets/js/4.ef1b1e27.js"><link rel="prefetch" href="/assets/js/40.e575d119.js"><link rel="prefetch" href="/assets/js/41.e7757193.js"><link rel="prefetch" href="/assets/js/42.42efef3a.js"><link rel="prefetch" href="/assets/js/43.d2024176.js"><link rel="prefetch" href="/assets/js/44.3664f2f5.js"><link rel="prefetch" href="/assets/js/45.35b23294.js"><link rel="prefetch" href="/assets/js/46.d433a0bb.js"><link rel="prefetch" href="/assets/js/47.69303503.js"><link rel="prefetch" href="/assets/js/48.ccab8678.js"><link rel="prefetch" href="/assets/js/49.310b94fd.js"><link rel="prefetch" href="/assets/js/5.6260a1a4.js"><link rel="prefetch" href="/assets/js/50.fdd787dc.js"><link rel="prefetch" href="/assets/js/51.378c30f1.js"><link rel="prefetch" href="/assets/js/52.99b25085.js"><link rel="prefetch" href="/assets/js/53.3eedc5ee.js"><link rel="prefetch" href="/assets/js/54.cd48cc73.js"><link rel="prefetch" href="/assets/js/55.775dcbc9.js"><link rel="prefetch" href="/assets/js/56.65bc64c3.js"><link rel="prefetch" href="/assets/js/57.0d5f8f83.js"><link rel="prefetch" href="/assets/js/58.3fa727b0.js"><link rel="prefetch" href="/assets/js/59.4be88bf9.js"><link rel="prefetch" href="/assets/js/6.9f0491ef.js"><link rel="prefetch" href="/assets/js/60.cc0fa88d.js"><link rel="prefetch" href="/assets/js/61.33acc2f0.js"><link rel="prefetch" href="/assets/js/62.6e7bb7ac.js"><link rel="prefetch" href="/assets/js/63.7740fed4.js"><link rel="prefetch" href="/assets/js/64.94f2dc41.js"><link rel="prefetch" href="/assets/js/65.68a45fcc.js"><link rel="prefetch" href="/assets/js/66.7ee3b977.js"><link rel="prefetch" href="/assets/js/67.ec9a21bf.js"><link rel="prefetch" href="/assets/js/68.f857f48a.js"><link rel="prefetch" href="/assets/js/69.24862f3f.js"><link rel="prefetch" href="/assets/js/7.7878af64.js"><link rel="prefetch" href="/assets/js/70.ac682f3f.js"><link rel="prefetch" href="/assets/js/71.06d8e456.js"><link rel="prefetch" href="/assets/js/72.067b39c0.js"><link rel="prefetch" href="/assets/js/73.e9955da6.js"><link rel="prefetch" href="/assets/js/74.9f3853e7.js"><link rel="prefetch" href="/assets/js/75.3f84828d.js"><link rel="prefetch" href="/assets/js/76.2cb08c83.js"><link rel="prefetch" href="/assets/js/77.44bd6203.js"><link rel="prefetch" href="/assets/js/78.372242ea.js"><link rel="prefetch" href="/assets/js/79.cb10d40e.js"><link rel="prefetch" href="/assets/js/8.339d4eff.js"><link rel="prefetch" href="/assets/js/80.1ccc8d8a.js"><link rel="prefetch" href="/assets/js/81.0298b9ba.js"><link rel="prefetch" href="/assets/js/82.8a8a13eb.js"><link rel="prefetch" href="/assets/js/83.ca549b7f.js"><link rel="prefetch" href="/assets/js/84.595d6fe1.js"><link rel="prefetch" href="/assets/js/85.7394fe4f.js"><link rel="prefetch" href="/assets/js/86.bfac6064.js"><link rel="prefetch" href="/assets/js/87.aa9c9594.js"><link rel="prefetch" href="/assets/js/88.a5280591.js"><link rel="prefetch" href="/assets/js/89.6b9adaa5.js"><link rel="prefetch" href="/assets/js/9.37e757bd.js"><link rel="prefetch" href="/assets/js/90.9b379b68.js"><link rel="prefetch" href="/assets/js/91.1dee4d2a.js"><link rel="prefetch" href="/assets/js/92.6a3889fd.js"><link rel="prefetch" href="/assets/js/93.74ba75c4.js"><link rel="prefetch" href="/assets/js/94.22503356.js"><link rel="prefetch" href="/assets/js/95.772e7662.js"><link rel="prefetch" href="/assets/js/96.c42ec5e2.js"><link rel="prefetch" href="/assets/js/97.42fd937e.js"><link rel="prefetch" href="/assets/js/98.2d4b19be.js"><link rel="prefetch" href="/assets/js/99.d206c5a1.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d6ad21ed.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">whoway</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="🎓Coding" class="dropdown-title"><span class="title">🎓Coding</span> <span class="arrow down"></span></button> <button type="button" aria-label="🎓Coding" class="mobile-dropdown-title"><span class="title">🎓Coding</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/00.Coding/TheBeautyOfProgramming/" class="nav-link">
  🔖编程之美题解
</a></li><li class="dropdown-item"><!----> <a href="/00.Coding/CodeWarehouse/" class="nav-link">
  🔖代码意识流
</a></li><li class="dropdown-item"><!----> <a href="/00.Coding/" class="nav-link">
  🔖面试题题解
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="🚀语言" class="dropdown-title"><span class="title">🚀语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="🚀语言" class="mobile-dropdown-title"><span class="title">🚀语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/01.Language/Overview/" class="nav-link">
  🔖概述
</a></li><li class="dropdown-item"><!----> <a href="/01.Language/C/" class="nav-link">
  ⭐️C
</a></li><li class="dropdown-item"><!----> <a href="/01.Language/Cpp/" class="nav-link">
  🚀C++
</a></li><li class="dropdown-item"><!----> <a href="/01.Language/Java/" class="nav-link">
  ☕️Java
</a></li><li class="dropdown-item"><!----> <a href="/01.Language/Python/" class="nav-link">
  🧩Python3
</a></li><li class="dropdown-item"><!----> <a href="/01.Language/Fortran/" class="nav-link">
  🎲Fortran
</a></li><li class="dropdown-item"><!----> <a href="/01.Language/JavaScript/" class="nav-link">
  🎨JavaScript
</a></li></ul></div></div><div class="nav-item"><a href="/02.Hardware/" class="nav-link">
  ✔️硬件基础
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="⭐️软件基础" class="dropdown-title"><span class="title">⭐️软件基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="⭐️软件基础" class="mobile-dropdown-title"><span class="title">⭐️软件基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/03.Software/01.DataStructureAndAlgorithm/" class="nav-link">
  🐾数据结构和算法
</a></li><li class="dropdown-item"><!----> <a href="/03.Software/02.OS/" class="nav-link">
  💻操作系统
</a></li><li class="dropdown-item"><!----> <a href="/03.Software/03.Net/" class="nav-link">
  ☁️计算机网络
</a></li><li class="dropdown-item"><!----> <a href="/03.Software/04.Database/" class="nav-link router-link-active">
  🎨数据库
</a></li><li class="dropdown-item"><!----> <a href="/03.Software/05.SE/" class="nav-link">
  ✅软件工程
</a></li></ul></div></div><div class="nav-item"><a href="/04.PerformanceOpt/" class="nav-link">
  🔥性能调优
</a></div><div class="nav-item"><a href="/05.Engineer/" class="nav-link">
  🔖学术/工程
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="⚙️工具" class="dropdown-title"><span class="title">⚙️工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="⚙️工具" class="mobile-dropdown-title"><span class="title">⚙️工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/06.Tools/01.employment/" class="nav-link">
  🔖求职
</a></li><li class="dropdown-item"><!----> <a href="/06.Tools/02.efficiency/" class="nav-link">
  🚀效能
</a></li><li class="dropdown-item"><!----> <a href="/06.Tools/03.windows/" class="nav-link">
  ⚙️Windows
</a></li><li class="dropdown-item"><!----> <a href="/06.Tools/04.design/" class="nav-link">
  🧩设计
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/whoway" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="🎓Coding" class="dropdown-title"><span class="title">🎓Coding</span> <span class="arrow down"></span></button> <button type="button" aria-label="🎓Coding" class="mobile-dropdown-title"><span class="title">🎓Coding</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/00.Coding/TheBeautyOfProgramming/" class="nav-link">
  🔖编程之美题解
</a></li><li class="dropdown-item"><!----> <a href="/00.Coding/CodeWarehouse/" class="nav-link">
  🔖代码意识流
</a></li><li class="dropdown-item"><!----> <a href="/00.Coding/" class="nav-link">
  🔖面试题题解
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="🚀语言" class="dropdown-title"><span class="title">🚀语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="🚀语言" class="mobile-dropdown-title"><span class="title">🚀语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/01.Language/Overview/" class="nav-link">
  🔖概述
</a></li><li class="dropdown-item"><!----> <a href="/01.Language/C/" class="nav-link">
  ⭐️C
</a></li><li class="dropdown-item"><!----> <a href="/01.Language/Cpp/" class="nav-link">
  🚀C++
</a></li><li class="dropdown-item"><!----> <a href="/01.Language/Java/" class="nav-link">
  ☕️Java
</a></li><li class="dropdown-item"><!----> <a href="/01.Language/Python/" class="nav-link">
  🧩Python3
</a></li><li class="dropdown-item"><!----> <a href="/01.Language/Fortran/" class="nav-link">
  🎲Fortran
</a></li><li class="dropdown-item"><!----> <a href="/01.Language/JavaScript/" class="nav-link">
  🎨JavaScript
</a></li></ul></div></div><div class="nav-item"><a href="/02.Hardware/" class="nav-link">
  ✔️硬件基础
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="⭐️软件基础" class="dropdown-title"><span class="title">⭐️软件基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="⭐️软件基础" class="mobile-dropdown-title"><span class="title">⭐️软件基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/03.Software/01.DataStructureAndAlgorithm/" class="nav-link">
  🐾数据结构和算法
</a></li><li class="dropdown-item"><!----> <a href="/03.Software/02.OS/" class="nav-link">
  💻操作系统
</a></li><li class="dropdown-item"><!----> <a href="/03.Software/03.Net/" class="nav-link">
  ☁️计算机网络
</a></li><li class="dropdown-item"><!----> <a href="/03.Software/04.Database/" class="nav-link router-link-active">
  🎨数据库
</a></li><li class="dropdown-item"><!----> <a href="/03.Software/05.SE/" class="nav-link">
  ✅软件工程
</a></li></ul></div></div><div class="nav-item"><a href="/04.PerformanceOpt/" class="nav-link">
  🔥性能调优
</a></div><div class="nav-item"><a href="/05.Engineer/" class="nav-link">
  🔖学术/工程
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="⚙️工具" class="dropdown-title"><span class="title">⚙️工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="⚙️工具" class="mobile-dropdown-title"><span class="title">⚙️工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/06.Tools/01.employment/" class="nav-link">
  🔖求职
</a></li><li class="dropdown-item"><!----> <a href="/06.Tools/02.efficiency/" class="nav-link">
  🚀效能
</a></li><li class="dropdown-item"><!----> <a href="/06.Tools/03.windows/" class="nav-link">
  ⚙️Windows
</a></li><li class="dropdown-item"><!----> <a href="/06.Tools/04.design/" class="nav-link">
  🧩设计
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/whoway" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>力扣MySQL题解</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/03.Software/04.Database/3.%E5%8A%9B%E6%89%A3MySQL%E9%A2%98%E8%A7%A3.html#目录" class="sidebar-link">目录</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/03.Software/04.Database/3.%E5%8A%9B%E6%89%A3MySQL%E9%A2%98%E8%A7%A3.html#力扣-sql入门" class="sidebar-link">力扣-SQL入门</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/03.Software/04.Database/3.%E5%8A%9B%E6%89%A3MySQL%E9%A2%98%E8%A7%A3.html#_1-选择" class="sidebar-link">1.选择</a></li><li class="sidebar-sub-header"><a href="/03.Software/04.Database/3.%E5%8A%9B%E6%89%A3MySQL%E9%A2%98%E8%A7%A3.html#_2-排序-修改" class="sidebar-link">2.排序 &amp; 修改</a></li><li class="sidebar-sub-header"><a href="/03.Software/04.Database/3.%E5%8A%9B%E6%89%A3MySQL%E9%A2%98%E8%A7%A3.html#_3-字符串处理函数-正则" class="sidebar-link">3.字符串处理函数/正则</a></li><li class="sidebar-sub-header"><a href="/03.Software/04.Database/3.%E5%8A%9B%E6%89%A3MySQL%E9%A2%98%E8%A7%A3.html#_4-组合查询-指定选取" class="sidebar-link">4.组合查询&amp;指定选取</a></li><li class="sidebar-sub-header"><a href="/03.Software/04.Database/3.%E5%8A%9B%E6%89%A3MySQL%E9%A2%98%E8%A7%A3.html#_5-合并" class="sidebar-link">5.合并</a></li><li class="sidebar-sub-header"><a href="/03.Software/04.Database/3.%E5%8A%9B%E6%89%A3MySQL%E9%A2%98%E8%A7%A3.html#_6-合并" class="sidebar-link">6.合并</a></li><li class="sidebar-sub-header"><a href="/03.Software/04.Database/3.%E5%8A%9B%E6%89%A3MySQL%E9%A2%98%E8%A7%A3.html#_7-计算函数" class="sidebar-link">7.计算函数</a></li><li class="sidebar-sub-header"><a href="/03.Software/04.Database/3.%E5%8A%9B%E6%89%A3MySQL%E9%A2%98%E8%A7%A3.html#_8-计算函数" class="sidebar-link">8.计算函数</a></li><li class="sidebar-sub-header"><a href="/03.Software/04.Database/3.%E5%8A%9B%E6%89%A3MySQL%E9%A2%98%E8%A7%A3.html#_9-控制流" class="sidebar-link">9.控制流</a></li><li class="sidebar-sub-header"><a href="/03.Software/04.Database/3.%E5%8A%9B%E6%89%A3MySQL%E9%A2%98%E8%A7%A3.html#_10-过滤" class="sidebar-link">10.过滤</a></li></ul></li><li><a href="/03.Software/04.Database/3.%E5%8A%9B%E6%89%A3MySQL%E9%A2%98%E8%A7%A3.html#力扣-sql-基础plus会员-11天" class="sidebar-link">力扣-SQL 基础plus会员-11天</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/03.Software/04.Database/3.%E5%8A%9B%E6%89%A3MySQL%E9%A2%98%E8%A7%A3.html#_1-数值处理函数" class="sidebar-link">1.数值处理函数</a></li><li class="sidebar-sub-header"><a href="/03.Software/04.Database/3.%E5%8A%9B%E6%89%A3MySQL%E9%A2%98%E8%A7%A3.html#_2-数值处理函数" class="sidebar-link">2.数值处理函数</a></li><li class="sidebar-sub-header"><a href="/03.Software/04.Database/3.%E5%8A%9B%E6%89%A3MySQL%E9%A2%98%E8%A7%A3.html#_3-连接" class="sidebar-link">3.连接</a></li><li class="sidebar-sub-header"><a href="/03.Software/04.Database/3.%E5%8A%9B%E6%89%A3MySQL%E9%A2%98%E8%A7%A3.html#_4-连接" class="sidebar-link">4.连接</a></li><li class="sidebar-sub-header"><a href="/03.Software/04.Database/3.%E5%8A%9B%E6%89%A3MySQL%E9%A2%98%E8%A7%A3.html#_5-连接" class="sidebar-link">5.连接</a></li><li class="sidebar-sub-header"><a href="/03.Software/04.Database/3.%E5%8A%9B%E6%89%A3MySQL%E9%A2%98%E8%A7%A3.html#_6-连接" class="sidebar-link">6.连接</a></li><li class="sidebar-sub-header"><a href="/03.Software/04.Database/3.%E5%8A%9B%E6%89%A3MySQL%E9%A2%98%E8%A7%A3.html#_7-连接" class="sidebar-link">7.连接</a></li><li class="sidebar-sub-header"><a href="/03.Software/04.Database/3.%E5%8A%9B%E6%89%A3MySQL%E9%A2%98%E8%A7%A3.html#_8-不等式连接" class="sidebar-link">8.不等式连接</a></li><li class="sidebar-sub-header"><a href="/03.Software/04.Database/3.%E5%8A%9B%E6%89%A3MySQL%E9%A2%98%E8%A7%A3.html#_9-子查询" class="sidebar-link">9.子查询</a></li><li class="sidebar-sub-header"><a href="/03.Software/04.Database/3.%E5%8A%9B%E6%89%A3MySQL%E9%A2%98%E8%A7%A3.html#_10-子查询" class="sidebar-link">10.子查询</a></li><li class="sidebar-sub-header"><a href="/03.Software/04.Database/3.%E5%8A%9B%E6%89%A3MySQL%E9%A2%98%E8%A7%A3.html#_11-子查询" class="sidebar-link">11.子查询</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="力扣mysql题解"><a href="#力扣mysql题解" class="header-anchor">#</a> 力扣MySQL题解</h1> <h2 id="目录"><a href="#目录" class="header-anchor">#</a> 目录</h2> <p></p><div class="table-of-contents"><ul><li><a href="#目录">目录</a></li><li><a href="#力扣-sql入门">力扣-SQL入门</a><ul><li><a href="#_1-选择">1.选择</a></li><li><a href="#_2-排序-修改">2.排序 &amp; 修改</a></li><li><a href="#_3-字符串处理函数-正则">3.字符串处理函数/正则</a></li><li><a href="#_4-组合查询-指定选取">4.组合查询&amp;指定选取</a></li><li><a href="#_5-合并">5.合并</a></li><li><a href="#_6-合并">6.合并</a></li><li><a href="#_7-计算函数">7.计算函数</a></li><li><a href="#_8-计算函数">8.计算函数</a></li><li><a href="#_9-控制流">9.控制流</a></li><li><a href="#_10-过滤">10.过滤</a></li></ul></li><li><a href="#力扣-sql-基础plus会员-11天">力扣-SQL 基础plus会员-11天</a><ul><li><a href="#_1-数值处理函数">1.数值处理函数</a></li><li><a href="#_2-数值处理函数">2.数值处理函数</a></li><li><a href="#_3-连接">3.连接</a></li><li><a href="#_4-连接">4.连接</a></li><li><a href="#_5-连接">5.连接</a></li><li><a href="#_6-连接">6.连接</a></li><li><a href="#_7-连接">7.连接</a></li><li><a href="#_8-不等式连接">8.不等式连接</a></li><li><a href="#_9-子查询">9.子查询</a></li><li><a href="#_10-子查询">10.子查询</a></li><li><a href="#_11-子查询">11.子查询</a></li></ul></li></ul></div><p></p> <p>[TOC]</p> <h2 id="力扣-sql入门"><a href="#力扣-sql入门" class="header-anchor">#</a> 力扣-SQL入门</h2> <h3 id="_1-选择"><a href="#_1-选择" class="header-anchor">#</a> 1.选择</h3> <h4 id="_595-大的国家"><a href="#_595-大的国家" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/big-countries/" target="_blank" rel="noopener noreferrer">595. 大的国家<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># Write your MySQL query statement below
select name , population, area
from World
where area&gt;=3000000 or population&gt;=25000000
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="_1757-可回收且低脂的产品"><a href="#_1757-可回收且低脂的产品" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/recyclable-and-low-fat-products/" target="_blank" rel="noopener noreferrer">1757. 可回收且低脂的产品<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># Write your MySQL query statement below
select product_id 
from Products
where 'Y'=recyclable and 'Y'=low_fats
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="_584-寻找用户推荐人"><a href="#_584-寻找用户推荐人" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/find-customer-referee/" target="_blank" rel="noopener noreferrer">584. 寻找用户推荐人<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <ul><li>易错，本题，必须判断<code>referee_id is null</code></li></ul> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># Write your MySQL query statement below
select name 
from customer
where ( not referee_id=2 ) or  referee_id is null
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="_183-从不订购的客户⭐️"><a href="#_183-从不订购的客户⭐️" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/customers-who-never-order/" target="_blank" rel="noopener noreferrer">183. 从不订购的客户<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>⭐️</h4> <ul><li>not in的使用</li></ul> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># Write your MySQL query statement below
select name as Customers
from Customers
where Id not in
( 
    select CustomerId
    from Orders
)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ul><li>更加明确的写法如下⭐️⭐️</li></ul> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code>select Customers.name as Customers
from Customers
where Customers.id not in
(
    select Customerid from Orders
)

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_2-排序-修改"><a href="#_2-排序-修改" class="header-anchor">#</a> 2.排序 &amp; 修改</h3> <h4 id="_1873-计算特殊奖金⭐️"><a href="#_1873-计算特殊奖金⭐️" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/calculate-special-bonus/" target="_blank" rel="noopener noreferrer">1873. 计算特殊奖金<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>⭐️</h4> <ul><li>学习case end的使用</li></ul> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># Write your MySQL query statement below
select employee_id , 
case
  when ( left(name,1)!='M' and employee_id % 2=1 ) then salary
  else 0
end 
as bonus
from Employees
order by employee_id
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="_627-变更性别⭐️"><a href="#_627-变更性别⭐️" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/swap-salary/" target="_blank" rel="noopener noreferrer">627. 变更性别<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>⭐️</h4> <ul><li>if语句</li></ul> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># Write your MySQL query statement below
update Salary
set sex=
    if( 'f'=sex ,
    'm','f')
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>case解法</li></ul> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># Write your MySQL query statement below
update Salary
set sex=
    case sex
        when 'f' then 'm'
        when 'm' then 'f'
    end
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="_196-删除重复的电子邮箱⭐️"><a href="#_196-删除重复的电子邮箱⭐️" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/delete-duplicate-emails/" target="_blank" rel="noopener noreferrer">196. 删除重复的电子邮箱<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>⭐️</h4> <ul><li>自连接！学习⭐️⭐️</li></ul> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># Please write a DELETE statement and DO NOT write a SELECT statement.
# Write your MySQL query statement below
delete p1 
	from Person p1 ,Person p2
where p1.Email =p2.Email and p1.Id &gt; p2.Id
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_3-字符串处理函数-正则"><a href="#_3-字符串处理函数-正则" class="header-anchor">#</a> 3.字符串处理函数/正则</h3> <h4 id="_1667-修复表中的名字"><a href="#_1667-修复表中的名字" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/fix-names-in-a-table/" target="_blank" rel="noopener noreferrer">1667. 修复表中的名字<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># Write your MySQL query statement below
SELECT user_id, 
    CONCAT(UPPER(SUBSTRING(name, 1, 1)),
         LOWER(SUBSTRING(name, 2, (SELECT LENGTH(name))))) name
FROM Users
ORDER BY user_id

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="_1484-按日期分组销售产品"><a href="#_1484-按日期分组销售产品" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/group-sold-products-by-the-date/" target="_blank" rel="noopener noreferrer">1484. 按日期分组销售产品<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <ul><li>记忆，不会的<code>GROUP_CONCAT（）</code>函数</li></ul> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code>select 
    sell_date, 
    # 获取“不同的”产品数【count(distinct product)】
    count(distinct product) as num_sold, 
    # “不同的”【distinct product】产品按照字典排序【order by product】  &amp; “,”分割【separator ','】
    group_concat(distinct product order by product separator ',') as products
from Activities
group by sell_date
order by sell_date;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="_1527-患某种疾病的患者"><a href="#_1527-患某种疾病的患者" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/patients-with-a-condition/" target="_blank" rel="noopener noreferrer">1527. 患某种疾病的患者<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># Write your MySQL query statement below
select patient_id,patient_name, conditions
from Patients
where conditions like '% DIAB1%'
    or conditions like'DIAB1%'
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_4-组合查询-指定选取"><a href="#_4-组合查询-指定选取" class="header-anchor">#</a> 4.组合查询&amp;指定选取</h3> <h4 id="_1965-丢失信息的雇员"><a href="#_1965-丢失信息的雇员" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/employees-with-missing-information/" target="_blank" rel="noopener noreferrer">1965. 丢失信息的雇员<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># Write your MySQL query statement below
select employee_id from (
    select e.employee_id employee_id from Employees e left join Salaries s on e.employee_id=s.employee_id where salary is null
    union all
    select s.employee_id employee_id from Employees e right join Salaries s on e.employee_id=s.employee_id where name is null
) x order by employee_id;

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="_1795-每个产品在不同商店的价格"><a href="#_1795-每个产品在不同商店的价格" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/rearrange-products-table/" target="_blank" rel="noopener noreferrer">1795. 每个产品在不同商店的价格<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># Write your MySQL query statement below
select product_id, 'store1' store, store1 price from products where store1 is not NULL
UNION
select product_id, 'store2' store, store2 price from products where store2 is not NULL
UNION
select product_id, 'store3' store, store3 price from products where store3 is not NULL


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="_608-树节点"><a href="#_608-树节点" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/tree-node/" target="_blank" rel="noopener noreferrer">608. 树节点<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># Write your MySQL query statement below
# Write your MySQL query statement below
select id,(
    case WHEN p_id is null THEN 'Root'
        WHEN id in(select p_id from tree) THEN 'Inner'
        else 'Leaf' END)
    as type from tree 
order by id
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="_176-第二高的薪水"><a href="#_176-第二高的薪水" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/second-highest-salary/" target="_blank" rel="noopener noreferrer">176. 第二高的薪水<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># Write your MySQL query statement below
SELECT
    (SELECT DISTINCT
            Salary
        FROM
            Employee
        ORDER BY Salary DESC
        LIMIT 1 OFFSET 1) AS SecondHighestSalary
;

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="_5-合并"><a href="#_5-合并" class="header-anchor">#</a> 5.合并</h3> <p>多表的联结又分为以下几种类型：</p> <p>1）左联结（left join），联结结果保留左表的全部数据</p> <p>2）右联结（right join），联结结果保留右表的全部数据</p> <p>3）内联结（inner join），取两表的公共数据</p> <h4 id="_175-组合两个表"><a href="#_175-组合两个表" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/combine-two-tables/" target="_blank" rel="noopener noreferrer">175. 组合两个表<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># Write your MySQL query statement below
select FirstName, LastName, City, State
from Person left join Address
on Person.PersonId = Address.PersonId
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="_1581-进店却未进行过交易的顾客"><a href="#_1581-进店却未进行过交易的顾客" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/customer-who-visited-but-did-not-make-any-transactions/" target="_blank" rel="noopener noreferrer">1581. 进店却未进行过交易的顾客<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># Write your MySQL query statement below
select a.customer_id, count(1) count_no_trans 
    from Visits a
    where a.visit_id not in (select b.visit_id from Transactions b)
    group by a.customer_id

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="_1148-文章浏览-i"><a href="#_1148-文章浏览-i" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/article-views-i/" target="_blank" rel="noopener noreferrer">1148. 文章浏览 I<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># Write your MySQL query statement below
select distinct author_id as id
from  Views
where author_id = viewer_id
order by author_id

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="_6-合并"><a href="#_6-合并" class="header-anchor">#</a> 6.合并</h3> <h4 id="_197-上升的温度"><a href="#_197-上升的温度" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/rising-temperature/" target="_blank" rel="noopener noreferrer">197. 上升的温度<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># Write your MySQL query statement below
SELECT b.Id
FROM Weather as a,Weather as b
WHERE a.Temperature &lt; b.Temperature and DATEDIFF(a.RecordDate,b.RecordDate) = -1;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="_607-销售员"><a href="#_607-销售员" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/sales-person/" target="_blank" rel="noopener noreferrer">607. 销售员<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code>select distinct name from SalesPerson where sales_id not in (
    select distinct sales_id from Orders where com_id=(
        select com_id from Company where name=&quot;RED&quot;
    )
);
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_7-计算函数"><a href="#_7-计算函数" class="header-anchor">#</a> 7.计算函数</h3> <h4 id="_1141-查询近30天活跃用户数"><a href="#_1141-查询近30天活跃用户数" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/user-activity-for-the-past-30-days-i/" target="_blank" rel="noopener noreferrer">1141. 查询近30天活跃用户数<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># Write your MySQL query statement below
# Write your MySQL query statement below
select activity_date as day,count(distinct user_id) as active_users
from
    Activity
where
    activity_date between '2019-06-28' and '2019-07-27'
group by
    activity_date;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="_1693-每天的领导和合伙人"><a href="#_1693-每天的领导和合伙人" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/daily-leads-and-partners/" target="_blank" rel="noopener noreferrer">1693. 每天的领导和合伙人<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># Write your MySQL query statement below
select date_id , make_name ,count(distinct lead_id) unique_leads , count(distinct partner_id) unique_partners
from dailysales
group by date_id,make_name;

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="_1729-求关注者的数量"><a href="#_1729-求关注者的数量" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/find-followers-count/" target="_blank" rel="noopener noreferrer">1729. 求关注者的数量<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># Write your MySQL query statement below
select user_id, count(1) followers_count 
from Followers 
group by user_id 
order by user_id;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_8-计算函数"><a href="#_8-计算函数" class="header-anchor">#</a> 8.计算函数</h3> <h4 id="_511-游戏玩法分析-i"><a href="#_511-游戏玩法分析-i" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/game-play-analysis-i/" target="_blank" rel="noopener noreferrer">511. 游戏玩法分析 I<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># Write your MySQL query statement below
select player_id,min(event_date) as 'first_login'
from Activity
group by player_id
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="_586-订单最多的客户"><a href="#_586-订单最多的客户" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/customer-placing-the-largest-number-of-orders/" target="_blank" rel="noopener noreferrer">586. 订单最多的客户<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code>SELECT
    customer_number
FROM
    orders
GROUP BY customer_number
ORDER BY COUNT(*) DESC
LIMIT 1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="_1890-2020年最后一次登录"><a href="#_1890-2020年最后一次登录" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/the-latest-login-in-2020/" target="_blank" rel="noopener noreferrer">1890. 2020年最后一次登录<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># Write your MySQL query statement below
# Write your MySQL query statement below
select
    user_id,max(time_stamp) as last_stamp 
from
    Logins
where
    time_stamp between '2020-01-01' and '2021-01-01'
group by 
    user_id

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h4 id="_1741-查找每个员工花费的总时间"><a href="#_1741-查找每个员工花费的总时间" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/find-total-time-spent-by-each-employee/" target="_blank" rel="noopener noreferrer">1741. 查找每个员工花费的总时间<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code>SELECT
    event_day day, emp_id, SUM(out_time - in_time) total_time
FROM
    Employees
GROUP BY
    event_day, emp_id;

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_9-控制流"><a href="#_9-控制流" class="header-anchor">#</a> 9.控制流</h3> <h4 id="_1393-股票的资本损益"><a href="#_1393-股票的资本损益" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/capital-gainloss/?envType=study-plan&amp;id=sql-beginner&amp;plan=sql&amp;plan_progress=4o17k31" target="_blank" rel="noopener noreferrer">1393. 股票的资本损益<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># Write your MySQL query statement below
# Write your MySQL query statement below
# 方法一 case when
# select stock_name, sum(
#     case when operation = 'buy' then -price
#     else price end
# ) as capital_gain_loss 
# from stocks 
# group by stock_name;

# 方法二 if语句
select stock_name, sum(
    if(operation = 'buy', -price, price)
) as capital_gain_loss 
from stocks 
group by stock_name;

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h4 id="_1407-排名靠前的旅行者"><a href="#_1407-排名靠前的旅行者" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/top-travellers/?envType=study-plan&amp;id=sql-beginner&amp;plan=sql&amp;plan_progress=4o17k31" target="_blank" rel="noopener noreferrer">1407. 排名靠前的旅行者<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># Write your MySQL query statement below
# Write your MySQL query statement below
# 1.先查出每个有行程的用户的距离 用到group by 和sum
# 2.由于没有行程的用户也需要查找所以需用到left join(主表数据不受影响),
#   再通过IFNULL()函数对行程为null的用户赋值为0,最后对其order by排序就行了
select name, ifnull (travelled_distance,0) as travelled_distance
from Users

left join
(
    select
    user_id,sum(distance) as travelled_distance 
    from Rides 
        group by user_id
)t1
on t1.user_id= Users.id
order by travelled_distance desc, name asc


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h4 id="_1158-市场分析-i"><a href="#_1158-市场分析-i" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/market-analysis-i/?envType=study-plan&amp;id=sql-beginner&amp;plan=sql&amp;plan_progress=4o17k31" target="_blank" rel="noopener noreferrer">1158. 市场分析 I<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># Write your MySQL query statement below
select Users.user_id as buyer_id, 
    join_date, 
    ifnull(UserBuy.cnt, 0) as orders_in_2019
from Users
left join (
    select buyer_id, count(order_id) cnt 
    from Orders
    where order_date between '2019-01-01' and '2019-12-31'
    group by buyer_id
) UserBuy
on Users.user_id = UserBuy.buyer_id

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="_10-过滤"><a href="#_10-过滤" class="header-anchor">#</a> 10.过滤</h3> <h4 id="_182-查找重复的电子邮箱"><a href="#_182-查找重复的电子邮箱" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/duplicate-emails/?envType=study-plan&amp;id=sql-beginner&amp;plan=sql&amp;plan_progress=4o17k31" target="_blank" rel="noopener noreferrer">182. 查找重复的电子邮箱<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># Write your MySQL query statement below
select Email
from Person
group by Email
having count(Email) &gt; 1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="_1050-合作过至少三次的演员和导演"><a href="#_1050-合作过至少三次的演员和导演" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/actors-and-directors-who-cooperated-at-least-three-times/?envType=study-plan&amp;id=sql-beginner&amp;plan=sql&amp;plan_progress=4o17k31" target="_blank" rel="noopener noreferrer">1050. 合作过至少三次的演员和导演<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># Write your MySQL query statement below
select actor_id , director_id
from ActorDirector
group by actor_id , director_id
having count(timestamp) &gt;= 3
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="_1587-银行账户概要-ii"><a href="#_1587-银行账户概要-ii" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/bank-account-summary-ii/?envType=study-plan&amp;id=sql-beginner&amp;plan=sql&amp;plan_progress=4o17k31" target="_blank" rel="noopener noreferrer">1587. 银行账户概要 II<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># Write your MySQL query statement below
select    name, SUM(amount) balance
from
    Users u 
join
    Transactions t 
on
    u.account = T.account
group by
    u.account
having
    sum(amount) &gt; 10000;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h4 id="_1084-销售分析iii"><a href="#_1084-销售分析iii" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/sales-analysis-iii/?envType=study-plan&amp;id=sql-beginner&amp;plan=sql&amp;plan_progress=4o17k31" target="_blank" rel="noopener noreferrer">1084. 销售分析III<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code>select product_id, product_name
from product
where product_id in (
    select
        product_id
    from sales
    group by product_id
    having max(sale_date) &lt;= '2019-03-31' and min(sale_date) &gt;= '2019-01-01'
)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="力扣-sql-基础plus会员-11天"><a href="#力扣-sql-基础plus会员-11天" class="header-anchor">#</a> 力扣-SQL 基础plus会员-11天</h2> <h3 id="_1-数值处理函数"><a href="#_1-数值处理函数" class="header-anchor">#</a> 1.数值处理函数</h3> <h4 id="_1699-两人之间的通话次数"><a href="#_1699-两人之间的通话次数" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/number-of-calls-between-two-persons/" target="_blank" rel="noopener noreferrer">1699. 两人之间的通话次数<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># Write your MySQL query statement below
# Write your MySQL query statement below
SELECT 
    person1,person2, 
    count(*) call_count, 
    sum(duration) total_duration 
FROM (
SELECT 
    IF(from_id&gt;to_id, to_id, from_id) person1, 
    IF(from_id&gt;to_id,from_id,to_id) person2, 
    duration  
FROM calls 
) c 
GROUP BY 
    person1, person2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h4 id="_1251-平均售价"><a href="#_1251-平均售价" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/average-selling-price/" target="_blank" rel="noopener noreferrer">1251. 平均售价<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code>SELECT u.product_id product_id,
        ROUND(SUM(u.units*p.price)/SUM(u.units),2) average_price        
FROM UnitsSold u ,Prices p
WHERE u.product_id=p.product_id 
        AND u.purchase_date BETWEEN p.start_date AND p.end_date
GROUP BY u.product_id

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="_1571-仓库经理"><a href="#_1571-仓库经理" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/warehouse-manager/" target="_blank" rel="noopener noreferrer">1571. 仓库经理<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># Write your MySQL query statement below
SELECT 
    w.name WAREHOUSE_NAME,
    SUM(p.Width * p.Length * p.Height * w.units) VOLUME
FROM 
    warehouse w
LEFT JOIN 
    products p
ON 
    w.product_id = p.product_id
GROUP BY w.name;

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h4 id="_1445-苹果和桔子"><a href="#_1445-苹果和桔子" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/apples-oranges/" target="_blank" rel="noopener noreferrer">1445. 苹果和桔子<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code>select    sale_date,
    sum(
        if(fruit = 'apples', sold_num, -sold_num)
    ) as diff
    from sales
group by sale_date
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="_2-数值处理函数"><a href="#_2-数值处理函数" class="header-anchor">#</a> 2.数值处理函数</h3> <h4 id="_1193-每月交易-i"><a href="#_1193-每月交易-i" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/monthly-transactions-i/" target="_blank" rel="noopener noreferrer">1193. 每月交易 I<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code>select date_format(trans_date,'%Y-%m') as month,
        country, count(*) as trans_count, 
        sum(case state when 'approved' then 1 else 0 end) as approved_count,
        sum(amount) as trans_total_amount,
        sum(case state when 'approved' then amount else 0 end) as approved_total_amount
from Transactions
group by month,country;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="_1633-各赛事的用户注册率"><a href="#_1633-各赛事的用户注册率" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/percentage-of-users-attended-a-contest/" target="_blank" rel="noopener noreferrer">1633. 各赛事的用户注册率<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># Write your MySQL query statement below

select contest_id,
       round(count(user_id) / (select count(1) from Users) * 100, 2) as percentage
       from Register
       group by contest_id
       order by percentage desc , contest_id

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="_1173-即时食物配送-i"><a href="#_1173-即时食物配送-i" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/immediate-food-delivery-i/" target="_blank" rel="noopener noreferrer">1173. 即时食物配送 I<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># Write your MySQL query statement below
select round (
    sum(order_date = customer_pref_delivery_date) /
    count(*) * 100,
    2
) as immediate_percentage
from Delivery

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="_1211-查询结果的质量和占比"><a href="#_1211-查询结果的质量和占比" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/queries-quality-and-percentage/" target="_blank" rel="noopener noreferrer">1211. 查询结果的质量和占比<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># Write your MySQL query statement below
select 
query_name, 
        round(avg(rating/position), 2) quality,
        round(sum(if(rating &lt; 3, 1, 0)) * 100 / count(*), 2) poor_query_percentage
        from queries
        group by query_name

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="_3-连接"><a href="#_3-连接" class="header-anchor">#</a> 3.连接</h3> <h4 id="_1607-没有卖出的卖家"><a href="#_1607-没有卖出的卖家" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/sellers-with-no-sales/" target="_blank" rel="noopener noreferrer">1607. 没有卖出的卖家<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code>/* write your pl/sql query statement below */
select s.seller_name from seller s where s.seller_id not in (
    select o.seller_id from orders o where o.sale_date like '2020%'
) order by seller_name 

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="_619-只出现一次的最大数字"><a href="#_619-只出现一次的最大数字" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/biggest-single-number/" target="_blank" rel="noopener noreferrer">619. 只出现一次的最大数字<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code>select 
(
    select ifnull(num, null) as num from mynumbers 
    group by num
    having count(*) = 1
    order by num desc
    limit 0, 1
) num

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="_1112-每位学生的最高成绩"><a href="#_1112-每位学生的最高成绩" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/highest-grade-for-each-student/" target="_blank" rel="noopener noreferrer">1112. 每位学生的最高成绩<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code>SELECT student_id, min(course_id) AS course_id, grade
FROM enrollments
WHERE (student_id, grade) IN
(
    SELECT student_id, MAX(grade) AS grade
    FROM Enrollments
    GROUP BY student_id
)
GROUP BY student_id, grade
ORDER BY student_id

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h4 id="_1398-购买了产品-a-和产品-b-却没有购买产品-c-的顾客"><a href="#_1398-购买了产品-a-和产品-b-却没有购买产品-c-的顾客" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/customers-who-bought-products-a-and-b-but-not-c/" target="_blank" rel="noopener noreferrer">1398. 购买了产品 A 和产品 B 却没有购买产品 C 的顾客<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code>select o.customer_id, c.customer_name from orders o
left join customers c
on o.customer_id = c.customer_id
group by customer_id
having 
    SUM(if(product_name = 'A', 1, 0)) &gt; 0 and
    SUM(if(product_name = 'B', 1, 0)) &gt; 0 and
    SUM(if(product_name = 'C', 1, 0)) = 0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="_4-连接"><a href="#_4-连接" class="header-anchor">#</a> 4.连接</h3> <h4 id="_1440-计算布尔表达式的值"><a href="#_1440-计算布尔表达式的值" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/evaluate-boolean-expression/" target="_blank" rel="noopener noreferrer">1440. 计算布尔表达式的值<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code>select e.left_operand,e.operator,e.right_operand,
case e.operator
    when '&gt;' then if(v1.value&gt;v2.value,'true','false')
    when '&lt;' then if(v1.value&lt;v2.value,'true','false')
    else  if(v1.value=v2.value,'true','false')
end value
    
from Expressions e
left join Variables v1 on v1.name = e.left_operand 
left join Variables v2 on v2.name = e.right_operand

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h4 id="_1264-页面推荐"><a href="#_1264-页面推荐" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/page-recommendations/" target="_blank" rel="noopener noreferrer">1264. 页面推荐<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code>select distinct page_id as recommended_page
from likes
where user_id in (
                select user1_id as user_id from friendship where user2_id = 1
                union all
                select user2_id as user_id from friendship where user1_id = 1
                ) and page_id not in (
                        select page_id from likes where user_id = 1
                        )
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="_570-至少有5名直接下属的经理"><a href="#_570-至少有5名直接下属的经理" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/managers-with-at-least-5-direct-reports/" target="_blank" rel="noopener noreferrer">570. 至少有5名直接下属的经理<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code>select
name
from
employee as t1 join
(select
 managerid
 from
 employee
 group by managerid
 having count(managerid) &gt;= 5) as t2
on t1.id = t2.managerid

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h4 id="_1303-求团队人数"><a href="#_1303-求团队人数" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/find-the-team-size/" target="_blank" rel="noopener noreferrer">1303. 求团队人数<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># write your mysql query statement below
select e.employee_id,t1.team_size from employee e inner join 
(
    select team_id, 
    count(team_id) as team_size from employee group by team_id
) t1
on t1.team_id = e.team_id

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="_5-连接"><a href="#_5-连接" class="header-anchor">#</a> 5.连接</h3> <h4 id="_1280-学生们参加各科测试的次数"><a href="#_1280-学生们参加各科测试的次数" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/students-and-examinations/" target="_blank" rel="noopener noreferrer">1280. 学生们参加各科测试的次数<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># 自连接
with cte1 as
(
    select *
    from students,subjects
)


select 
    a.student_id,
    a.student_name,
    a.subject_name,
    ifnull(count(b.subject_name),0) as attended_exams 
from cte1 a
left join Examinations b
using(student_id,subject_name)
group by 1,2,3
order by 1,2,3


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h4 id="_1501-可以放心投资的国家"><a href="#_1501-可以放心投资的国家" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/countries-you-can-safely-invest-in/" target="_blank" rel="noopener noreferrer">1501. 可以放心投资的国家<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># write your mysql query statement below
select c.name as country
	from calls, person, country c
where (caller_id = id or callee_id = id) and country_code = left(phone_number, 3)
	group by country_code
	having avg(duration) &gt; (select avg(duration) from calls);
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="_184-部门工资最高的员工"><a href="#_184-部门工资最高的员工" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/department-highest-salary/" target="_blank" rel="noopener noreferrer">184. 部门工资最高的员工<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code>select
    department.name as 'department',
    employee.name as 'employee',
    salary
from
    employee
        join
    department on employee.departmentid = department.id
where
    (employee.departmentid , salary) in
    (   select
            departmentid, max(salary)
        from
            employee
        group by departmentid
	)
;

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h4 id="_580-统计各专业学生人数"><a href="#_580-统计各专业学生人数" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/count-student-number-in-departments/" target="_blank" rel="noopener noreferrer">580. 统计各专业学生人数<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code>select
    dept_name, count(student_id) as student_number
from
    department
        left outer join
    student on department.dept_id = student.dept_id
group by department.dept_name
order by student_number desc , department.dept_name
;

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="_6-连接"><a href="#_6-连接" class="header-anchor">#</a> 6.连接</h3> <h4 id="_1294-不同国家的天气类型"><a href="#_1294-不同国家的天气类型" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/weather-type-in-each-country/" target="_blank" rel="noopener noreferrer">1294. 不同国家的天气类型<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># Write your MySQL query statement below
SELECT country_name AS 'country_name',
    CASE 
        WHEN AVG(w1.weather_state) &lt;= 15 THEN 'Cold' 
        WHEN AVG(w1.weather_state) &gt;= 25 THEN 'Hot'
        ELSE 'Warm'
    END
        AS 'weather_type'
FROM 
    Countries AS c1
    INNER JOIN Weather AS w1
    ON c1.country_id = w1.country_id
WHERE w1.day BETWEEN '2019-11-01' AND '2019-11-30'
GROUP BY c1.country_id
;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h4 id="_626-换座位"><a href="#_626-换座位" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/exchange-seats/" target="_blank" rel="noopener noreferrer">626. 换座位<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code>select
    (case
        when mod(id, 2) != 0 and counts != id then id + 1
        when mod(id, 2) != 0 and counts = id then id
        else id - 1
    end) as id,
    student
from
    seat,
    (select
        count(*) as counts
    from
        seat) as seat_counts
order by id asc;

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h4 id="_1783-大满贯数量"><a href="#_1783-大满贯数量" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/grand-slam-titles/" target="_blank" rel="noopener noreferrer">1783. 大满贯数量<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># Write your MySQL query statement below
#计算Championships表中每个运动员id出现的次数

SELECT player_id,player_name,
      SUM(IF(player_id=Wimbledon,1,0)+IF(player_id=Fr_open,1,0)+IF(player_id=US_open,1,0)+IF(player_id=Au_open,1,0)) AS grand_slams_count
FROM Championships 
JOIN Players 
GROUP BY player_id
HAVING grand_slams_count&gt;0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="_1164-指定日期的产品价格"><a href="#_1164-指定日期的产品价格" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/product-price-at-a-given-date/" target="_blank" rel="noopener noreferrer">1164. 指定日期的产品价格<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code>select p1.product_id, ifnull(p2.new_price, 10) as price
from (
    select distinct product_id
    from products
) as p1 -- 所有的产品
left join (
    select product_id, new_price 
    from products
    where (product_id, change_date) in (
        select product_id, max(change_date)
        from products
        where change_date &lt;= '2019-08-16'
        group by product_id
    )
) as p2 -- 在 2019-08-16 之前有过修改的产品和最新的价格
on p1.product_id = p2.product_id

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="_7-连接"><a href="#_7-连接" class="header-anchor">#</a> 7.连接</h3> <h4 id="_603-连续空余座位"><a href="#_603-连续空余座位" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/consecutive-available-seats/" target="_blank" rel="noopener noreferrer">603. 连续空余座位<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># Write your MySQL query statement below
select distinct a.seat_id
from cinema a join cinema b
  on abs(a.seat_id - b.seat_id) = 1
  and a.free = true and b.free = true
order by a.seat_id
;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="_1731-每位经理的下属员工数量"><a href="#_1731-每位经理的下属员工数量" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/the-number-of-employees-which-report-to-each-employee/" target="_blank" rel="noopener noreferrer">1731. 每位经理的下属员工数量<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># Write your MySQL query statement below
select 
    e1.employee_id,
    e1.name,
    count(*) as reports_count,
    ROUND(avg(e2.age), 0) as average_age
from employees e1
join employees e2
on e2.reports_to = e1.employee_id
group by employee_id
order by employee_id

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h4 id="_1747-应该被禁止的-leetflex-账户"><a href="#_1747-应该被禁止的-leetflex-账户" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/leetflex-banned-accounts/" target="_blank" rel="noopener noreferrer">1747. 应该被禁止的 Leetflex 账户<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># Write your MySQL query statement below
select distinct l1.account_id from loginfo l1
join loginfo l2
on 
    l1.account_id = l2.account_id and 
    l1.ip_address != l2.ip_address and 
    ( l1.login &gt;= l2.login and l1.login &lt;= l2.logout )

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="_181-超过经理收入的员工"><a href="#_181-超过经理收入的员工" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/employees-earning-more-than-their-managers/" target="_blank" rel="noopener noreferrer">181. 超过经理收入的员工<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code>select
     a.name as employee
from employee as a join employee as b
     on a.managerid = b.id
     and a.salary &gt; b.salary
;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="_8-不等式连接"><a href="#_8-不等式连接" class="header-anchor">#</a> 8.不等式连接</h3> <h4 id="_1459-矩形面积"><a href="#_1459-矩形面积" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/rectangles-area/" target="_blank" rel="noopener noreferrer">1459. 矩形面积<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># Write your MySQL query statement below
SELECT 
    p1.id P1,
    p2.id P2,
    ABS(p1.x_value-p2.x_value)*ABS(p1.y_value-p2.y_value) AREA
FROM points p1,points p2
WHERE p1.id&lt;p2.id 
AND p1.x_value!=p2.x_value
AND p1.y_value!=p2.y_value
ORDER BY  AREA desc,p1.id,p2.id

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h4 id="_180-连续出现的数字"><a href="#_180-连续出现的数字" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/consecutive-numbers/" target="_blank" rel="noopener noreferrer">180. 连续出现的数字<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code>SELECT DISTINCT
    l1.Num AS ConsecutiveNums
FROM
    Logs l1,
    Logs l2,
    Logs l3
WHERE
    l1.Id = l2.Id - 1
    AND l2.Id = l3.Id - 1
    AND l1.Num = l2.Num
    AND l2.Num = l3.Num
;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h4 id="_1988-找出每所学校的最低分数要求"><a href="#_1988-找出每所学校的最低分数要求" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/find-cutoff-score-for-each-school/" target="_blank" rel="noopener noreferrer">1988. 找出每所学校的最低分数要求<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># Write your MySQL query statement below
SELECT
    school_id,
    IFNULL(min(score), -1) as score
FROM (
    SELECT
        s.school_id,
        e.score
    FROM schools s
    LEFT JOIN exam e ON s.capacity &gt;= e.student_count
) t
GROUP BY school_id
ORDER BY school_id;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="_9-子查询"><a href="#_9-子查询" class="header-anchor">#</a> 9.子查询</h3> <h4 id="_1549-每件商品的最新订单"><a href="#_1549-每件商品的最新订单" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/the-most-recent-orders-for-each-product/" target="_blank" rel="noopener noreferrer">1549. 每件商品的最新订单<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code>select p.product_name, o.product_id, o.order_id, o.order_date from orders o
left join products p
on p.product_id = o.product_id
where (o.product_id, order_date) in 
(
    select product_id, max(order_date) from orders
    group by product_id
)
order by product_name asc, product_id asc, order_id asc

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="_1321-餐馆营业额变化增长"><a href="#_1321-餐馆营业额变化增长" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/restaurant-growth/" target="_blank" rel="noopener noreferrer">1321. 餐馆营业额变化增长<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code>select 
distinct a.visited_on,sum(b.amount) as amount,round(sum(b.amount)/7,2) as average_amount 
from Customer a
join Customer b
on datediff(a.visited_on,b.visited_on) &lt;= 6 and datediff(a.visited_on,b.visited_on) &gt;= 0
group by a.visited_on,a.customer_id     
having  count(distinct b.visited_on) = 7
order by visited_on 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="_1045-买下所有产品的客户"><a href="#_1045-买下所有产品的客户" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/customers-who-bought-all-products/" target="_blank" rel="noopener noreferrer">1045. 买下所有产品的客户<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code>select customer_id from customer
group by customer_id
having count(distinct product_key) = (select count(distinct product_key) from product)

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_10-子查询"><a href="#_10-子查询" class="header-anchor">#</a> 10.子查询</h3> <h4 id="_1341-电影评分"><a href="#_1341-电影评分" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/movie-rating/" target="_blank" rel="noopener noreferrer">1341. 电影评分<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code>select T.results FROM 
(
    SELECT U.name AS results,MR.user_id
    FROM Users U,MovieRating MR 
    WHERE U.user_id = MR.user_id
    GROUP BY MR.user_id,U.name
    ORDER BY COUNT(1) DESC,U.NAME ASC
    limit 1
) T
union all
select Q.results FROM 
(
    SELECT M.title AS results
    FROM Movies M,MovieRating MM 
    WHERE M.movie_id = MM.movie_id 
    AND MM.created_at LIKE '2020-02%'
    GROUP BY M.title
    ORDER BY AVG(MM.rating) DESC,M.title ASC
    limit 1
) Q

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h4 id="_1867-最大数量高于平均水平的订单"><a href="#_1867-最大数量高于平均水平的订单" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/orders-with-maximum-quantity-above-average/" target="_blank" rel="noopener noreferrer">1867. 最大数量高于平均水平的订单<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code>select
    order_id
from (
    -- 每个订单的最大数量 &gt; max(每个订单的平均数量)
    select
        *,
        max(quantity) &gt; max(avg(quantity)) over() as flag
    from OrdersDetails
    group by order_id
) as base
where flag = 1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="_11-子查询"><a href="#_11-子查询" class="header-anchor">#</a> 11.子查询</h3> <h4 id="_550-游戏玩法分析-iv"><a href="#_550-游戏玩法分析-iv" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/game-play-analysis-iv/" target="_blank" rel="noopener noreferrer">550. 游戏玩法分析 IV<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code># Write your MySQL query statement below
select round(avg(a.event_date is not null), 2) fraction
from 
    (select player_id, min(event_date) as login
    from activity
    group by player_id) p 
left join activity a 
on p.player_id=a.player_id and datediff(a.event_date, p.login)=1

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="_262-行程和用户"><a href="#_262-行程和用户" class="header-anchor">#</a> <a href="https://leetcode.cn/problems/trips-and-users/" target="_blank" rel="noopener noreferrer">262. 行程和用户<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code>select request_at 'Day',
round(count(if(status!='completed',status,null))/count(*),2) 'Cancellation Rate'
from Trips
where request_at between '2013-10-01' and '2013-10-03'
and client_id not in (select users_id from Users where banned='Yes') 
and driver_id not in (select users_id from Users where banned='Yes')
group by request_at;

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.f067657d.js" defer></script><script src="/assets/js/2.e96ccaa8.js" defer></script><script src="/assets/js/119.17d4a5ea.js" defer></script>
  </body>
</html>
